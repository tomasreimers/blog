"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_codesandbox_sandpack-client_dist_clients_node_index_mjs"],{

/***/ "./node_modules/@codesandbox/nodebox/build/index.mjs":
/*!***********************************************************!*\
  !*** ./node_modules/@codesandbox/nodebox/build/index.mjs ***!
  \***********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   INJECT_MESSAGE_TYPE: function() { return /* binding */ INJECT_MESSAGE_TYPE; },\n/* harmony export */   MessageReceiver: function() { return /* binding */ MessageReceiver; },\n/* harmony export */   MessageSender: function() { return /* binding */ MessageSender; },\n/* harmony export */   Nodebox: function() { return /* binding */ Nodebox; },\n/* harmony export */   PREVIEW_LOADED_MESSAGE_TYPE: function() { return /* binding */ PREVIEW_LOADED_MESSAGE_TYPE; }\n/* harmony export */ });\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n  mod\n));\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\nvar __privateMethod = (obj, member, method) => {\n  __accessCheck(obj, member, \"access private method\");\n  return method;\n};\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\nvar require_pad = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\"(exports, module) {\n    module.exports = function pad(num, size) {\n      var s = \"000000000\" + num;\n      return s.substr(s.length - size);\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\nvar require_fingerprint_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\"(exports, module) {\n    var pad = require_pad();\n    var env = typeof window === \"object\" ? window : self;\n    var globalCount = Object.keys(env).length;\n    var mimeTypesLength = navigator.mimeTypes ? navigator.mimeTypes.length : 0;\n    var clientId = pad((mimeTypesLength + navigator.userAgent.length).toString(36) + globalCount.toString(36), 4);\n    module.exports = function fingerprint() {\n      return clientId;\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\nvar require_getRandomValue_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\"(exports, module) {\n    var getRandomValue;\n    var crypto = typeof window !== \"undefined\" && (window.crypto || window.msCrypto) || typeof self !== \"undefined\" && self.crypto;\n    if (crypto) {\n      lim = Math.pow(2, 32) - 1;\n      getRandomValue = function() {\n        return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0] / lim);\n      };\n    } else {\n      getRandomValue = Math.random;\n    }\n    var lim;\n    module.exports = getRandomValue;\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\nvar require_cuid = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\"(exports, module) {\n    var fingerprint = require_fingerprint_browser();\n    var pad = require_pad();\n    var getRandomValue = require_getRandomValue_browser();\n    var c = 0;\n    var blockSize = 4;\n    var base = 36;\n    var discreteValues = Math.pow(base, blockSize);\n    function randomBlock() {\n      return pad((getRandomValue() * discreteValues << 0).toString(base), blockSize);\n    }\n    function safeCounter() {\n      c = c < discreteValues ? c : 0;\n      c++;\n      return c - 1;\n    }\n    function cuid3() {\n      var letter = \"c\", timestamp = new Date().getTime().toString(base), counter = pad(safeCounter().toString(base), blockSize), print = fingerprint(), random = randomBlock() + randomBlock();\n      return letter + timestamp + counter + print + random;\n    }\n    cuid3.slug = function slug() {\n      var date = new Date().getTime().toString(36), counter = safeCounter().toString(36).slice(-4), print = fingerprint().slice(0, 1) + fingerprint().slice(-1), random = randomBlock().slice(-2);\n      return date.slice(-2) + counter + print + random;\n    };\n    cuid3.isCuid = function isCuid(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      if (stringToCheck.startsWith(\"c\"))\n        return true;\n      return false;\n    };\n    cuid3.isSlug = function isSlug(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      var stringLength = stringToCheck.length;\n      if (stringLength >= 7 && stringLength <= 10)\n        return true;\n      return false;\n    };\n    cuid3.fingerprint = fingerprint;\n    module.exports = cuid3;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\nvar require_createDeferredExecutor = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.createDeferredExecutor = void 0;\n    function createDeferredExecutor() {\n      const executor = (resolve, reject) => {\n        executor.state = \"pending\";\n        executor.resolve = (data) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          executor.result = data;\n          const onFulfilled = (value) => {\n            executor.state = \"fulfilled\";\n            return value;\n          };\n          return resolve(data instanceof Promise ? data : Promise.resolve(data).then(onFulfilled));\n        };\n        executor.reject = (reason) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          queueMicrotask(() => {\n            executor.state = \"rejected\";\n          });\n          return reject(executor.rejectionReason = reason);\n        };\n      };\n      return executor;\n    }\n    exports.createDeferredExecutor = createDeferredExecutor;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\nvar require_DeferredPromise = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.DeferredPromise = void 0;\n    var createDeferredExecutor_1 = require_createDeferredExecutor();\n    var DeferredPromise4 = class extends Promise {\n      #executor;\n      resolve;\n      reject;\n      constructor(executor = null) {\n        const deferredExecutor = (0, createDeferredExecutor_1.createDeferredExecutor)();\n        super((originalResolve, originalReject) => {\n          deferredExecutor(originalResolve, originalReject);\n          executor?.(deferredExecutor.resolve, deferredExecutor.reject);\n        });\n        this.#executor = deferredExecutor;\n        this.resolve = this.#executor.resolve;\n        this.reject = this.#executor.reject;\n      }\n      get state() {\n        return this.#executor.state;\n      }\n      get rejectionReason() {\n        return this.#executor.rejectionReason;\n      }\n      then(onFulfilled, onRejected) {\n        return this.#decorate(super.then(onFulfilled, onRejected));\n      }\n      catch(onRejected) {\n        return this.#decorate(super.catch(onRejected));\n      }\n      finally(onfinally) {\n        return this.#decorate(super.finally(onfinally));\n      }\n      #decorate(promise) {\n        return Object.defineProperties(promise, {\n          resolve: { configurable: true, value: this.resolve },\n          reject: { configurable: true, value: this.reject }\n        });\n      }\n    };\n    exports.DeferredPromise = DeferredPromise4;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\nvar require_build = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_createDeferredExecutor(), exports);\n    __exportStar(require_DeferredPromise(), exports);\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\nvar require_MemoryLeakError = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.MemoryLeakError = void 0;\n    var MemoryLeakError = class extends Error {\n      emitter;\n      type;\n      count;\n      constructor(emitter, type, count) {\n        super(`Possible EventEmitter memory leak detected. ${count} ${type.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`);\n        this.emitter = emitter;\n        this.type = type;\n        this.count = count;\n        this.name = \"MaxListenersExceededWarning\";\n      }\n    };\n    exports.MemoryLeakError = MemoryLeakError;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\nvar require_Emitter = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.Emitter = void 0;\n    var MemoryLeakError_1 = require_MemoryLeakError();\n    var _events, _maxListeners, _hasWarnedAboutPotentialMemortyLeak, _getListeners, getListeners_fn, _removeListener, removeListener_fn, _wrapOnceListener, wrapOnceListener_fn, _internalEmit, internalEmit_fn;\n    var _Emitter = class {\n      constructor() {\n        __privateAdd(this, _getListeners);\n        __privateAdd(this, _removeListener);\n        __privateAdd(this, _wrapOnceListener);\n        __privateAdd(this, _internalEmit);\n        __privateAdd(this, _events, void 0);\n        __privateAdd(this, _maxListeners, void 0);\n        __privateAdd(this, _hasWarnedAboutPotentialMemortyLeak, void 0);\n        __privateSet(this, _events, /* @__PURE__ */ new Map());\n        __privateSet(this, _maxListeners, _Emitter.defaultMaxListeners);\n        __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, false);\n      }\n      static listenerCount(emitter, eventName) {\n        return emitter.listenerCount(eventName);\n      }\n      setMaxListeners(maxListeners) {\n        __privateSet(this, _maxListeners, maxListeners);\n        return this;\n      }\n      getMaxListeners() {\n        return __privateGet(this, _maxListeners);\n      }\n      eventNames() {\n        return Array.from(__privateGet(this, _events).keys());\n      }\n      emit(eventName, ...data) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        listeners.forEach((listener) => {\n          listener.apply(this, data);\n        });\n        return listeners.length > 0;\n      }\n      addListener(eventName, listener) {\n        __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"newListener\", eventName, listener);\n        const nextListeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).concat(listener);\n        __privateGet(this, _events).set(eventName, nextListeners);\n        if (__privateGet(this, _maxListeners) > 0 && this.listenerCount(eventName) > __privateGet(this, _maxListeners) && !__privateGet(this, _hasWarnedAboutPotentialMemortyLeak)) {\n          __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, true);\n          const memoryLeakWarning = new MemoryLeakError_1.MemoryLeakError(this, eventName, this.listenerCount(eventName));\n          console.warn(memoryLeakWarning);\n        }\n        return this;\n      }\n      on(eventName, listener) {\n        return this.addListener(eventName, listener);\n      }\n      once(eventName, listener) {\n        return this.addListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      prependListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          const nextListeners = [listener].concat(listeners);\n          __privateGet(this, _events).set(eventName, nextListeners);\n        } else {\n          __privateGet(this, _events).set(eventName, listeners.concat(listener));\n        }\n        return this;\n      }\n      prependOnceListener(eventName, listener) {\n        return this.prependListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      removeListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          __privateMethod(this, _removeListener, removeListener_fn).call(this, listeners, listener);\n          __privateGet(this, _events).set(eventName, listeners);\n          __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"removeListener\", eventName, listener);\n        }\n        return this;\n      }\n      off(eventName, listener) {\n        return this.removeListener(eventName, listener);\n      }\n      removeAllListeners(eventName) {\n        if (eventName) {\n          __privateGet(this, _events).delete(eventName);\n        } else {\n          __privateGet(this, _events).clear();\n        }\n        return this;\n      }\n      listeners(eventName) {\n        return Array.from(__privateMethod(this, _getListeners, getListeners_fn).call(this, eventName));\n      }\n      listenerCount(eventName) {\n        return __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).length;\n      }\n      rawListeners(eventName) {\n        return this.listeners(eventName);\n      }\n    };\n    var Emitter2 = _Emitter;\n    _events = new WeakMap();\n    _maxListeners = new WeakMap();\n    _hasWarnedAboutPotentialMemortyLeak = new WeakMap();\n    _getListeners = new WeakSet();\n    getListeners_fn = function(eventName) {\n      return __privateGet(this, _events).get(eventName) || [];\n    };\n    _removeListener = new WeakSet();\n    removeListener_fn = function(listeners, listener) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n      return [];\n    };\n    _wrapOnceListener = new WeakSet();\n    wrapOnceListener_fn = function(eventName, listener) {\n      const onceListener = (...data) => {\n        this.removeListener(eventName, onceListener);\n        listener.apply(this, data);\n      };\n      return onceListener;\n    };\n    _internalEmit = new WeakSet();\n    internalEmit_fn = function(internalEventName, eventName, listener) {\n      this.emit(\n        internalEventName,\n        ...[eventName, listener]\n      );\n    };\n    __publicField(Emitter2, \"defaultMaxListeners\", 10);\n    exports.Emitter = Emitter2;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\nvar require_lib = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_Emitter(), exports);\n    __exportStar(require_MemoryLeakError(), exports);\n  }\n});\n\n// src/messages.ts\nvar import_cuid = __toESM(require_cuid());\n\n// ../../node_modules/.pnpm/outvariant@1.4.0/node_modules/outvariant/lib/index.mjs\nvar POSITIONALS_EXP = /(%?)(%([sdjo]))/g;\nfunction serializePositional(positional, flag) {\n  switch (flag) {\n    case \"s\":\n      return positional;\n    case \"d\":\n    case \"i\":\n      return Number(positional);\n    case \"j\":\n      return JSON.stringify(positional);\n    case \"o\": {\n      if (typeof positional === \"string\") {\n        return positional;\n      }\n      const json = JSON.stringify(positional);\n      if (json === \"{}\" || json === \"[]\" || /^\\[object .+?\\]$/.test(json)) {\n        return positional;\n      }\n      return json;\n    }\n  }\n}\nfunction format(message, ...positionals) {\n  if (positionals.length === 0) {\n    return message;\n  }\n  let positionalIndex = 0;\n  let formattedMessage = message.replace(\n    POSITIONALS_EXP,\n    (match, isEscaped, _, flag) => {\n      const positional = positionals[positionalIndex];\n      const value = serializePositional(positional, flag);\n      if (!isEscaped) {\n        positionalIndex++;\n        return value;\n      }\n      return match;\n    }\n  );\n  if (positionalIndex < positionals.length) {\n    formattedMessage += ` ${positionals.slice(positionalIndex).join(\" \")}`;\n  }\n  formattedMessage = formattedMessage.replace(/%{2,2}/g, \"%\");\n  return formattedMessage;\n}\nvar STACK_FRAMES_TO_IGNORE = 2;\nfunction cleanErrorStack(error) {\n  if (!error.stack) {\n    return;\n  }\n  const nextStack = error.stack.split(\"\\n\");\n  nextStack.splice(1, STACK_FRAMES_TO_IGNORE);\n  error.stack = nextStack.join(\"\\n\");\n}\nvar InvariantError = class extends Error {\n  constructor(message, ...positionals) {\n    super(message);\n    this.message = message;\n    this.name = \"Invariant Violation\";\n    this.message = format(message, ...positionals);\n    cleanErrorStack(this);\n  }\n};\nvar invariant = (predicate, message, ...positionals) => {\n  if (!predicate) {\n    throw new InvariantError(message, ...positionals);\n  }\n};\ninvariant.as = (ErrorConstructor, predicate, message, ...positionals) => {\n  if (!predicate) {\n    const isConstructor = ErrorConstructor.prototype.name != null;\n    const error = isConstructor ? new ErrorConstructor(format(message, positionals)) : ErrorConstructor(format(message, positionals));\n    throw error;\n  }\n};\n\n// src/messages.ts\nvar import_deferred_promise = __toESM(require_build());\n\n// src/logger.ts\nvar FLAG = window.localStorage[\"CSB_EMULATOR_DEBUG\"];\nvar DEFAULT = \"\\x1B[0m\";\nvar GREEN = \"\\x1B[32;1m\";\nvar RED = \"\\x1B[31m\";\nvar BLUE = \"\\x1B[34m\";\nvar YELLOW = \"\\x1B[33;1m\";\nvar MAGENTA = \"\\x1B[35;1m\";\nvar CYAN = \"\\x1B[36;1m\";\nvar COLOR_SCOPE = {\n  preview: YELLOW,\n  emulator: MAGENTA,\n  runtime: CYAN,\n  bridge: BLUE,\n  \"runtime:worker\": CYAN\n};\nfunction createDebug(scope) {\n  return function debug3(message, ...data) {\n    if (FLAG === \"true\") {\n      const direction = () => {\n        if (message.includes(\"sender\"))\n          return `${GREEN}sender`;\n        if (message.includes(\"receiver\"))\n          return `${RED}receiver`;\n        return \"\";\n      };\n      const cleanMessage = message.replace(/\\[.+\\]:/, \"\");\n      console.debug(`${COLOR_SCOPE[scope]}${scope}:${direction()}${DEFAULT}:${cleanMessage}`, ...data);\n    }\n  };\n}\n\n// src/messages.ts\nvar debug = createDebug(\"emulator\");\nvar MessageReceiver = class {\n  emitter;\n  senderPort = null;\n  constructor() {\n    this.emitter = new EventTarget();\n    this.waitForHandshake();\n  }\n  waitForHandshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      const { data } = message;\n      debug(\"[message-receiver]: incoming\", message);\n      if (data.type === \"internal/handshake\") {\n        invariant(\n          message.ports.length > 0,\n          \"Failed to confirm a MessageReceiver handshake: received event has no ports\"\n        );\n        this.senderPort = message.ports[0];\n        this.addMessageListener();\n        debug(\"[message-receiver]: handshake received!\", this.senderPort);\n        this.send(\"internal/handshake/done\");\n        debug(\"[message-receiver]: finish handshake\");\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    handshakePromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    window.parent.postMessage({ type: \"internal/ready\" }, \"*\");\n    return handshakePromise;\n  }\n  addMessageListener() {\n    invariant(\n      this.senderPort,\n      \"[MessageReceiver] Failed to add a message listener: sender port is not defined. Did you forget to await a handshake?\"\n    );\n    this.senderPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type == null) {\n        return;\n      }\n      this.emitter.dispatchEvent(\n        new MessageEvent(data.type, {\n          data: data.payload\n        })\n      );\n    };\n  }\n  on(event, listener, options) {\n    this.emitter.addEventListener(\n      event,\n      async (message) => {\n        if (!(message instanceof MessageEvent)) {\n          return;\n        }\n        const { operationId, payload } = message.data;\n        try {\n          const listenerPayload = await listener(payload);\n          this.send(\"internal/operation/done\", { operationId, listenerPayload });\n        } catch (error) {\n          if (error instanceof Error) {\n            this.send(\"internal/operation/failed\", { operationId, error });\n          }\n        }\n      },\n      options\n    );\n  }\n  send(event, ...data) {\n    invariant(\n      this.senderPort,\n      '[MessageReceiver] Failed to send a message \"%j\": sender port is not defined. Did you forget to await a handshake?',\n      event\n    );\n    const payload = data[0] || {};\n    debug('[message-receiver]: send \"%s\"', event, payload);\n    this.senderPort.postMessage({ type: event, payload });\n  }\n};\nvar MessageSender = class {\n  constructor(target) {\n    this.target = target;\n    this.emitter = new EventTarget();\n    this.channel = new MessageChannel();\n    this.receiverPort = this.channel.port1;\n    const receiverReadyPromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      if (message.data.type === \"internal/ready\") {\n        debug(\"[message-sender]: runtime is ready\");\n        receiverReadyPromise.resolve();\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    receiverReadyPromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    this.receiverReadyPromise = receiverReadyPromise;\n    this.receiverPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type != null) {\n        debug('[message-sender]: emitting \"%s\" event...', data.type, data.payload);\n        this.emitter.dispatchEvent(new MessageEvent(data.type, { data: data.payload }));\n      }\n    };\n  }\n  emitter;\n  channel;\n  receiverPort;\n  receiverReadyPromise;\n  async handshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    await this.receiverReadyPromise;\n    debug(\"[message-sender]: sending handshake\");\n    this.target.postMessage(\n      {\n        type: \"internal/handshake\"\n      },\n      \"*\",\n      [this.channel.port2]\n    );\n    this.on(\"internal/handshake/done\", () => {\n      handshakePromise.resolve();\n      clearTimeout(rejectionTimeout);\n    });\n    const rejectionTimeout = setTimeout(() => {\n      handshakePromise.reject(new Error(\"MessageSender: Handshake timeout\"));\n    }, 5e3);\n    return handshakePromise;\n  }\n  on(event, listener, options) {\n    debug('[message-sender]: add listener \"%s\"', event);\n    this.emitter.addEventListener(\n      event,\n      (message) => {\n        if (message instanceof MessageEvent) {\n          listener(message);\n        }\n      },\n      options\n    );\n  }\n  off(event, listener, options) {\n    this.emitter.removeEventListener(event, listener, options);\n  }\n  async send(event, ...data) {\n    const operationPromise = new import_deferred_promise.DeferredPromise();\n    const operationId = (0, import_cuid.default)();\n    const payload = data[0] || {};\n    debug('[message-sender]: send \"%s\" (%s)', event, operationId, payload);\n    this.receiverPort.postMessage({ type: event, payload: { operationId, payload } });\n    debug('[message-sender]: adding done listener for \"%s\" (%s)', event, operationId);\n    const handleOperationDone = (doneEvent) => {\n      const { data: data2 } = doneEvent;\n      if (data2.operationId === operationId) {\n        const listenerPayload = data2.listenerPayload || {};\n        debug('[message-sender]: resolving \"%s (%s) promise!', event, operationId);\n        operationPromise.resolve({\n          ...listenerPayload,\n          operationId: data2.operationId\n        });\n      }\n    };\n    const handleOperationFailed = (failEvent) => {\n      const { data: data2 } = failEvent;\n      if (data2.operationId === operationId) {\n        debug('[message-sender]: rejecting \"%s (%s) promise!', event, operationId);\n        operationPromise.reject(data2.error);\n      }\n    };\n    this.on(\"internal/operation/done\", handleOperationDone);\n    this.on(\"internal/operation/failed\", handleOperationFailed);\n    return operationPromise.finally(() => {\n      this.emitter.removeEventListener(\"internal/operation/done\", handleOperationDone);\n      this.emitter.removeEventListener(\"internal/operation/failed\", handleOperationFailed);\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar import_deferred_promise3 = __toESM(require_build());\n\n// src/modules/fs.ts\nvar import_cuid2 = __toESM(require_cuid());\nvar FileSystemApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async init(files) {\n    await this.channel.send(\"fs/init\", { files });\n  }\n  async readFile(path, encoding) {\n    const response = await this.channel.send(\"fs/readFile\", { path, encoding }).catch((error) => {\n      throw new Error(format('Failed to read file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async writeFile(path, content, options) {\n    let encoding = void 0;\n    let recursive = false;\n    if (typeof options === \"object\") {\n      encoding = options.encoding;\n      recursive = !!options.recursive;\n    } else if (typeof options === \"string\") {\n      encoding = options;\n    }\n    await this.channel.send(\"fs/writeFile\", { path, content, encoding, recursive }).catch((error) => {\n      throw new Error(format('Failed to write file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async readdir(path) {\n    const response = await this.channel.send(\"fs/readdir\", { path }).catch((error) => {\n      throw new Error(format('Failed to read directory at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"Directory not found\");\n    }\n    return response.data;\n  }\n  async mkdir(path, options) {\n    const recursive = !!options?.recursive;\n    await this.channel.send(\"fs/mkdir\", { path, recursive }).catch((error) => {\n      throw new Error(format('Failed to make directory at path \"%s\"', path), { cause: error });\n    });\n  }\n  async stat(path) {\n    const response = await this.channel.send(\"fs/stat\", { path }).catch((error) => {\n      throw new Error(format('Failed to stat file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async rm(path, options) {\n    const { force, recursive } = options || {};\n    await this.channel.send(\"fs/rm\", { path, force, recursive }).catch((error) => {\n      throw new Error(format('Failed to remove file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async watch(includes, excludes, listener) {\n    const watcherId = (0, import_cuid2.default)();\n    await this.channel.send(\"fs/watch\", { watcherId, includes, excludes });\n    this.channel.on(\"fs/watch-event\", ({ data }) => {\n      if (data.watcherId === watcherId && listener) {\n        const evt = { ...data };\n        delete evt.watcherId;\n        listener(evt);\n      }\n    });\n    return {\n      dispose: () => this.channel.send(\"fs/unwatch\", { watcherId })\n    };\n  }\n};\n\n// src/modules/shell.ts\nvar import_strict_event_emitter = __toESM(require_lib());\nvar ShellApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  create() {\n    return new ShellProcess(this.channel);\n  }\n};\nvar ShellProcess = class {\n  constructor(channel) {\n    this.channel = channel;\n    this.state = \"running\";\n    this.stdout = new import_strict_event_emitter.Emitter();\n    this.stderr = new import_strict_event_emitter.Emitter();\n    this.stdin = {\n      write: (data) => {\n        if (!this.id) {\n          throw new Error(\"Failed to write to stdin, no process is currently running\");\n        }\n        return this.channel.send(\"shell/stdin\", { data, workerId: this.id });\n      }\n    };\n    this.forwardStdEvents();\n  }\n  id;\n  state;\n  stdout;\n  stderr;\n  stdin;\n  forwardStdEvents() {\n    this.channel.on(\"worker/tty\", (message) => {\n      const { data } = message;\n      if (data.workerId !== this.id) {\n        return;\n      }\n      switch (data.payload.type) {\n        case \"out\": {\n          this.stdout.emit(\"data\", data.payload.data);\n          break;\n        }\n        case \"err\": {\n          this.stderr.emit(\"data\", data.payload.data);\n          break;\n        }\n      }\n    });\n  }\n  async runCommand(command, args, options = {}) {\n    invariant(!this.id, 'Failed to run \"runCommand\" on a ShellProcess: there is already a process running.');\n    const shellInfo = await this.channel.send(\"shell/runCommand\", { command, args, options });\n    invariant(shellInfo, 'Failed to run \"runCommand\" on a ShellProcess: was not able to retrieve a running process.');\n    this.id = shellInfo.id;\n    this.state = \"running\";\n    return shellInfo;\n  }\n  async on(message, listener) {\n    switch (message) {\n      case \"progress\": {\n        this.channel.on(\"worker/progress\", ({ data }) => {\n          listener(data.status);\n        });\n        return;\n      }\n      case \"exit\": {\n        this.channel.on(\"worker/exit\", ({ data }) => {\n          if (data.workerId === this.id) {\n            listener(data.exitCode, data.error);\n          }\n        });\n        return;\n      }\n    }\n  }\n  async kill() {\n    invariant(\n      this.id,\n      'Failed to run \"kill\" on a ShellProcess: there is no process running. Did you forget to run it?'\n    );\n    this.state = \"idle\";\n    await this.channel.send(\"shell/exit\", { id: this.id }).catch((error) => {\n      throw new Error(format('Failed to kill shell with ID \"%s\"', this.id), { cause: error });\n    });\n    this.id = void 0;\n  }\n};\n\n// src/modules/preview.ts\nvar import_deferred_promise2 = __toESM(require_build());\nvar TIMEOUT = 2e4;\nvar PreviewApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async waitFor(payload, predicate, timeout = TIMEOUT) {\n    const readyPromise = new import_deferred_promise2.DeferredPromise();\n    const rejectTimeout = setTimeout(() => {\n      readyPromise.reject();\n    }, timeout);\n    const previewInformation = await this.channel.send(\"preview/get/info\", payload).catch((error) => {\n      readyPromise.reject(\n        new Error(\n          format(\n            'Failed to look up preview information for shell ID \"%s\" (port: %d)',\n            payload.sourceShellId,\n            payload.port\n          )\n        )\n      );\n    });\n    const foundPreview = previewInformation && predicate(previewInformation);\n    if (foundPreview) {\n      readyPromise.resolve({\n        url: previewInformation.url,\n        port: previewInformation.port,\n        sourceShellId: previewInformation.sourceShellId\n      });\n    }\n    this.channel.on(\"preview/port/ready\", ({ data }) => {\n      if (!foundPreview && predicate(data)) {\n        readyPromise.resolve({\n          url: data.url,\n          port: data.port,\n          sourceShellId: data.sourceShellId\n        });\n      }\n    });\n    return readyPromise.finally(() => {\n      clearTimeout(rejectTimeout);\n    });\n  }\n  async getByShellId(sourceShellId, timeout) {\n    return this.waitFor({ sourceShellId }, (data) => data.sourceShellId === sourceShellId, timeout).catch((error) => {\n      throw new Error(format('Failed to get shell by ID \"%s\"', sourceShellId), { cause: error });\n    });\n  }\n  async waitForPort(port, timeout) {\n    return this.waitFor({ port }, (data) => data.port === port, timeout).catch((error) => {\n      throw new Error(format(\"Failed to await port %d\", port), { cause: error });\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar DEFAULT_RUNTIME_URL = \"https://nodebox-runtime.codesandbox.io\";\nvar debug2 = createDebug(\"emulator\");\nvar Nodebox = class {\n  constructor(options) {\n    this.options = options;\n    invariant(\n      this.options.iframe,\n      'Failed to create a Nodebox: expected \"iframe\" argument to be a reference to an <iframe> element but got %j',\n      this.options.iframe\n    );\n    this.url = this.options.runtimeUrl || DEFAULT_RUNTIME_URL;\n    this.isConnected = false;\n  }\n  channel = null;\n  isConnected;\n  url;\n  fileSystemApi = null;\n  shellApi = null;\n  previewApi = null;\n  async connect() {\n    const { iframe, cdnUrl } = this.options;\n    debug2(\"[message-sender]: Connecting to node emulator...\");\n    const connectionPromise = new import_deferred_promise3.DeferredPromise();\n    if (!this.url) {\n      connectionPromise.reject(\n        new Error(\"Nodebox URL is missing. Did you forget to provide it when creating this Nodebox instance?\")\n      );\n    }\n    invariant(\n      iframe.contentWindow,\n      \"Failed to create a MessageChannel with the Nodebox iframe: no content window found\"\n    );\n    this.channel = new MessageSender(iframe.contentWindow);\n    const frameLoadPromise = new import_deferred_promise3.DeferredPromise();\n    iframe.setAttribute(\"src\", this.url);\n    iframe.addEventListener(\n      \"load\",\n      () => {\n        frameLoadPromise.resolve();\n      },\n      { once: true }\n    );\n    iframe.addEventListener(\n      \"error\",\n      (event) => {\n        frameLoadPromise.reject(event.error);\n      },\n      { once: true }\n    );\n    await frameLoadPromise;\n    debug2(\"[message-sender]: IFrame loaded...\");\n    await this.channel.handshake();\n    debug2(\"[message-sender]: Handshake completed...\");\n    this.channel.send(\"connect\", {\n      cdnUrl\n    });\n    this.channel.on(\"runtime/ready\", () => {\n      connectionPromise.resolve();\n    });\n    return connectionPromise.then(() => {\n      debug2(\"[message-sender]: Connected to runtime...\");\n      this.isConnected = true;\n    });\n  }\n  get fs() {\n    invariant(\n      this.isConnected,\n      'Failed to access the File System API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.fileSystemApi) {\n      return this.fileSystemApi;\n    }\n    this.fileSystemApi = new FileSystemApi(this.channel);\n    return this.fileSystemApi;\n  }\n  get shell() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Shell API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.shellApi) {\n      return this.shellApi;\n    }\n    this.shellApi = new ShellApi(this.channel);\n    return this.shellApi;\n  }\n  get preview() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Preview API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.previewApi) {\n      return this.previewApi;\n    }\n    this.previewApi = new PreviewApi(this.channel);\n    return this.previewApi;\n  }\n};\n\n// src/runtime-protocol.types.ts\nvar INJECT_MESSAGE_TYPE = \"INJECT_AND_INVOKE\";\nvar PREVIEW_LOADED_MESSAGE_TYPE = \"PREVIEW_LOADED\";\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L25vZGVib3gvYnVpbGQvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLDZEQUE2RDtBQUMzSTtBQUNBLDJEQUEyRCxhQUFhO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsNEZBQTRGO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBLG1HQUFtRztBQUNuRyx5RUFBeUUsOEJBQThCO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGFBQWE7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIseUNBQXlDO0FBQzlELG9CQUFvQjtBQUNwQixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsT0FBTyxFQUFFLGlCQUFpQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQU9FIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvbm9kZWJveC9idWlsZC9pbmRleC5tanM/OWEyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19jcmVhdGUgPSBPYmplY3QuY3JlYXRlO1xudmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBfX2dldE93blByb3BEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbnZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xudmFyIF9fZ2V0UHJvdG9PZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbnZhciBfX2hhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fY29tbW9uSlMgPSAoY2IsIG1vZCkgPT4gZnVuY3Rpb24gX19yZXF1aXJlKCkge1xuICByZXR1cm4gbW9kIHx8ICgwLCBjYltfX2dldE93blByb3BOYW1lcyhjYilbMF1dKSgobW9kID0geyBleHBvcnRzOiB7fSB9KS5leHBvcnRzLCBtb2QpLCBtb2QuZXhwb3J0cztcbn07XG52YXIgX19jb3B5UHJvcHMgPSAodG8sIGZyb20sIGV4Y2VwdCwgZGVzYykgPT4ge1xuICBpZiAoZnJvbSAmJiB0eXBlb2YgZnJvbSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgZnJvbSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKVxuICAgICAgaWYgKCFfX2hhc093blByb3AuY2FsbCh0bywga2V5KSAmJiBrZXkgIT09IGV4Y2VwdClcbiAgICAgICAgX19kZWZQcm9wKHRvLCBrZXksIHsgZ2V0OiAoKSA9PiBmcm9tW2tleV0sIGVudW1lcmFibGU6ICEoZGVzYyA9IF9fZ2V0T3duUHJvcERlc2MoZnJvbSwga2V5KSkgfHwgZGVzYy5lbnVtZXJhYmxlIH0pO1xuICB9XG4gIHJldHVybiB0bztcbn07XG52YXIgX190b0VTTSA9IChtb2QsIGlzTm9kZU1vZGUsIHRhcmdldCkgPT4gKHRhcmdldCA9IG1vZCAhPSBudWxsID8gX19jcmVhdGUoX19nZXRQcm90b09mKG1vZCkpIDoge30sIF9fY29weVByb3BzKFxuICBpc05vZGVNb2RlIHx8ICFtb2QgfHwgIW1vZC5fX2VzTW9kdWxlID8gX19kZWZQcm9wKHRhcmdldCwgXCJkZWZhdWx0XCIsIHsgdmFsdWU6IG1vZCwgZW51bWVyYWJsZTogdHJ1ZSB9KSA6IHRhcmdldCxcbiAgbW9kXG4pKTtcbnZhciBfX3B1YmxpY0ZpZWxkID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBfX2RlZk5vcm1hbFByb3Aob2JqLCB0eXBlb2Yga2V5ICE9PSBcInN5bWJvbFwiID8ga2V5ICsgXCJcIiA6IGtleSwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIF9fYWNjZXNzQ2hlY2sgPSAob2JqLCBtZW1iZXIsIG1zZykgPT4ge1xuICBpZiAoIW1lbWJlci5oYXMob2JqKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoXCJDYW5ub3QgXCIgKyBtc2cpO1xufTtcbnZhciBfX3ByaXZhdGVHZXQgPSAob2JqLCBtZW1iZXIsIGdldHRlcikgPT4ge1xuICBfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcInJlYWQgZnJvbSBwcml2YXRlIGZpZWxkXCIpO1xuICByZXR1cm4gZ2V0dGVyID8gZ2V0dGVyLmNhbGwob2JqKSA6IG1lbWJlci5nZXQob2JqKTtcbn07XG52YXIgX19wcml2YXRlQWRkID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSkgPT4ge1xuICBpZiAobWVtYmVyLmhhcyhvYmopKVxuICAgIHRocm93IFR5cGVFcnJvcihcIkNhbm5vdCBhZGQgdGhlIHNhbWUgcHJpdmF0ZSBtZW1iZXIgbW9yZSB0aGFuIG9uY2VcIik7XG4gIG1lbWJlciBpbnN0YW5jZW9mIFdlYWtTZXQgPyBtZW1iZXIuYWRkKG9iaikgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xufTtcbnZhciBfX3ByaXZhdGVTZXQgPSAob2JqLCBtZW1iZXIsIHZhbHVlLCBzZXR0ZXIpID0+IHtcbiAgX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJ3cml0ZSB0byBwcml2YXRlIGZpZWxkXCIpO1xuICBzZXR0ZXIgPyBzZXR0ZXIuY2FsbChvYmosIHZhbHVlKSA6IG1lbWJlci5zZXQob2JqLCB2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZTtcbn07XG52YXIgX19wcml2YXRlTWV0aG9kID0gKG9iaiwgbWVtYmVyLCBtZXRob2QpID0+IHtcbiAgX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJhY2Nlc3MgcHJpdmF0ZSBtZXRob2RcIik7XG4gIHJldHVybiBtZXRob2Q7XG59O1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9saWIvcGFkLmpzXG52YXIgcmVxdWlyZV9wYWQgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9saWIvcGFkLmpzXCIoZXhwb3J0cywgbW9kdWxlKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYWQobnVtLCBzaXplKSB7XG4gICAgICB2YXIgcyA9IFwiMDAwMDAwMDAwXCIgKyBudW07XG4gICAgICByZXR1cm4gcy5zdWJzdHIocy5sZW5ndGggLSBzaXplKTtcbiAgICB9O1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2N1aWRAMi4xLjgvbm9kZV9tb2R1bGVzL2N1aWQvbGliL2ZpbmdlcnByaW50LmJyb3dzZXIuanNcbnZhciByZXF1aXJlX2ZpbmdlcnByaW50X2Jyb3dzZXIgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9saWIvZmluZ2VycHJpbnQuYnJvd3Nlci5qc1wiKGV4cG9ydHMsIG1vZHVsZSkge1xuICAgIHZhciBwYWQgPSByZXF1aXJlX3BhZCgpO1xuICAgIHZhciBlbnYgPSB0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiID8gd2luZG93IDogc2VsZjtcbiAgICB2YXIgZ2xvYmFsQ291bnQgPSBPYmplY3Qua2V5cyhlbnYpLmxlbmd0aDtcbiAgICB2YXIgbWltZVR5cGVzTGVuZ3RoID0gbmF2aWdhdG9yLm1pbWVUeXBlcyA/IG5hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoIDogMDtcbiAgICB2YXIgY2xpZW50SWQgPSBwYWQoKG1pbWVUeXBlc0xlbmd0aCArIG5hdmlnYXRvci51c2VyQWdlbnQubGVuZ3RoKS50b1N0cmluZygzNikgKyBnbG9iYWxDb3VudC50b1N0cmluZygzNiksIDQpO1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZmluZ2VycHJpbnQoKSB7XG4gICAgICByZXR1cm4gY2xpZW50SWQ7XG4gICAgfTtcbiAgfVxufSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2xpYi9nZXRSYW5kb21WYWx1ZS5icm93c2VyLmpzXG52YXIgcmVxdWlyZV9nZXRSYW5kb21WYWx1ZV9icm93c2VyID0gX19jb21tb25KUyh7XG4gIFwiLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2N1aWRAMi4xLjgvbm9kZV9tb2R1bGVzL2N1aWQvbGliL2dldFJhbmRvbVZhbHVlLmJyb3dzZXIuanNcIihleHBvcnRzLCBtb2R1bGUpIHtcbiAgICB2YXIgZ2V0UmFuZG9tVmFsdWU7XG4gICAgdmFyIGNyeXB0byA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgKHdpbmRvdy5jcnlwdG8gfHwgd2luZG93Lm1zQ3J5cHRvKSB8fCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmLmNyeXB0bztcbiAgICBpZiAoY3J5cHRvKSB7XG4gICAgICBsaW0gPSBNYXRoLnBvdygyLCAzMikgLSAxO1xuICAgICAgZ2V0UmFuZG9tVmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguYWJzKGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQzMkFycmF5KDEpKVswXSAvIGxpbSk7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBnZXRSYW5kb21WYWx1ZSA9IE1hdGgucmFuZG9tO1xuICAgIH1cbiAgICB2YXIgbGltO1xuICAgIG1vZHVsZS5leHBvcnRzID0gZ2V0UmFuZG9tVmFsdWU7XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9pbmRleC5qc1xudmFyIHJlcXVpcmVfY3VpZCA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2luZGV4LmpzXCIoZXhwb3J0cywgbW9kdWxlKSB7XG4gICAgdmFyIGZpbmdlcnByaW50ID0gcmVxdWlyZV9maW5nZXJwcmludF9icm93c2VyKCk7XG4gICAgdmFyIHBhZCA9IHJlcXVpcmVfcGFkKCk7XG4gICAgdmFyIGdldFJhbmRvbVZhbHVlID0gcmVxdWlyZV9nZXRSYW5kb21WYWx1ZV9icm93c2VyKCk7XG4gICAgdmFyIGMgPSAwO1xuICAgIHZhciBibG9ja1NpemUgPSA0O1xuICAgIHZhciBiYXNlID0gMzY7XG4gICAgdmFyIGRpc2NyZXRlVmFsdWVzID0gTWF0aC5wb3coYmFzZSwgYmxvY2tTaXplKTtcbiAgICBmdW5jdGlvbiByYW5kb21CbG9jaygpIHtcbiAgICAgIHJldHVybiBwYWQoKGdldFJhbmRvbVZhbHVlKCkgKiBkaXNjcmV0ZVZhbHVlcyA8PCAwKS50b1N0cmluZyhiYXNlKSwgYmxvY2tTaXplKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2FmZUNvdW50ZXIoKSB7XG4gICAgICBjID0gYyA8IGRpc2NyZXRlVmFsdWVzID8gYyA6IDA7XG4gICAgICBjKys7XG4gICAgICByZXR1cm4gYyAtIDE7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGN1aWQzKCkge1xuICAgICAgdmFyIGxldHRlciA9IFwiY1wiLCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZyhiYXNlKSwgY291bnRlciA9IHBhZChzYWZlQ291bnRlcigpLnRvU3RyaW5nKGJhc2UpLCBibG9ja1NpemUpLCBwcmludCA9IGZpbmdlcnByaW50KCksIHJhbmRvbSA9IHJhbmRvbUJsb2NrKCkgKyByYW5kb21CbG9jaygpO1xuICAgICAgcmV0dXJuIGxldHRlciArIHRpbWVzdGFtcCArIGNvdW50ZXIgKyBwcmludCArIHJhbmRvbTtcbiAgICB9XG4gICAgY3VpZDMuc2x1ZyA9IGZ1bmN0aW9uIHNsdWcoKSB7XG4gICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKDM2KSwgY291bnRlciA9IHNhZmVDb3VudGVyKCkudG9TdHJpbmcoMzYpLnNsaWNlKC00KSwgcHJpbnQgPSBmaW5nZXJwcmludCgpLnNsaWNlKDAsIDEpICsgZmluZ2VycHJpbnQoKS5zbGljZSgtMSksIHJhbmRvbSA9IHJhbmRvbUJsb2NrKCkuc2xpY2UoLTIpO1xuICAgICAgcmV0dXJuIGRhdGUuc2xpY2UoLTIpICsgY291bnRlciArIHByaW50ICsgcmFuZG9tO1xuICAgIH07XG4gICAgY3VpZDMuaXNDdWlkID0gZnVuY3Rpb24gaXNDdWlkKHN0cmluZ1RvQ2hlY2spIHtcbiAgICAgIGlmICh0eXBlb2Ygc3RyaW5nVG9DaGVjayAhPT0gXCJzdHJpbmdcIilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHN0cmluZ1RvQ2hlY2suc3RhcnRzV2l0aChcImNcIikpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgY3VpZDMuaXNTbHVnID0gZnVuY3Rpb24gaXNTbHVnKHN0cmluZ1RvQ2hlY2spIHtcbiAgICAgIGlmICh0eXBlb2Ygc3RyaW5nVG9DaGVjayAhPT0gXCJzdHJpbmdcIilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZ1RvQ2hlY2subGVuZ3RoO1xuICAgICAgaWYgKHN0cmluZ0xlbmd0aCA+PSA3ICYmIHN0cmluZ0xlbmd0aCA8PSAxMClcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBjdWlkMy5maW5nZXJwcmludCA9IGZpbmdlcnByaW50O1xuICAgIG1vZHVsZS5leHBvcnRzID0gY3VpZDM7XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9jcmVhdGVEZWZlcnJlZEV4ZWN1dG9yLmpzXG52YXIgcmVxdWlyZV9jcmVhdGVEZWZlcnJlZEV4ZWN1dG9yID0gX19jb21tb25KUyh7XG4gIFwiLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVuLWRyYWZ0K2RlZmVycmVkLXByb21pc2VAMi4xLjAvbm9kZV9tb2R1bGVzL0BvcGVuLWRyYWZ0L2RlZmVycmVkLXByb21pc2UvYnVpbGQvY3JlYXRlRGVmZXJyZWRFeGVjdXRvci5qc1wiKGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5jcmVhdGVEZWZlcnJlZEV4ZWN1dG9yID0gdm9pZCAwO1xuICAgIGZ1bmN0aW9uIGNyZWF0ZURlZmVycmVkRXhlY3V0b3IoKSB7XG4gICAgICBjb25zdCBleGVjdXRvciA9IChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgZXhlY3V0b3Iuc3RhdGUgPSBcInBlbmRpbmdcIjtcbiAgICAgICAgZXhlY3V0b3IucmVzb2x2ZSA9IChkYXRhKSA9PiB7XG4gICAgICAgICAgaWYgKGV4ZWN1dG9yLnN0YXRlICE9PSBcInBlbmRpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBleGVjdXRvci5yZXN1bHQgPSBkYXRhO1xuICAgICAgICAgIGNvbnN0IG9uRnVsZmlsbGVkID0gKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBleGVjdXRvci5zdGF0ZSA9IFwiZnVsZmlsbGVkXCI7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShkYXRhIGluc3RhbmNlb2YgUHJvbWlzZSA/IGRhdGEgOiBQcm9taXNlLnJlc29sdmUoZGF0YSkudGhlbihvbkZ1bGZpbGxlZCkpO1xuICAgICAgICB9O1xuICAgICAgICBleGVjdXRvci5yZWplY3QgPSAocmVhc29uKSA9PiB7XG4gICAgICAgICAgaWYgKGV4ZWN1dG9yLnN0YXRlICE9PSBcInBlbmRpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBxdWV1ZU1pY3JvdGFzaygoKSA9PiB7XG4gICAgICAgICAgICBleGVjdXRvci5zdGF0ZSA9IFwicmVqZWN0ZWRcIjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGV4ZWN1dG9yLnJlamVjdGlvblJlYXNvbiA9IHJlYXNvbik7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgICAgcmV0dXJuIGV4ZWN1dG9yO1xuICAgIH1cbiAgICBleHBvcnRzLmNyZWF0ZURlZmVycmVkRXhlY3V0b3IgPSBjcmVhdGVEZWZlcnJlZEV4ZWN1dG9yO1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVuLWRyYWZ0K2RlZmVycmVkLXByb21pc2VAMi4xLjAvbm9kZV9tb2R1bGVzL0BvcGVuLWRyYWZ0L2RlZmVycmVkLXByb21pc2UvYnVpbGQvRGVmZXJyZWRQcm9taXNlLmpzXG52YXIgcmVxdWlyZV9EZWZlcnJlZFByb21pc2UgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9EZWZlcnJlZFByb21pc2UuanNcIihleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIGV4cG9ydHMuRGVmZXJyZWRQcm9taXNlID0gdm9pZCAwO1xuICAgIHZhciBjcmVhdGVEZWZlcnJlZEV4ZWN1dG9yXzEgPSByZXF1aXJlX2NyZWF0ZURlZmVycmVkRXhlY3V0b3IoKTtcbiAgICB2YXIgRGVmZXJyZWRQcm9taXNlNCA9IGNsYXNzIGV4dGVuZHMgUHJvbWlzZSB7XG4gICAgICAjZXhlY3V0b3I7XG4gICAgICByZXNvbHZlO1xuICAgICAgcmVqZWN0O1xuICAgICAgY29uc3RydWN0b3IoZXhlY3V0b3IgPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGRlZmVycmVkRXhlY3V0b3IgPSAoMCwgY3JlYXRlRGVmZXJyZWRFeGVjdXRvcl8xLmNyZWF0ZURlZmVycmVkRXhlY3V0b3IpKCk7XG4gICAgICAgIHN1cGVyKChvcmlnaW5hbFJlc29sdmUsIG9yaWdpbmFsUmVqZWN0KSA9PiB7XG4gICAgICAgICAgZGVmZXJyZWRFeGVjdXRvcihvcmlnaW5hbFJlc29sdmUsIG9yaWdpbmFsUmVqZWN0KTtcbiAgICAgICAgICBleGVjdXRvcj8uKGRlZmVycmVkRXhlY3V0b3IucmVzb2x2ZSwgZGVmZXJyZWRFeGVjdXRvci5yZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4jZXhlY3V0b3IgPSBkZWZlcnJlZEV4ZWN1dG9yO1xuICAgICAgICB0aGlzLnJlc29sdmUgPSB0aGlzLiNleGVjdXRvci5yZXNvbHZlO1xuICAgICAgICB0aGlzLnJlamVjdCA9IHRoaXMuI2V4ZWN1dG9yLnJlamVjdDtcbiAgICAgIH1cbiAgICAgIGdldCBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2V4ZWN1dG9yLnN0YXRlO1xuICAgICAgfVxuICAgICAgZ2V0IHJlamVjdGlvblJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2V4ZWN1dG9yLnJlamVjdGlvblJlYXNvbjtcbiAgICAgIH1cbiAgICAgIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2RlY29yYXRlKHN1cGVyLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpKTtcbiAgICAgIH1cbiAgICAgIGNhdGNoKG9uUmVqZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2RlY29yYXRlKHN1cGVyLmNhdGNoKG9uUmVqZWN0ZWQpKTtcbiAgICAgIH1cbiAgICAgIGZpbmFsbHkob25maW5hbGx5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNkZWNvcmF0ZShzdXBlci5maW5hbGx5KG9uZmluYWxseSkpO1xuICAgICAgfVxuICAgICAgI2RlY29yYXRlKHByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHByb21pc2UsIHtcbiAgICAgICAgICByZXNvbHZlOiB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRoaXMucmVzb2x2ZSB9LFxuICAgICAgICAgIHJlamVjdDogeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0aGlzLnJlamVjdCB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgZXhwb3J0cy5EZWZlcnJlZFByb21pc2UgPSBEZWZlcnJlZFByb21pc2U0O1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVuLWRyYWZ0K2RlZmVycmVkLXByb21pc2VAMi4xLjAvbm9kZV9tb2R1bGVzL0BvcGVuLWRyYWZ0L2RlZmVycmVkLXByb21pc2UvYnVpbGQvaW5kZXguanNcbnZhciByZXF1aXJlX2J1aWxkID0gX19jb21tb25KUyh7XG4gIFwiLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BvcGVuLWRyYWZ0K2RlZmVycmVkLXByb21pc2VAMi4xLjAvbm9kZV9tb2R1bGVzL0BvcGVuLWRyYWZ0L2RlZmVycmVkLXByb21pc2UvYnVpbGQvaW5kZXguanNcIihleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIF9fY3JlYXRlQmluZGluZyA9IGV4cG9ydHMgJiYgZXhwb3J0cy5fX2NyZWF0ZUJpbmRpbmcgfHwgKE9iamVjdC5jcmVhdGUgPyBmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgICAgaWYgKGsyID09PSB2b2lkIDApXG4gICAgICAgIGsyID0gaztcbiAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIG1ba107XG4gICAgICAgIH0gfTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG4gICAgfSA6IGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgICBpZiAoazIgPT09IHZvaWQgMClcbiAgICAgICAgazIgPSBrO1xuICAgICAgb1trMl0gPSBtW2tdO1xuICAgIH0pO1xuICAgIHZhciBfX2V4cG9ydFN0YXIgPSBleHBvcnRzICYmIGV4cG9ydHMuX19leHBvcnRTdGFyIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMyKSB7XG4gICAgICBmb3IgKHZhciBwIGluIG0pXG4gICAgICAgIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMyLCBwKSlcbiAgICAgICAgICBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0czIsIG0sIHApO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIF9fZXhwb3J0U3RhcihyZXF1aXJlX2NyZWF0ZURlZmVycmVkRXhlY3V0b3IoKSwgZXhwb3J0cyk7XG4gICAgX19leHBvcnRTdGFyKHJlcXVpcmVfRGVmZXJyZWRQcm9taXNlKCksIGV4cG9ydHMpO1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0cmljdC1ldmVudC1lbWl0dGVyQDAuNC4zL25vZGVfbW9kdWxlcy9zdHJpY3QtZXZlbnQtZW1pdHRlci9saWIvTWVtb3J5TGVha0Vycm9yLmpzXG52YXIgcmVxdWlyZV9NZW1vcnlMZWFrRXJyb3IgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc3RyaWN0LWV2ZW50LWVtaXR0ZXJAMC40LjMvbm9kZV9tb2R1bGVzL3N0cmljdC1ldmVudC1lbWl0dGVyL2xpYi9NZW1vcnlMZWFrRXJyb3IuanNcIihleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIGV4cG9ydHMuTWVtb3J5TGVha0Vycm9yID0gdm9pZCAwO1xuICAgIHZhciBNZW1vcnlMZWFrRXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgICAgIGVtaXR0ZXI7XG4gICAgICB0eXBlO1xuICAgICAgY291bnQ7XG4gICAgICBjb25zdHJ1Y3RvcihlbWl0dGVyLCB0eXBlLCBjb3VudCkge1xuICAgICAgICBzdXBlcihgUG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiAke2NvdW50fSAke3R5cGUudG9TdHJpbmcoKX0gbGlzdGVuZXJzIGFkZGVkLiBVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdGApO1xuICAgICAgICB0aGlzLmVtaXR0ZXIgPSBlbWl0dGVyO1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLmNvdW50ID0gY291bnQ7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiTWF4TGlzdGVuZXJzRXhjZWVkZWRXYXJuaW5nXCI7XG4gICAgICB9XG4gICAgfTtcbiAgICBleHBvcnRzLk1lbW9yeUxlYWtFcnJvciA9IE1lbW9yeUxlYWtFcnJvcjtcbiAgfVxufSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHJpY3QtZXZlbnQtZW1pdHRlckAwLjQuMy9ub2RlX21vZHVsZXMvc3RyaWN0LWV2ZW50LWVtaXR0ZXIvbGliL0VtaXR0ZXIuanNcbnZhciByZXF1aXJlX0VtaXR0ZXIgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc3RyaWN0LWV2ZW50LWVtaXR0ZXJAMC40LjMvbm9kZV9tb2R1bGVzL3N0cmljdC1ldmVudC1lbWl0dGVyL2xpYi9FbWl0dGVyLmpzXCIoZXhwb3J0cykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBleHBvcnRzLkVtaXR0ZXIgPSB2b2lkIDA7XG4gICAgdmFyIE1lbW9yeUxlYWtFcnJvcl8xID0gcmVxdWlyZV9NZW1vcnlMZWFrRXJyb3IoKTtcbiAgICB2YXIgX2V2ZW50cywgX21heExpc3RlbmVycywgX2hhc1dhcm5lZEFib3V0UG90ZW50aWFsTWVtb3J0eUxlYWssIF9nZXRMaXN0ZW5lcnMsIGdldExpc3RlbmVyc19mbiwgX3JlbW92ZUxpc3RlbmVyLCByZW1vdmVMaXN0ZW5lcl9mbiwgX3dyYXBPbmNlTGlzdGVuZXIsIHdyYXBPbmNlTGlzdGVuZXJfZm4sIF9pbnRlcm5hbEVtaXQsIGludGVybmFsRW1pdF9mbjtcbiAgICB2YXIgX0VtaXR0ZXIgPSBjbGFzcyB7XG4gICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgX19wcml2YXRlQWRkKHRoaXMsIF9nZXRMaXN0ZW5lcnMpO1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX3JlbW92ZUxpc3RlbmVyKTtcbiAgICAgICAgX19wcml2YXRlQWRkKHRoaXMsIF93cmFwT25jZUxpc3RlbmVyKTtcbiAgICAgICAgX19wcml2YXRlQWRkKHRoaXMsIF9pbnRlcm5hbEVtaXQpO1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX2V2ZW50cywgdm9pZCAwKTtcbiAgICAgICAgX19wcml2YXRlQWRkKHRoaXMsIF9tYXhMaXN0ZW5lcnMsIHZvaWQgMCk7XG4gICAgICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfaGFzV2FybmVkQWJvdXRQb3RlbnRpYWxNZW1vcnR5TGVhaywgdm9pZCAwKTtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9ldmVudHMsIC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkpO1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21heExpc3RlbmVycywgX0VtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyk7XG4gICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaGFzV2FybmVkQWJvdXRQb3RlbnRpYWxNZW1vcnR5TGVhaywgZmFsc2UpO1xuICAgICAgfVxuICAgICAgc3RhdGljIGxpc3RlbmVyQ291bnQoZW1pdHRlciwgZXZlbnROYW1lKSB7XG4gICAgICAgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQoZXZlbnROYW1lKTtcbiAgICAgIH1cbiAgICAgIHNldE1heExpc3RlbmVycyhtYXhMaXN0ZW5lcnMpIHtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9tYXhMaXN0ZW5lcnMsIG1heExpc3RlbmVycyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgZ2V0TWF4TGlzdGVuZXJzKCkge1xuICAgICAgICByZXR1cm4gX19wcml2YXRlR2V0KHRoaXMsIF9tYXhMaXN0ZW5lcnMpO1xuICAgICAgfVxuICAgICAgZXZlbnROYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudHMpLmtleXMoKSk7XG4gICAgICB9XG4gICAgICBlbWl0KGV2ZW50TmFtZSwgLi4uZGF0YSkge1xuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSk7XG4gICAgICAgIGxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4ge1xuICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxpc3RlbmVycy5sZW5ndGggPiAwO1xuICAgICAgfVxuICAgICAgYWRkTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICBfX3ByaXZhdGVNZXRob2QodGhpcywgX2ludGVybmFsRW1pdCwgaW50ZXJuYWxFbWl0X2ZuKS5jYWxsKHRoaXMsIFwibmV3TGlzdGVuZXJcIiwgZXZlbnROYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgIGNvbnN0IG5leHRMaXN0ZW5lcnMgPSBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSkuY29uY2F0KGxpc3RlbmVyKTtcbiAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudHMpLnNldChldmVudE5hbWUsIG5leHRMaXN0ZW5lcnMpO1xuICAgICAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9tYXhMaXN0ZW5lcnMpID4gMCAmJiB0aGlzLmxpc3RlbmVyQ291bnQoZXZlbnROYW1lKSA+IF9fcHJpdmF0ZUdldCh0aGlzLCBfbWF4TGlzdGVuZXJzKSAmJiAhX19wcml2YXRlR2V0KHRoaXMsIF9oYXNXYXJuZWRBYm91dFBvdGVudGlhbE1lbW9ydHlMZWFrKSkge1xuICAgICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfaGFzV2FybmVkQWJvdXRQb3RlbnRpYWxNZW1vcnR5TGVhaywgdHJ1ZSk7XG4gICAgICAgICAgY29uc3QgbWVtb3J5TGVha1dhcm5pbmcgPSBuZXcgTWVtb3J5TGVha0Vycm9yXzEuTWVtb3J5TGVha0Vycm9yKHRoaXMsIGV2ZW50TmFtZSwgdGhpcy5saXN0ZW5lckNvdW50KGV2ZW50TmFtZSkpO1xuICAgICAgICAgIGNvbnNvbGUud2FybihtZW1vcnlMZWFrV2FybmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBvbihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpO1xuICAgICAgfVxuICAgICAgb25jZShldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgX19wcml2YXRlTWV0aG9kKHRoaXMsIF93cmFwT25jZUxpc3RlbmVyLCB3cmFwT25jZUxpc3RlbmVyX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSwgbGlzdGVuZXIpKTtcbiAgICAgIH1cbiAgICAgIHByZXBlbmRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0TGlzdGVuZXJzLCBnZXRMaXN0ZW5lcnNfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lKTtcbiAgICAgICAgaWYgKGxpc3RlbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgbmV4dExpc3RlbmVycyA9IFtsaXN0ZW5lcl0uY29uY2F0KGxpc3RlbmVycyk7XG4gICAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudHMpLnNldChldmVudE5hbWUsIG5leHRMaXN0ZW5lcnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfZXZlbnRzKS5zZXQoZXZlbnROYW1lLCBsaXN0ZW5lcnMuY29uY2F0KGxpc3RlbmVyKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBwcmVwZW5kT25jZUxpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJlcGVuZExpc3RlbmVyKGV2ZW50TmFtZSwgX19wcml2YXRlTWV0aG9kKHRoaXMsIF93cmFwT25jZUxpc3RlbmVyLCB3cmFwT25jZUxpc3RlbmVyX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSwgbGlzdGVuZXIpKTtcbiAgICAgIH1cbiAgICAgIHJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gX19wcml2YXRlTWV0aG9kKHRoaXMsIF9nZXRMaXN0ZW5lcnMsIGdldExpc3RlbmVyc19mbikuY2FsbCh0aGlzLCBldmVudE5hbWUpO1xuICAgICAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBfX3ByaXZhdGVNZXRob2QodGhpcywgX3JlbW92ZUxpc3RlbmVyLCByZW1vdmVMaXN0ZW5lcl9mbikuY2FsbCh0aGlzLCBsaXN0ZW5lcnMsIGxpc3RlbmVyKTtcbiAgICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykuc2V0KGV2ZW50TmFtZSwgbGlzdGVuZXJzKTtcbiAgICAgICAgICBfX3ByaXZhdGVNZXRob2QodGhpcywgX2ludGVybmFsRW1pdCwgaW50ZXJuYWxFbWl0X2ZuKS5jYWxsKHRoaXMsIFwicmVtb3ZlTGlzdGVuZXJcIiwgZXZlbnROYW1lLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBvZmYoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIHJlbW92ZUFsbExpc3RlbmVycyhldmVudE5hbWUpIHtcbiAgICAgICAgaWYgKGV2ZW50TmFtZSkge1xuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfZXZlbnRzKS5kZWxldGUoZXZlbnROYW1lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIGxpc3RlbmVycyhldmVudE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oX19wcml2YXRlTWV0aG9kKHRoaXMsIF9nZXRMaXN0ZW5lcnMsIGdldExpc3RlbmVyc19mbikuY2FsbCh0aGlzLCBldmVudE5hbWUpKTtcbiAgICAgIH1cbiAgICAgIGxpc3RlbmVyQ291bnQoZXZlbnROYW1lKSB7XG4gICAgICAgIHJldHVybiBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSkubGVuZ3RoO1xuICAgICAgfVxuICAgICAgcmF3TGlzdGVuZXJzKGV2ZW50TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lcnMoZXZlbnROYW1lKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBFbWl0dGVyMiA9IF9FbWl0dGVyO1xuICAgIF9ldmVudHMgPSBuZXcgV2Vha01hcCgpO1xuICAgIF9tYXhMaXN0ZW5lcnMgPSBuZXcgV2Vha01hcCgpO1xuICAgIF9oYXNXYXJuZWRBYm91dFBvdGVudGlhbE1lbW9ydHlMZWFrID0gbmV3IFdlYWtNYXAoKTtcbiAgICBfZ2V0TGlzdGVuZXJzID0gbmV3IFdlYWtTZXQoKTtcbiAgICBnZXRMaXN0ZW5lcnNfZm4gPSBmdW5jdGlvbihldmVudE5hbWUpIHtcbiAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykuZ2V0KGV2ZW50TmFtZSkgfHwgW107XG4gICAgfTtcbiAgICBfcmVtb3ZlTGlzdGVuZXIgPSBuZXcgV2Vha1NldCgpO1xuICAgIHJlbW92ZUxpc3RlbmVyX2ZuID0gZnVuY3Rpb24obGlzdGVuZXJzLCBsaXN0ZW5lcikge1xuICAgICAgY29uc3QgaW5kZXggPSBsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIF93cmFwT25jZUxpc3RlbmVyID0gbmV3IFdlYWtTZXQoKTtcbiAgICB3cmFwT25jZUxpc3RlbmVyX2ZuID0gZnVuY3Rpb24oZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgY29uc3Qgb25jZUxpc3RlbmVyID0gKC4uLmRhdGEpID0+IHtcbiAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIG9uY2VMaXN0ZW5lcik7XG4gICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGRhdGEpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBvbmNlTGlzdGVuZXI7XG4gICAgfTtcbiAgICBfaW50ZXJuYWxFbWl0ID0gbmV3IFdlYWtTZXQoKTtcbiAgICBpbnRlcm5hbEVtaXRfZm4gPSBmdW5jdGlvbihpbnRlcm5hbEV2ZW50TmFtZSwgZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgdGhpcy5lbWl0KFxuICAgICAgICBpbnRlcm5hbEV2ZW50TmFtZSxcbiAgICAgICAgLi4uW2V2ZW50TmFtZSwgbGlzdGVuZXJdXG4gICAgICApO1xuICAgIH07XG4gICAgX19wdWJsaWNGaWVsZChFbWl0dGVyMiwgXCJkZWZhdWx0TWF4TGlzdGVuZXJzXCIsIDEwKTtcbiAgICBleHBvcnRzLkVtaXR0ZXIgPSBFbWl0dGVyMjtcbiAgfVxufSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHJpY3QtZXZlbnQtZW1pdHRlckAwLjQuMy9ub2RlX21vZHVsZXMvc3RyaWN0LWV2ZW50LWVtaXR0ZXIvbGliL2luZGV4LmpzXG52YXIgcmVxdWlyZV9saWIgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc3RyaWN0LWV2ZW50LWVtaXR0ZXJAMC40LjMvbm9kZV9tb2R1bGVzL3N0cmljdC1ldmVudC1lbWl0dGVyL2xpYi9pbmRleC5qc1wiKGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gZXhwb3J0cyAmJiBleHBvcnRzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgICBpZiAoazIgPT09IHZvaWQgMClcbiAgICAgICAgazIgPSBrO1xuICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgfSB9O1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICB9IDogZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICAgIGlmIChrMiA9PT0gdm9pZCAwKVxuICAgICAgICBrMiA9IGs7XG4gICAgICBvW2syXSA9IG1ba107XG4gICAgfSk7XG4gICAgdmFyIF9fZXhwb3J0U3RhciA9IGV4cG9ydHMgJiYgZXhwb3J0cy5fX2V4cG9ydFN0YXIgfHwgZnVuY3Rpb24obSwgZXhwb3J0czIpIHtcbiAgICAgIGZvciAodmFyIHAgaW4gbSlcbiAgICAgICAgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0czIsIHApKVxuICAgICAgICAgIF9fY3JlYXRlQmluZGluZyhleHBvcnRzMiwgbSwgcCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgX19leHBvcnRTdGFyKHJlcXVpcmVfRW1pdHRlcigpLCBleHBvcnRzKTtcbiAgICBfX2V4cG9ydFN0YXIocmVxdWlyZV9NZW1vcnlMZWFrRXJyb3IoKSwgZXhwb3J0cyk7XG4gIH1cbn0pO1xuXG4vLyBzcmMvbWVzc2FnZXMudHNcbnZhciBpbXBvcnRfY3VpZCA9IF9fdG9FU00ocmVxdWlyZV9jdWlkKCkpO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vb3V0dmFyaWFudEAxLjQuMC9ub2RlX21vZHVsZXMvb3V0dmFyaWFudC9saWIvaW5kZXgubWpzXG52YXIgUE9TSVRJT05BTFNfRVhQID0gLyglPykoJShbc2Rqb10pKS9nO1xuZnVuY3Rpb24gc2VyaWFsaXplUG9zaXRpb25hbChwb3NpdGlvbmFsLCBmbGFnKSB7XG4gIHN3aXRjaCAoZmxhZykge1xuICAgIGNhc2UgXCJzXCI6XG4gICAgICByZXR1cm4gcG9zaXRpb25hbDtcbiAgICBjYXNlIFwiZFwiOlxuICAgIGNhc2UgXCJpXCI6XG4gICAgICByZXR1cm4gTnVtYmVyKHBvc2l0aW9uYWwpO1xuICAgIGNhc2UgXCJqXCI6XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocG9zaXRpb25hbCk7XG4gICAgY2FzZSBcIm9cIjoge1xuICAgICAgaWYgKHR5cGVvZiBwb3NpdGlvbmFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbmFsO1xuICAgICAgfVxuICAgICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KHBvc2l0aW9uYWwpO1xuICAgICAgaWYgKGpzb24gPT09IFwie31cIiB8fCBqc29uID09PSBcIltdXCIgfHwgL15cXFtvYmplY3QgLis/XFxdJC8udGVzdChqc29uKSkge1xuICAgICAgICByZXR1cm4gcG9zaXRpb25hbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZm9ybWF0KG1lc3NhZ2UsIC4uLnBvc2l0aW9uYWxzKSB7XG4gIGlmIChwb3NpdGlvbmFscy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfVxuICBsZXQgcG9zaXRpb25hbEluZGV4ID0gMDtcbiAgbGV0IGZvcm1hdHRlZE1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoXG4gICAgUE9TSVRJT05BTFNfRVhQLFxuICAgIChtYXRjaCwgaXNFc2NhcGVkLCBfLCBmbGFnKSA9PiB7XG4gICAgICBjb25zdCBwb3NpdGlvbmFsID0gcG9zaXRpb25hbHNbcG9zaXRpb25hbEluZGV4XTtcbiAgICAgIGNvbnN0IHZhbHVlID0gc2VyaWFsaXplUG9zaXRpb25hbChwb3NpdGlvbmFsLCBmbGFnKTtcbiAgICAgIGlmICghaXNFc2NhcGVkKSB7XG4gICAgICAgIHBvc2l0aW9uYWxJbmRleCsrO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2g7XG4gICAgfVxuICApO1xuICBpZiAocG9zaXRpb25hbEluZGV4IDwgcG9zaXRpb25hbHMubGVuZ3RoKSB7XG4gICAgZm9ybWF0dGVkTWVzc2FnZSArPSBgICR7cG9zaXRpb25hbHMuc2xpY2UocG9zaXRpb25hbEluZGV4KS5qb2luKFwiIFwiKX1gO1xuICB9XG4gIGZvcm1hdHRlZE1lc3NhZ2UgPSBmb3JtYXR0ZWRNZXNzYWdlLnJlcGxhY2UoLyV7MiwyfS9nLCBcIiVcIik7XG4gIHJldHVybiBmb3JtYXR0ZWRNZXNzYWdlO1xufVxudmFyIFNUQUNLX0ZSQU1FU19UT19JR05PUkUgPSAyO1xuZnVuY3Rpb24gY2xlYW5FcnJvclN0YWNrKGVycm9yKSB7XG4gIGlmICghZXJyb3Iuc3RhY2spIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgbmV4dFN0YWNrID0gZXJyb3Iuc3RhY2suc3BsaXQoXCJcXG5cIik7XG4gIG5leHRTdGFjay5zcGxpY2UoMSwgU1RBQ0tfRlJBTUVTX1RPX0lHTk9SRSk7XG4gIGVycm9yLnN0YWNrID0gbmV4dFN0YWNrLmpvaW4oXCJcXG5cIik7XG59XG52YXIgSW52YXJpYW50RXJyb3IgPSBjbGFzcyBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgLi4ucG9zaXRpb25hbHMpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMubmFtZSA9IFwiSW52YXJpYW50IFZpb2xhdGlvblwiO1xuICAgIHRoaXMubWVzc2FnZSA9IGZvcm1hdChtZXNzYWdlLCAuLi5wb3NpdGlvbmFscyk7XG4gICAgY2xlYW5FcnJvclN0YWNrKHRoaXMpO1xuICB9XG59O1xudmFyIGludmFyaWFudCA9IChwcmVkaWNhdGUsIG1lc3NhZ2UsIC4uLnBvc2l0aW9uYWxzKSA9PiB7XG4gIGlmICghcHJlZGljYXRlKSB7XG4gICAgdGhyb3cgbmV3IEludmFyaWFudEVycm9yKG1lc3NhZ2UsIC4uLnBvc2l0aW9uYWxzKTtcbiAgfVxufTtcbmludmFyaWFudC5hcyA9IChFcnJvckNvbnN0cnVjdG9yLCBwcmVkaWNhdGUsIG1lc3NhZ2UsIC4uLnBvc2l0aW9uYWxzKSA9PiB7XG4gIGlmICghcHJlZGljYXRlKSB7XG4gICAgY29uc3QgaXNDb25zdHJ1Y3RvciA9IEVycm9yQ29uc3RydWN0b3IucHJvdG90eXBlLm5hbWUgIT0gbnVsbDtcbiAgICBjb25zdCBlcnJvciA9IGlzQ29uc3RydWN0b3IgPyBuZXcgRXJyb3JDb25zdHJ1Y3Rvcihmb3JtYXQobWVzc2FnZSwgcG9zaXRpb25hbHMpKSA6IEVycm9yQ29uc3RydWN0b3IoZm9ybWF0KG1lc3NhZ2UsIHBvc2l0aW9uYWxzKSk7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbi8vIHNyYy9tZXNzYWdlcy50c1xudmFyIGltcG9ydF9kZWZlcnJlZF9wcm9taXNlID0gX190b0VTTShyZXF1aXJlX2J1aWxkKCkpO1xuXG4vLyBzcmMvbG9nZ2VyLnRzXG52YXIgRkxBRyA9IHdpbmRvdy5sb2NhbFN0b3JhZ2VbXCJDU0JfRU1VTEFUT1JfREVCVUdcIl07XG52YXIgREVGQVVMVCA9IFwiXFx4MUJbMG1cIjtcbnZhciBHUkVFTiA9IFwiXFx4MUJbMzI7MW1cIjtcbnZhciBSRUQgPSBcIlxceDFCWzMxbVwiO1xudmFyIEJMVUUgPSBcIlxceDFCWzM0bVwiO1xudmFyIFlFTExPVyA9IFwiXFx4MUJbMzM7MW1cIjtcbnZhciBNQUdFTlRBID0gXCJcXHgxQlszNTsxbVwiO1xudmFyIENZQU4gPSBcIlxceDFCWzM2OzFtXCI7XG52YXIgQ09MT1JfU0NPUEUgPSB7XG4gIHByZXZpZXc6IFlFTExPVyxcbiAgZW11bGF0b3I6IE1BR0VOVEEsXG4gIHJ1bnRpbWU6IENZQU4sXG4gIGJyaWRnZTogQkxVRSxcbiAgXCJydW50aW1lOndvcmtlclwiOiBDWUFOXG59O1xuZnVuY3Rpb24gY3JlYXRlRGVidWcoc2NvcGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGRlYnVnMyhtZXNzYWdlLCAuLi5kYXRhKSB7XG4gICAgaWYgKEZMQUcgPT09IFwidHJ1ZVwiKSB7XG4gICAgICBjb25zdCBkaXJlY3Rpb24gPSAoKSA9PiB7XG4gICAgICAgIGlmIChtZXNzYWdlLmluY2x1ZGVzKFwic2VuZGVyXCIpKVxuICAgICAgICAgIHJldHVybiBgJHtHUkVFTn1zZW5kZXJgO1xuICAgICAgICBpZiAobWVzc2FnZS5pbmNsdWRlcyhcInJlY2VpdmVyXCIpKVxuICAgICAgICAgIHJldHVybiBgJHtSRUR9cmVjZWl2ZXJgO1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgIH07XG4gICAgICBjb25zdCBjbGVhbk1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoL1xcWy4rXFxdOi8sIFwiXCIpO1xuICAgICAgY29uc29sZS5kZWJ1ZyhgJHtDT0xPUl9TQ09QRVtzY29wZV19JHtzY29wZX06JHtkaXJlY3Rpb24oKX0ke0RFRkFVTFR9OiR7Y2xlYW5NZXNzYWdlfWAsIC4uLmRhdGEpO1xuICAgIH1cbiAgfTtcbn1cblxuLy8gc3JjL21lc3NhZ2VzLnRzXG52YXIgZGVidWcgPSBjcmVhdGVEZWJ1ZyhcImVtdWxhdG9yXCIpO1xudmFyIE1lc3NhZ2VSZWNlaXZlciA9IGNsYXNzIHtcbiAgZW1pdHRlcjtcbiAgc2VuZGVyUG9ydCA9IG51bGw7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZW1pdHRlciA9IG5ldyBFdmVudFRhcmdldCgpO1xuICAgIHRoaXMud2FpdEZvckhhbmRzaGFrZSgpO1xuICB9XG4gIHdhaXRGb3JIYW5kc2hha2UoKSB7XG4gICAgY29uc3QgaGFuZHNoYWtlUHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZS5EZWZlcnJlZFByb21pc2UoKTtcbiAgICBjb25zdCBoYW5kc2hha2VMaXN0ZW5lciA9IChtZXNzYWdlKSA9PiB7XG4gICAgICBjb25zdCB7IGRhdGEgfSA9IG1lc3NhZ2U7XG4gICAgICBkZWJ1ZyhcIlttZXNzYWdlLXJlY2VpdmVyXTogaW5jb21pbmdcIiwgbWVzc2FnZSk7XG4gICAgICBpZiAoZGF0YS50eXBlID09PSBcImludGVybmFsL2hhbmRzaGFrZVwiKSB7XG4gICAgICAgIGludmFyaWFudChcbiAgICAgICAgICBtZXNzYWdlLnBvcnRzLmxlbmd0aCA+IDAsXG4gICAgICAgICAgXCJGYWlsZWQgdG8gY29uZmlybSBhIE1lc3NhZ2VSZWNlaXZlciBoYW5kc2hha2U6IHJlY2VpdmVkIGV2ZW50IGhhcyBubyBwb3J0c1wiXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuc2VuZGVyUG9ydCA9IG1lc3NhZ2UucG9ydHNbMF07XG4gICAgICAgIHRoaXMuYWRkTWVzc2FnZUxpc3RlbmVyKCk7XG4gICAgICAgIGRlYnVnKFwiW21lc3NhZ2UtcmVjZWl2ZXJdOiBoYW5kc2hha2UgcmVjZWl2ZWQhXCIsIHRoaXMuc2VuZGVyUG9ydCk7XG4gICAgICAgIHRoaXMuc2VuZChcImludGVybmFsL2hhbmRzaGFrZS9kb25lXCIpO1xuICAgICAgICBkZWJ1ZyhcIlttZXNzYWdlLXJlY2VpdmVyXTogZmluaXNoIGhhbmRzaGFrZVwiKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBoYW5kc2hha2VMaXN0ZW5lcik7XG4gICAgaGFuZHNoYWtlUHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBoYW5kc2hha2VMaXN0ZW5lcik7XG4gICAgfSk7XG4gICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6IFwiaW50ZXJuYWwvcmVhZHlcIiB9LCBcIipcIik7XG4gICAgcmV0dXJuIGhhbmRzaGFrZVByb21pc2U7XG4gIH1cbiAgYWRkTWVzc2FnZUxpc3RlbmVyKCkge1xuICAgIGludmFyaWFudChcbiAgICAgIHRoaXMuc2VuZGVyUG9ydCxcbiAgICAgIFwiW01lc3NhZ2VSZWNlaXZlcl0gRmFpbGVkIHRvIGFkZCBhIG1lc3NhZ2UgbGlzdGVuZXI6IHNlbmRlciBwb3J0IGlzIG5vdCBkZWZpbmVkLiBEaWQgeW91IGZvcmdldCB0byBhd2FpdCBhIGhhbmRzaGFrZT9cIlxuICAgICk7XG4gICAgdGhpcy5zZW5kZXJQb3J0Lm9ubWVzc2FnZSA9IChldnQpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBldnQuZGF0YTtcbiAgICAgIGlmIChkYXRhLnR5cGUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmVtaXR0ZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgbmV3IE1lc3NhZ2VFdmVudChkYXRhLnR5cGUsIHtcbiAgICAgICAgICBkYXRhOiBkYXRhLnBheWxvYWRcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfTtcbiAgfVxuICBvbihldmVudCwgbGlzdGVuZXIsIG9wdGlvbnMpIHtcbiAgICB0aGlzLmVtaXR0ZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIGV2ZW50LFxuICAgICAgYXN5bmMgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgaWYgKCEobWVzc2FnZSBpbnN0YW5jZW9mIE1lc3NhZ2VFdmVudCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBvcGVyYXRpb25JZCwgcGF5bG9hZCB9ID0gbWVzc2FnZS5kYXRhO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGxpc3RlbmVyUGF5bG9hZCA9IGF3YWl0IGxpc3RlbmVyKHBheWxvYWQpO1xuICAgICAgICAgIHRoaXMuc2VuZChcImludGVybmFsL29wZXJhdGlvbi9kb25lXCIsIHsgb3BlcmF0aW9uSWQsIGxpc3RlbmVyUGF5bG9hZCB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgdGhpcy5zZW5kKFwiaW50ZXJuYWwvb3BlcmF0aW9uL2ZhaWxlZFwiLCB7IG9wZXJhdGlvbklkLCBlcnJvciB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgfVxuICBzZW5kKGV2ZW50LCAuLi5kYXRhKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5zZW5kZXJQb3J0LFxuICAgICAgJ1tNZXNzYWdlUmVjZWl2ZXJdIEZhaWxlZCB0byBzZW5kIGEgbWVzc2FnZSBcIiVqXCI6IHNlbmRlciBwb3J0IGlzIG5vdCBkZWZpbmVkLiBEaWQgeW91IGZvcmdldCB0byBhd2FpdCBhIGhhbmRzaGFrZT8nLFxuICAgICAgZXZlbnRcbiAgICApO1xuICAgIGNvbnN0IHBheWxvYWQgPSBkYXRhWzBdIHx8IHt9O1xuICAgIGRlYnVnKCdbbWVzc2FnZS1yZWNlaXZlcl06IHNlbmQgXCIlc1wiJywgZXZlbnQsIHBheWxvYWQpO1xuICAgIHRoaXMuc2VuZGVyUG9ydC5wb3N0TWVzc2FnZSh7IHR5cGU6IGV2ZW50LCBwYXlsb2FkIH0pO1xuICB9XG59O1xudmFyIE1lc3NhZ2VTZW5kZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldCkge1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMuZW1pdHRlciA9IG5ldyBFdmVudFRhcmdldCgpO1xuICAgIHRoaXMuY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICAgIHRoaXMucmVjZWl2ZXJQb3J0ID0gdGhpcy5jaGFubmVsLnBvcnQxO1xuICAgIGNvbnN0IHJlY2VpdmVyUmVhZHlQcm9taXNlID0gbmV3IGltcG9ydF9kZWZlcnJlZF9wcm9taXNlLkRlZmVycmVkUHJvbWlzZSgpO1xuICAgIGNvbnN0IGhhbmRzaGFrZUxpc3RlbmVyID0gKG1lc3NhZ2UpID0+IHtcbiAgICAgIGlmIChtZXNzYWdlLmRhdGEudHlwZSA9PT0gXCJpbnRlcm5hbC9yZWFkeVwiKSB7XG4gICAgICAgIGRlYnVnKFwiW21lc3NhZ2Utc2VuZGVyXTogcnVudGltZSBpcyByZWFkeVwiKTtcbiAgICAgICAgcmVjZWl2ZXJSZWFkeVByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRzaGFrZUxpc3RlbmVyKTtcbiAgICByZWNlaXZlclJlYWR5UHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBoYW5kc2hha2VMaXN0ZW5lcik7XG4gICAgfSk7XG4gICAgdGhpcy5yZWNlaXZlclJlYWR5UHJvbWlzZSA9IHJlY2VpdmVyUmVhZHlQcm9taXNlO1xuICAgIHRoaXMucmVjZWl2ZXJQb3J0Lm9ubWVzc2FnZSA9IChldnQpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBldnQuZGF0YTtcbiAgICAgIGlmIChkYXRhLnR5cGUgIT0gbnVsbCkge1xuICAgICAgICBkZWJ1ZygnW21lc3NhZ2Utc2VuZGVyXTogZW1pdHRpbmcgXCIlc1wiIGV2ZW50Li4uJywgZGF0YS50eXBlLCBkYXRhLnBheWxvYWQpO1xuICAgICAgICB0aGlzLmVtaXR0ZXIuZGlzcGF0Y2hFdmVudChuZXcgTWVzc2FnZUV2ZW50KGRhdGEudHlwZSwgeyBkYXRhOiBkYXRhLnBheWxvYWQgfSkpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgZW1pdHRlcjtcbiAgY2hhbm5lbDtcbiAgcmVjZWl2ZXJQb3J0O1xuICByZWNlaXZlclJlYWR5UHJvbWlzZTtcbiAgYXN5bmMgaGFuZHNoYWtlKCkge1xuICAgIGNvbnN0IGhhbmRzaGFrZVByb21pc2UgPSBuZXcgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgYXdhaXQgdGhpcy5yZWNlaXZlclJlYWR5UHJvbWlzZTtcbiAgICBkZWJ1ZyhcIlttZXNzYWdlLXNlbmRlcl06IHNlbmRpbmcgaGFuZHNoYWtlXCIpO1xuICAgIHRoaXMudGFyZ2V0LnBvc3RNZXNzYWdlKFxuICAgICAge1xuICAgICAgICB0eXBlOiBcImludGVybmFsL2hhbmRzaGFrZVwiXG4gICAgICB9LFxuICAgICAgXCIqXCIsXG4gICAgICBbdGhpcy5jaGFubmVsLnBvcnQyXVxuICAgICk7XG4gICAgdGhpcy5vbihcImludGVybmFsL2hhbmRzaGFrZS9kb25lXCIsICgpID0+IHtcbiAgICAgIGhhbmRzaGFrZVByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgY2xlYXJUaW1lb3V0KHJlamVjdGlvblRpbWVvdXQpO1xuICAgIH0pO1xuICAgIGNvbnN0IHJlamVjdGlvblRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGhhbmRzaGFrZVByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIk1lc3NhZ2VTZW5kZXI6IEhhbmRzaGFrZSB0aW1lb3V0XCIpKTtcbiAgICB9LCA1ZTMpO1xuICAgIHJldHVybiBoYW5kc2hha2VQcm9taXNlO1xuICB9XG4gIG9uKGV2ZW50LCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgIGRlYnVnKCdbbWVzc2FnZS1zZW5kZXJdOiBhZGQgbGlzdGVuZXIgXCIlc1wiJywgZXZlbnQpO1xuICAgIHRoaXMuZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgZXZlbnQsXG4gICAgICAobWVzc2FnZSkgPT4ge1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIE1lc3NhZ2VFdmVudCkge1xuICAgICAgICAgIGxpc3RlbmVyKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3B0aW9uc1xuICAgICk7XG4gIH1cbiAgb2ZmKGV2ZW50LCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgIHRoaXMuZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gIH1cbiAgYXN5bmMgc2VuZChldmVudCwgLi4uZGF0YSkge1xuICAgIGNvbnN0IG9wZXJhdGlvblByb21pc2UgPSBuZXcgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgY29uc3Qgb3BlcmF0aW9uSWQgPSAoMCwgaW1wb3J0X2N1aWQuZGVmYXVsdCkoKTtcbiAgICBjb25zdCBwYXlsb2FkID0gZGF0YVswXSB8fCB7fTtcbiAgICBkZWJ1ZygnW21lc3NhZ2Utc2VuZGVyXTogc2VuZCBcIiVzXCIgKCVzKScsIGV2ZW50LCBvcGVyYXRpb25JZCwgcGF5bG9hZCk7XG4gICAgdGhpcy5yZWNlaXZlclBvcnQucG9zdE1lc3NhZ2UoeyB0eXBlOiBldmVudCwgcGF5bG9hZDogeyBvcGVyYXRpb25JZCwgcGF5bG9hZCB9IH0pO1xuICAgIGRlYnVnKCdbbWVzc2FnZS1zZW5kZXJdOiBhZGRpbmcgZG9uZSBsaXN0ZW5lciBmb3IgXCIlc1wiICglcyknLCBldmVudCwgb3BlcmF0aW9uSWQpO1xuICAgIGNvbnN0IGhhbmRsZU9wZXJhdGlvbkRvbmUgPSAoZG9uZUV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGRhdGE6IGRhdGEyIH0gPSBkb25lRXZlbnQ7XG4gICAgICBpZiAoZGF0YTIub3BlcmF0aW9uSWQgPT09IG9wZXJhdGlvbklkKSB7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVyUGF5bG9hZCA9IGRhdGEyLmxpc3RlbmVyUGF5bG9hZCB8fCB7fTtcbiAgICAgICAgZGVidWcoJ1ttZXNzYWdlLXNlbmRlcl06IHJlc29sdmluZyBcIiVzICglcykgcHJvbWlzZSEnLCBldmVudCwgb3BlcmF0aW9uSWQpO1xuICAgICAgICBvcGVyYXRpb25Qcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIC4uLmxpc3RlbmVyUGF5bG9hZCxcbiAgICAgICAgICBvcGVyYXRpb25JZDogZGF0YTIub3BlcmF0aW9uSWRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPcGVyYXRpb25GYWlsZWQgPSAoZmFpbEV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IGRhdGE6IGRhdGEyIH0gPSBmYWlsRXZlbnQ7XG4gICAgICBpZiAoZGF0YTIub3BlcmF0aW9uSWQgPT09IG9wZXJhdGlvbklkKSB7XG4gICAgICAgIGRlYnVnKCdbbWVzc2FnZS1zZW5kZXJdOiByZWplY3RpbmcgXCIlcyAoJXMpIHByb21pc2UhJywgZXZlbnQsIG9wZXJhdGlvbklkKTtcbiAgICAgICAgb3BlcmF0aW9uUHJvbWlzZS5yZWplY3QoZGF0YTIuZXJyb3IpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5vbihcImludGVybmFsL29wZXJhdGlvbi9kb25lXCIsIGhhbmRsZU9wZXJhdGlvbkRvbmUpO1xuICAgIHRoaXMub24oXCJpbnRlcm5hbC9vcGVyYXRpb24vZmFpbGVkXCIsIGhhbmRsZU9wZXJhdGlvbkZhaWxlZCk7XG4gICAgcmV0dXJuIG9wZXJhdGlvblByb21pc2UuZmluYWxseSgoKSA9PiB7XG4gICAgICB0aGlzLmVtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImludGVybmFsL29wZXJhdGlvbi9kb25lXCIsIGhhbmRsZU9wZXJhdGlvbkRvbmUpO1xuICAgICAgdGhpcy5lbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJpbnRlcm5hbC9vcGVyYXRpb24vZmFpbGVkXCIsIGhhbmRsZU9wZXJhdGlvbkZhaWxlZCk7XG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHNyYy9Ob2RlYm94LnRzXG52YXIgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UzID0gX190b0VTTShyZXF1aXJlX2J1aWxkKCkpO1xuXG4vLyBzcmMvbW9kdWxlcy9mcy50c1xudmFyIGltcG9ydF9jdWlkMiA9IF9fdG9FU00ocmVxdWlyZV9jdWlkKCkpO1xudmFyIEZpbGVTeXN0ZW1BcGkgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNoYW5uZWwpIHtcbiAgICB0aGlzLmNoYW5uZWwgPSBjaGFubmVsO1xuICB9XG4gIGFzeW5jIGluaXQoZmlsZXMpIHtcbiAgICBhd2FpdCB0aGlzLmNoYW5uZWwuc2VuZChcImZzL2luaXRcIiwgeyBmaWxlcyB9KTtcbiAgfVxuICBhc3luYyByZWFkRmlsZShwYXRoLCBlbmNvZGluZykge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy9yZWFkRmlsZVwiLCB7IHBhdGgsIGVuY29kaW5nIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIHJlYWQgZmlsZSBhdCBwYXRoIFwiJXNcIicsIHBhdGgpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGaWxlIG5vdCBmb3VuZFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gIH1cbiAgYXN5bmMgd3JpdGVGaWxlKHBhdGgsIGNvbnRlbnQsIG9wdGlvbnMpIHtcbiAgICBsZXQgZW5jb2RpbmcgPSB2b2lkIDA7XG4gICAgbGV0IHJlY3Vyc2l2ZSA9IGZhbHNlO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgZW5jb2RpbmcgPSBvcHRpb25zLmVuY29kaW5nO1xuICAgICAgcmVjdXJzaXZlID0gISFvcHRpb25zLnJlY3Vyc2l2ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBlbmNvZGluZyA9IG9wdGlvbnM7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwiZnMvd3JpdGVGaWxlXCIsIHsgcGF0aCwgY29udGVudCwgZW5jb2RpbmcsIHJlY3Vyc2l2ZSB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihmb3JtYXQoJ0ZhaWxlZCB0byB3cml0ZSBmaWxlIGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICB9XG4gIGFzeW5jIHJlYWRkaXIocGF0aCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy9yZWFkZGlyXCIsIHsgcGF0aCB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihmb3JtYXQoJ0ZhaWxlZCB0byByZWFkIGRpcmVjdG9yeSBhdCBwYXRoIFwiJXNcIicsIHBhdGgpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEaXJlY3Rvcnkgbm90IGZvdW5kXCIpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuICBhc3luYyBta2RpcihwYXRoLCBvcHRpb25zKSB7XG4gICAgY29uc3QgcmVjdXJzaXZlID0gISFvcHRpb25zPy5yZWN1cnNpdmU7XG4gICAgYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy9ta2RpclwiLCB7IHBhdGgsIHJlY3Vyc2l2ZSB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihmb3JtYXQoJ0ZhaWxlZCB0byBtYWtlIGRpcmVjdG9yeSBhdCBwYXRoIFwiJXNcIicsIHBhdGgpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyBzdGF0KHBhdGgpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwiZnMvc3RhdFwiLCB7IHBhdGggfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KCdGYWlsZWQgdG8gc3RhdCBmaWxlIGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZpbGUgbm90IGZvdW5kXCIpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuICBhc3luYyBybShwYXRoLCBvcHRpb25zKSB7XG4gICAgY29uc3QgeyBmb3JjZSwgcmVjdXJzaXZlIH0gPSBvcHRpb25zIHx8IHt9O1xuICAgIGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwiZnMvcm1cIiwgeyBwYXRoLCBmb3JjZSwgcmVjdXJzaXZlIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIHJlbW92ZSBmaWxlIGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICB9XG4gIGFzeW5jIHdhdGNoKGluY2x1ZGVzLCBleGNsdWRlcywgbGlzdGVuZXIpIHtcbiAgICBjb25zdCB3YXRjaGVySWQgPSAoMCwgaW1wb3J0X2N1aWQyLmRlZmF1bHQpKCk7XG4gICAgYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy93YXRjaFwiLCB7IHdhdGNoZXJJZCwgaW5jbHVkZXMsIGV4Y2x1ZGVzIH0pO1xuICAgIHRoaXMuY2hhbm5lbC5vbihcImZzL3dhdGNoLWV2ZW50XCIsICh7IGRhdGEgfSkgPT4ge1xuICAgICAgaWYgKGRhdGEud2F0Y2hlcklkID09PSB3YXRjaGVySWQgJiYgbGlzdGVuZXIpIHtcbiAgICAgICAgY29uc3QgZXZ0ID0geyAuLi5kYXRhIH07XG4gICAgICAgIGRlbGV0ZSBldnQud2F0Y2hlcklkO1xuICAgICAgICBsaXN0ZW5lcihldnQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICBkaXNwb3NlOiAoKSA9PiB0aGlzLmNoYW5uZWwuc2VuZChcImZzL3Vud2F0Y2hcIiwgeyB3YXRjaGVySWQgfSlcbiAgICB9O1xuICB9XG59O1xuXG4vLyBzcmMvbW9kdWxlcy9zaGVsbC50c1xudmFyIGltcG9ydF9zdHJpY3RfZXZlbnRfZW1pdHRlciA9IF9fdG9FU00ocmVxdWlyZV9saWIoKSk7XG52YXIgU2hlbGxBcGkgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNoYW5uZWwpIHtcbiAgICB0aGlzLmNoYW5uZWwgPSBjaGFubmVsO1xuICB9XG4gIGNyZWF0ZSgpIHtcbiAgICByZXR1cm4gbmV3IFNoZWxsUHJvY2Vzcyh0aGlzLmNoYW5uZWwpO1xuICB9XG59O1xudmFyIFNoZWxsUHJvY2VzcyA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY2hhbm5lbCkge1xuICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG4gICAgdGhpcy5zdGF0ZSA9IFwicnVubmluZ1wiO1xuICAgIHRoaXMuc3Rkb3V0ID0gbmV3IGltcG9ydF9zdHJpY3RfZXZlbnRfZW1pdHRlci5FbWl0dGVyKCk7XG4gICAgdGhpcy5zdGRlcnIgPSBuZXcgaW1wb3J0X3N0cmljdF9ldmVudF9lbWl0dGVyLkVtaXR0ZXIoKTtcbiAgICB0aGlzLnN0ZGluID0ge1xuICAgICAgd3JpdGU6IChkYXRhKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5pZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byB3cml0ZSB0byBzdGRpbiwgbm8gcHJvY2VzcyBpcyBjdXJyZW50bHkgcnVubmluZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsLnNlbmQoXCJzaGVsbC9zdGRpblwiLCB7IGRhdGEsIHdvcmtlcklkOiB0aGlzLmlkIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5mb3J3YXJkU3RkRXZlbnRzKCk7XG4gIH1cbiAgaWQ7XG4gIHN0YXRlO1xuICBzdGRvdXQ7XG4gIHN0ZGVycjtcbiAgc3RkaW47XG4gIGZvcndhcmRTdGRFdmVudHMoKSB7XG4gICAgdGhpcy5jaGFubmVsLm9uKFwid29ya2VyL3R0eVwiLCAobWVzc2FnZSkgPT4ge1xuICAgICAgY29uc3QgeyBkYXRhIH0gPSBtZXNzYWdlO1xuICAgICAgaWYgKGRhdGEud29ya2VySWQgIT09IHRoaXMuaWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc3dpdGNoIChkYXRhLnBheWxvYWQudHlwZSkge1xuICAgICAgICBjYXNlIFwib3V0XCI6IHtcbiAgICAgICAgICB0aGlzLnN0ZG91dC5lbWl0KFwiZGF0YVwiLCBkYXRhLnBheWxvYWQuZGF0YSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcImVyclwiOiB7XG4gICAgICAgICAgdGhpcy5zdGRlcnIuZW1pdChcImRhdGFcIiwgZGF0YS5wYXlsb2FkLmRhdGEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgcnVuQ29tbWFuZChjb21tYW5kLCBhcmdzLCBvcHRpb25zID0ge30pIHtcbiAgICBpbnZhcmlhbnQoIXRoaXMuaWQsICdGYWlsZWQgdG8gcnVuIFwicnVuQ29tbWFuZFwiIG9uIGEgU2hlbGxQcm9jZXNzOiB0aGVyZSBpcyBhbHJlYWR5IGEgcHJvY2VzcyBydW5uaW5nLicpO1xuICAgIGNvbnN0IHNoZWxsSW5mbyA9IGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwic2hlbGwvcnVuQ29tbWFuZFwiLCB7IGNvbW1hbmQsIGFyZ3MsIG9wdGlvbnMgfSk7XG4gICAgaW52YXJpYW50KHNoZWxsSW5mbywgJ0ZhaWxlZCB0byBydW4gXCJydW5Db21tYW5kXCIgb24gYSBTaGVsbFByb2Nlc3M6IHdhcyBub3QgYWJsZSB0byByZXRyaWV2ZSBhIHJ1bm5pbmcgcHJvY2Vzcy4nKTtcbiAgICB0aGlzLmlkID0gc2hlbGxJbmZvLmlkO1xuICAgIHRoaXMuc3RhdGUgPSBcInJ1bm5pbmdcIjtcbiAgICByZXR1cm4gc2hlbGxJbmZvO1xuICB9XG4gIGFzeW5jIG9uKG1lc3NhZ2UsIGxpc3RlbmVyKSB7XG4gICAgc3dpdGNoIChtZXNzYWdlKSB7XG4gICAgICBjYXNlIFwicHJvZ3Jlc3NcIjoge1xuICAgICAgICB0aGlzLmNoYW5uZWwub24oXCJ3b3JrZXIvcHJvZ3Jlc3NcIiwgKHsgZGF0YSB9KSA9PiB7XG4gICAgICAgICAgbGlzdGVuZXIoZGF0YS5zdGF0dXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY2FzZSBcImV4aXRcIjoge1xuICAgICAgICB0aGlzLmNoYW5uZWwub24oXCJ3b3JrZXIvZXhpdFwiLCAoeyBkYXRhIH0pID0+IHtcbiAgICAgICAgICBpZiAoZGF0YS53b3JrZXJJZCA9PT0gdGhpcy5pZCkge1xuICAgICAgICAgICAgbGlzdGVuZXIoZGF0YS5leGl0Q29kZSwgZGF0YS5lcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBhc3luYyBraWxsKCkge1xuICAgIGludmFyaWFudChcbiAgICAgIHRoaXMuaWQsXG4gICAgICAnRmFpbGVkIHRvIHJ1biBcImtpbGxcIiBvbiBhIFNoZWxsUHJvY2VzczogdGhlcmUgaXMgbm8gcHJvY2VzcyBydW5uaW5nLiBEaWQgeW91IGZvcmdldCB0byBydW4gaXQ/J1xuICAgICk7XG4gICAgdGhpcy5zdGF0ZSA9IFwiaWRsZVwiO1xuICAgIGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwic2hlbGwvZXhpdFwiLCB7IGlkOiB0aGlzLmlkIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIGtpbGwgc2hlbGwgd2l0aCBJRCBcIiVzXCInLCB0aGlzLmlkKSwgeyBjYXVzZTogZXJyb3IgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5pZCA9IHZvaWQgMDtcbiAgfVxufTtcblxuLy8gc3JjL21vZHVsZXMvcHJldmlldy50c1xudmFyIGltcG9ydF9kZWZlcnJlZF9wcm9taXNlMiA9IF9fdG9FU00ocmVxdWlyZV9idWlsZCgpKTtcbnZhciBUSU1FT1VUID0gMmU0O1xudmFyIFByZXZpZXdBcGkgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNoYW5uZWwpIHtcbiAgICB0aGlzLmNoYW5uZWwgPSBjaGFubmVsO1xuICB9XG4gIGFzeW5jIHdhaXRGb3IocGF5bG9hZCwgcHJlZGljYXRlLCB0aW1lb3V0ID0gVElNRU9VVCkge1xuICAgIGNvbnN0IHJlYWR5UHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZTIuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgY29uc3QgcmVqZWN0VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgcmVhZHlQcm9taXNlLnJlamVjdCgpO1xuICAgIH0sIHRpbWVvdXQpO1xuICAgIGNvbnN0IHByZXZpZXdJbmZvcm1hdGlvbiA9IGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwicHJldmlldy9nZXQvaW5mb1wiLCBwYXlsb2FkKS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHJlYWR5UHJvbWlzZS5yZWplY3QoXG4gICAgICAgIG5ldyBFcnJvcihcbiAgICAgICAgICBmb3JtYXQoXG4gICAgICAgICAgICAnRmFpbGVkIHRvIGxvb2sgdXAgcHJldmlldyBpbmZvcm1hdGlvbiBmb3Igc2hlbGwgSUQgXCIlc1wiIChwb3J0OiAlZCknLFxuICAgICAgICAgICAgcGF5bG9hZC5zb3VyY2VTaGVsbElkLFxuICAgICAgICAgICAgcGF5bG9hZC5wb3J0XG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApO1xuICAgIH0pO1xuICAgIGNvbnN0IGZvdW5kUHJldmlldyA9IHByZXZpZXdJbmZvcm1hdGlvbiAmJiBwcmVkaWNhdGUocHJldmlld0luZm9ybWF0aW9uKTtcbiAgICBpZiAoZm91bmRQcmV2aWV3KSB7XG4gICAgICByZWFkeVByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIHVybDogcHJldmlld0luZm9ybWF0aW9uLnVybCxcbiAgICAgICAgcG9ydDogcHJldmlld0luZm9ybWF0aW9uLnBvcnQsXG4gICAgICAgIHNvdXJjZVNoZWxsSWQ6IHByZXZpZXdJbmZvcm1hdGlvbi5zb3VyY2VTaGVsbElkXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5jaGFubmVsLm9uKFwicHJldmlldy9wb3J0L3JlYWR5XCIsICh7IGRhdGEgfSkgPT4ge1xuICAgICAgaWYgKCFmb3VuZFByZXZpZXcgJiYgcHJlZGljYXRlKGRhdGEpKSB7XG4gICAgICAgIHJlYWR5UHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICB1cmw6IGRhdGEudXJsLFxuICAgICAgICAgIHBvcnQ6IGRhdGEucG9ydCxcbiAgICAgICAgICBzb3VyY2VTaGVsbElkOiBkYXRhLnNvdXJjZVNoZWxsSWRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlYWR5UHJvbWlzZS5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dChyZWplY3RUaW1lb3V0KTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyBnZXRCeVNoZWxsSWQoc291cmNlU2hlbGxJZCwgdGltZW91dCkge1xuICAgIHJldHVybiB0aGlzLndhaXRGb3IoeyBzb3VyY2VTaGVsbElkIH0sIChkYXRhKSA9PiBkYXRhLnNvdXJjZVNoZWxsSWQgPT09IHNvdXJjZVNoZWxsSWQsIHRpbWVvdXQpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIGdldCBzaGVsbCBieSBJRCBcIiVzXCInLCBzb3VyY2VTaGVsbElkKSwgeyBjYXVzZTogZXJyb3IgfSk7XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgd2FpdEZvclBvcnQocG9ydCwgdGltZW91dCkge1xuICAgIHJldHVybiB0aGlzLndhaXRGb3IoeyBwb3J0IH0sIChkYXRhKSA9PiBkYXRhLnBvcnQgPT09IHBvcnQsIHRpbWVvdXQpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdChcIkZhaWxlZCB0byBhd2FpdCBwb3J0ICVkXCIsIHBvcnQpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gc3JjL05vZGVib3gudHNcbnZhciBERUZBVUxUX1JVTlRJTUVfVVJMID0gXCJodHRwczovL25vZGVib3gtcnVudGltZS5jb2Rlc2FuZGJveC5pb1wiO1xudmFyIGRlYnVnMiA9IGNyZWF0ZURlYnVnKFwiZW11bGF0b3JcIik7XG52YXIgTm9kZWJveCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5vcHRpb25zLmlmcmFtZSxcbiAgICAgICdGYWlsZWQgdG8gY3JlYXRlIGEgTm9kZWJveDogZXhwZWN0ZWQgXCJpZnJhbWVcIiBhcmd1bWVudCB0byBiZSBhIHJlZmVyZW5jZSB0byBhbiA8aWZyYW1lPiBlbGVtZW50IGJ1dCBnb3QgJWonLFxuICAgICAgdGhpcy5vcHRpb25zLmlmcmFtZVxuICAgICk7XG4gICAgdGhpcy51cmwgPSB0aGlzLm9wdGlvbnMucnVudGltZVVybCB8fCBERUZBVUxUX1JVTlRJTUVfVVJMO1xuICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgfVxuICBjaGFubmVsID0gbnVsbDtcbiAgaXNDb25uZWN0ZWQ7XG4gIHVybDtcbiAgZmlsZVN5c3RlbUFwaSA9IG51bGw7XG4gIHNoZWxsQXBpID0gbnVsbDtcbiAgcHJldmlld0FwaSA9IG51bGw7XG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgY29uc3QgeyBpZnJhbWUsIGNkblVybCB9ID0gdGhpcy5vcHRpb25zO1xuICAgIGRlYnVnMihcIlttZXNzYWdlLXNlbmRlcl06IENvbm5lY3RpbmcgdG8gbm9kZSBlbXVsYXRvci4uLlwiKTtcbiAgICBjb25zdCBjb25uZWN0aW9uUHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZTMuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgaWYgKCF0aGlzLnVybCkge1xuICAgICAgY29ubmVjdGlvblByb21pc2UucmVqZWN0KFxuICAgICAgICBuZXcgRXJyb3IoXCJOb2RlYm94IFVSTCBpcyBtaXNzaW5nLiBEaWQgeW91IGZvcmdldCB0byBwcm92aWRlIGl0IHdoZW4gY3JlYXRpbmcgdGhpcyBOb2RlYm94IGluc3RhbmNlP1wiKVxuICAgICAgKTtcbiAgICB9XG4gICAgaW52YXJpYW50KFxuICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3csXG4gICAgICBcIkZhaWxlZCB0byBjcmVhdGUgYSBNZXNzYWdlQ2hhbm5lbCB3aXRoIHRoZSBOb2RlYm94IGlmcmFtZTogbm8gY29udGVudCB3aW5kb3cgZm91bmRcIlxuICAgICk7XG4gICAgdGhpcy5jaGFubmVsID0gbmV3IE1lc3NhZ2VTZW5kZXIoaWZyYW1lLmNvbnRlbnRXaW5kb3cpO1xuICAgIGNvbnN0IGZyYW1lTG9hZFByb21pc2UgPSBuZXcgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UzLkRlZmVycmVkUHJvbWlzZSgpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy51cmwpO1xuICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJsb2FkXCIsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGZyYW1lTG9hZFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfSxcbiAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgKTtcbiAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwiZXJyb3JcIixcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICBmcmFtZUxvYWRQcm9taXNlLnJlamVjdChldmVudC5lcnJvcik7XG4gICAgICB9LFxuICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICApO1xuICAgIGF3YWl0IGZyYW1lTG9hZFByb21pc2U7XG4gICAgZGVidWcyKFwiW21lc3NhZ2Utc2VuZGVyXTogSUZyYW1lIGxvYWRlZC4uLlwiKTtcbiAgICBhd2FpdCB0aGlzLmNoYW5uZWwuaGFuZHNoYWtlKCk7XG4gICAgZGVidWcyKFwiW21lc3NhZ2Utc2VuZGVyXTogSGFuZHNoYWtlIGNvbXBsZXRlZC4uLlwiKTtcbiAgICB0aGlzLmNoYW5uZWwuc2VuZChcImNvbm5lY3RcIiwge1xuICAgICAgY2RuVXJsXG4gICAgfSk7XG4gICAgdGhpcy5jaGFubmVsLm9uKFwicnVudGltZS9yZWFkeVwiLCAoKSA9PiB7XG4gICAgICBjb25uZWN0aW9uUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvbm5lY3Rpb25Qcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgZGVidWcyKFwiW21lc3NhZ2Utc2VuZGVyXTogQ29ubmVjdGVkIHRvIHJ1bnRpbWUuLi5cIik7XG4gICAgICB0aGlzLmlzQ29ubmVjdGVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuICBnZXQgZnMoKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5pc0Nvbm5lY3RlZCxcbiAgICAgICdGYWlsZWQgdG8gYWNjZXNzIHRoZSBGaWxlIFN5c3RlbSBBUEk6IGNvbnN1bWVyIGlzIG5vdCBjb25uZWN0ZWQuIERpZCB5b3UgZm9yZ2V0IHRvIHJ1biBcImNvbm5lY3QoKVwiPydcbiAgICApO1xuICAgIGlmICh0aGlzLmZpbGVTeXN0ZW1BcGkpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbGVTeXN0ZW1BcGk7XG4gICAgfVxuICAgIHRoaXMuZmlsZVN5c3RlbUFwaSA9IG5ldyBGaWxlU3lzdGVtQXBpKHRoaXMuY2hhbm5lbCk7XG4gICAgcmV0dXJuIHRoaXMuZmlsZVN5c3RlbUFwaTtcbiAgfVxuICBnZXQgc2hlbGwoKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5pc0Nvbm5lY3RlZCxcbiAgICAgICdGYWlsZWQgdG8gYWNjZXNzIHRoZSBTaGVsbCBBUEk6IGNvbnN1bWVyIGlzIG5vdCBjb25uZWN0ZWQuIERpZCB5b3UgZm9yZ2V0IHRvIHJ1biBcImNvbm5lY3QoKVwiPydcbiAgICApO1xuICAgIGlmICh0aGlzLnNoZWxsQXBpKSB7XG4gICAgICByZXR1cm4gdGhpcy5zaGVsbEFwaTtcbiAgICB9XG4gICAgdGhpcy5zaGVsbEFwaSA9IG5ldyBTaGVsbEFwaSh0aGlzLmNoYW5uZWwpO1xuICAgIHJldHVybiB0aGlzLnNoZWxsQXBpO1xuICB9XG4gIGdldCBwcmV2aWV3KCkge1xuICAgIGludmFyaWFudChcbiAgICAgIHRoaXMuaXNDb25uZWN0ZWQsXG4gICAgICAnRmFpbGVkIHRvIGFjY2VzcyB0aGUgUHJldmlldyBBUEk6IGNvbnN1bWVyIGlzIG5vdCBjb25uZWN0ZWQuIERpZCB5b3UgZm9yZ2V0IHRvIHJ1biBcImNvbm5lY3QoKVwiPydcbiAgICApO1xuICAgIGlmICh0aGlzLnByZXZpZXdBcGkpIHtcbiAgICAgIHJldHVybiB0aGlzLnByZXZpZXdBcGk7XG4gICAgfVxuICAgIHRoaXMucHJldmlld0FwaSA9IG5ldyBQcmV2aWV3QXBpKHRoaXMuY2hhbm5lbCk7XG4gICAgcmV0dXJuIHRoaXMucHJldmlld0FwaTtcbiAgfVxufTtcblxuLy8gc3JjL3J1bnRpbWUtcHJvdG9jb2wudHlwZXMudHNcbnZhciBJTkpFQ1RfTUVTU0FHRV9UWVBFID0gXCJJTkpFQ1RfQU5EX0lOVk9LRVwiO1xudmFyIFBSRVZJRVdfTE9BREVEX01FU1NBR0VfVFlQRSA9IFwiUFJFVklFV19MT0FERURcIjtcbmV4cG9ydCB7XG4gIElOSkVDVF9NRVNTQUdFX1RZUEUsXG4gIE1lc3NhZ2VSZWNlaXZlcixcbiAgTWVzc2FnZVNlbmRlcixcbiAgTm9kZWJveCxcbiAgUFJFVklFV19MT0FERURfTUVTU0FHRV9UWVBFXG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@codesandbox/nodebox/build/index.mjs\n"));

/***/ }),

/***/ "./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs":
/*!**************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs ***!
  \**************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   S: function() { return /* binding */ SandpackClient; }\n/* harmony export */ });\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dequal */ \"./node_modules/dequal/dist/index.mjs\");\n\n\nvar SandpackClient = /** @class */ (function () {\n    function SandpackClient(iframeSelector, sandboxSetup, options) {\n        if (options === void 0) { options = {}; }\n        this.status = \"idle\";\n        this.options = options;\n        this.sandboxSetup = sandboxSetup;\n        this.iframeSelector = iframeSelector;\n    }\n    /**\n     * Clients handles\n     */\n    SandpackClient.prototype.updateOptions = function (options) {\n        if (!(0,dequal__WEBPACK_IMPORTED_MODULE_0__.dequal)(this.options, options)) {\n            this.options = options;\n            this.updateSandbox();\n        }\n    };\n    SandpackClient.prototype.updateSandbox = function (_sandboxSetup, _isInitializationCompile) {\n        if (_sandboxSetup === void 0) { _sandboxSetup = this.sandboxSetup; }\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.destroy = function () {\n        throw Error(\"Method not implemented\");\n    };\n    /**\n     * Bundler communication\n     */\n    SandpackClient.prototype.dispatch = function (_message) {\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.listen = function (_listener) {\n        throw Error(\"Method not implemented\");\n    };\n    return SandpackClient;\n}());\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2Jhc2UtODBhMWY3NjAubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWdDOztBQUVoQztBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsOENBQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUU4QiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2Jhc2UtODBhMWY3NjAubWpzPzhlZmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVxdWFsIH0gZnJvbSAnZGVxdWFsJztcblxudmFyIFNhbmRwYWNrQ2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNhbmRwYWNrQ2xpZW50KGlmcmFtZVNlbGVjdG9yLCBzYW5kYm94U2V0dXAsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgdGhpcy5zdGF0dXMgPSBcImlkbGVcIjtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5zYW5kYm94U2V0dXAgPSBzYW5kYm94U2V0dXA7XG4gICAgICAgIHRoaXMuaWZyYW1lU2VsZWN0b3IgPSBpZnJhbWVTZWxlY3RvcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xpZW50cyBoYW5kbGVzXG4gICAgICovXG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLnVwZGF0ZU9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICBpZiAoIWRlcXVhbCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTYW5kYm94KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNhbmRwYWNrQ2xpZW50LnByb3RvdHlwZS51cGRhdGVTYW5kYm94ID0gZnVuY3Rpb24gKF9zYW5kYm94U2V0dXAsIF9pc0luaXRpYWxpemF0aW9uQ29tcGlsZSkge1xuICAgICAgICBpZiAoX3NhbmRib3hTZXR1cCA9PT0gdm9pZCAwKSB7IF9zYW5kYm94U2V0dXAgPSB0aGlzLnNhbmRib3hTZXR1cDsgfVxuICAgICAgICB0aHJvdyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWRcIik7XG4gICAgfTtcbiAgICBTYW5kcGFja0NsaWVudC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkXCIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQnVuZGxlciBjb21tdW5pY2F0aW9uXG4gICAgICovXG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKF9tZXNzYWdlKSB7XG4gICAgICAgIHRocm93IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9O1xuICAgIFNhbmRwYWNrQ2xpZW50LnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAoX2xpc3RlbmVyKSB7XG4gICAgICAgIHRocm93IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9O1xuICAgIHJldHVybiBTYW5kcGFja0NsaWVudDtcbn0oKSk7XG5cbmV4cG9ydCB7IFNhbmRwYWNrQ2xpZW50IGFzIFMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\n"));

/***/ }),

/***/ "./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs":
/*!*******************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SandpackNode: function() { return /* binding */ SandpackNode; }\n/* harmony export */ });\n/* harmony import */ var _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../types-0877c553.mjs */ \"./node_modules/@codesandbox/sandpack-client/dist/types-0877c553.mjs\");\n/* harmony import */ var _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @codesandbox/nodebox */ \"./node_modules/@codesandbox/nodebox/build/index.mjs\");\n/* harmony import */ var _base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../base-80a1f760.mjs */ \"./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\");\n/* harmony import */ var _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../consoleHook-cdbe54ab.mjs */ \"./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs\");\n/* harmony import */ var outvariant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! outvariant */ \"./node_modules/@codesandbox/sandpack-client/node_modules/outvariant/lib/index.mjs\");\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dequal */ \"./node_modules/dequal/dist/index.mjs\");\n\n\n\n\n\n\n\nfunction loadPreviewIframe(iframe, url) {\n    return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n        var contentWindow, TIME_OUT, MAX_MANY_TIRES, tries, timeout;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n            contentWindow = iframe.contentWindow;\n            (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(contentWindow, \"Failed to await preview iframe: no content window found\");\n            TIME_OUT = 90000;\n            MAX_MANY_TIRES = 20;\n            tries = 0;\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n                    var triesToSetUrl = function () {\n                        var onLoadPage = function () {\n                            clearTimeout(timeout);\n                            tries = MAX_MANY_TIRES;\n                            resolve();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        };\n                        if (tries >= MAX_MANY_TIRES) {\n                            reject((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(\"Could not able to connect to preview.\"));\n                            return;\n                        }\n                        iframe.setAttribute(\"src\", url);\n                        timeout = setTimeout(function () {\n                            triesToSetUrl();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        }, TIME_OUT);\n                        tries = tries + 1;\n                        iframe.addEventListener(\"load\", onLoadPage);\n                    };\n                    iframe.addEventListener(\"error\", function () { return reject(new Error(\"Iframe error\")); });\n                    iframe.addEventListener(\"abort\", function () { return reject(new Error(\"Aborted\")); });\n                    triesToSetUrl();\n                })];\n        });\n    });\n}\nvar setPreviewIframeProperties = function (iframe, options) {\n    iframe.style.border = \"0\";\n    iframe.style.width = options.width || \"100%\";\n    iframe.style.height = options.height || \"100%\";\n    iframe.style.overflow = \"hidden\";\n    iframe.allow = \"cross-origin-isolated\";\n};\n\n/* eslint-disable @typescript-eslint/ban-ts-comment, @typescript-eslint/explicit-function-return-type, no-restricted-globals, @typescript-eslint/no-explicit-any  */\nfunction setupHistoryListeners(_a) {\n    var scope = _a.scope;\n    // @ts-ignore\n    var origHistoryProto = window.history.__proto__;\n    var historyList = [];\n    var historyPosition = 0;\n    var dispatchMessage = function (url) {\n        parent.postMessage({\n            type: \"urlchange\",\n            url: url,\n            back: historyPosition > 0,\n            forward: historyPosition < historyList.length - 1,\n            channelId: scope.channelId,\n        }, \"*\");\n    };\n    function pushHistory(url, state) {\n        // remove \"future\" locations\n        historyList.splice(historyPosition + 1);\n        historyList.push({ url: url, state: state });\n        historyPosition = historyList.length - 1;\n    }\n    Object.assign(window.history, {\n        go: function (delta) {\n            var newPos = historyPosition + delta;\n            if (newPos >= 0 && newPos <= historyList.length - 1) {\n                historyPosition = newPos;\n                var _a = historyList[historyPosition], url = _a.url, state = _a.state;\n                origHistoryProto.replaceState.call(window.history, state, \"\", url);\n                var newURL = document.location.href;\n                dispatchMessage(newURL);\n                window.dispatchEvent(new PopStateEvent(\"popstate\", { state: state }));\n            }\n        },\n        back: function () {\n            window.history.go(-1);\n        },\n        forward: function () {\n            window.history.go(1);\n        },\n        pushState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            pushHistory(url, state);\n            dispatchMessage(document.location.href);\n        },\n        replaceState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            historyList[historyPosition] = { state: state, url: url };\n            dispatchMessage(document.location.href);\n        },\n    });\n    function handleMessage(_a) {\n        var data = _a.data;\n        if (data.type === \"urlback\") {\n            history.back();\n        }\n        else if (data.type === \"urlforward\") {\n            history.forward();\n        }\n        else if (data.type === \"refresh\") {\n            document.location.reload();\n        }\n    }\n    window.addEventListener(\"message\", handleMessage);\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction watchResize(_a) {\n    var scope = _a.scope;\n    var lastHeight = 0;\n    function getDocumentHeight() {\n        if (typeof window === \"undefined\")\n            return 0;\n        var body = document.body;\n        var html = document.documentElement;\n        return Math.max(body.scrollHeight, body.offsetHeight, html.offsetHeight);\n    }\n    function sendResizeEvent() {\n        var height = getDocumentHeight();\n        if (lastHeight !== height) {\n            window.parent.postMessage({\n                type: \"resize\",\n                height: height,\n                codesandbox: true,\n                channelId: scope.channelId,\n            }, \"*\");\n        }\n        lastHeight = height;\n    }\n    sendResizeEvent();\n    var throttle;\n    var observer = new MutationObserver(function () {\n        if (throttle === undefined) {\n            sendResizeEvent();\n            throttle = setTimeout(function () {\n                throttle = undefined;\n            }, 300);\n        }\n    });\n    observer.observe(document, {\n        attributes: true,\n        childList: true,\n        subtree: true,\n    });\n    /**\n     * Ideally we should only use a `MutationObserver` to trigger a resize event,\n     * however, we noted that it's not 100% reliable, so we went for polling strategy as well\n     */\n    setInterval(sendResizeEvent, 300);\n}\n\n/* eslint-disable @typescript-eslint/ban-ts-comment */\nvar scripts = [\n    { code: setupHistoryListeners.toString(), id: \"historyListener\" },\n    {\n        code: \"function consoleHook({ scope }) {\" + _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.c + \"\\n};\",\n        id: \"consoleHook\",\n    },\n    { code: watchResize.toString(), id: \"watchResize\" },\n];\nvar injectScriptToIframe = function (iframe, channelId) {\n    scripts.forEach(function (_a) {\n        var _b;\n        var code = _a.code, id = _a.id;\n        var message = {\n            uid: id,\n            type: _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.INJECT_MESSAGE_TYPE,\n            code: \"exports.activate = \".concat(code),\n            scope: { channelId: channelId },\n        };\n        (_b = iframe.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n    });\n};\n\n/* eslint-disable no-console,@typescript-eslint/no-explicit-any,prefer-rest-params,@typescript-eslint/explicit-module-boundary-types */\nvar SandpackNode = /** @class */ (function (_super) {\n    (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(SandpackNode, _super);\n    function SandpackNode(selector, sandboxInfo, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, selector, sandboxInfo, (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)({}, options), { bundlerURL: options.bundlerURL })) || this;\n        _this._modulesCache = new Map();\n        _this.messageChannelId = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.g)();\n        _this._initPromise = null;\n        _this.emitter = new _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.E();\n        // Assign iframes\n        _this.manageIframes(selector);\n        // Init emulator\n        _this.emulator = new _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.Nodebox({\n            iframe: _this.emulatorIframe,\n            runtimeUrl: _this.options.bundlerURL,\n        });\n        // Trigger initial compile\n        _this.updateSandbox(sandboxInfo);\n        return _this;\n    }\n    // Initialize nodebox, should only ever be called once\n    SandpackNode.prototype._init = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.emulator.connect()];\n                    case 1:\n                        _a.sent();\n                        // 2. Setup\n                        return [4 /*yield*/, this.emulator.fs.init(files)];\n                    case 2:\n                        // 2. Setup\n                        _a.sent();\n                        // 2.1 Other dependencies\n                        return [4 /*yield*/, this.globalListeners()];\n                    case 3:\n                        // 2.1 Other dependencies\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It initializes the emulator and provide it with files, template and script to run\n     */\n    SandpackNode.prototype.compile = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var shellId, err_1;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        // 1. Init\n                        this.status = \"initializing\";\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        if (!this._initPromise) {\n                            this._initPromise = this._init(files);\n                        }\n                        return [4 /*yield*/, this._initPromise];\n                    case 1:\n                        _a.sent();\n                        this.dispatch({ type: \"connected\" });\n                        return [4 /*yield*/, this.createShellProcessFromTask(files)];\n                    case 2:\n                        shellId = (_a.sent()).id;\n                        // 4. Launch Preview\n                        return [4 /*yield*/, this.createPreviewURLFromId(shellId)];\n                    case 3:\n                        // 4. Launch Preview\n                        _a.sent();\n                        return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 4:\n                        _a.sent();\n                        // 5. Returns to consumer\n                        this.dispatchDoneMessage();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _a.sent();\n                        this.dispatch({\n                            type: \"action\",\n                            action: \"notification\",\n                            notificationType: \"error\",\n                            title: (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(err_1),\n                        });\n                        this.dispatch({ type: \"done\", compilatonError: true });\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It creates a new shell and run the starting task\n     */\n    SandpackNode.prototype.createShellProcessFromTask = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var packageJsonContent;\n            var _a;\n            var _this = this;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        packageJsonContent = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(files[\"/package.json\"]);\n                        this.emulatorCommand = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.b)(packageJsonContent);\n                        this.emulatorShellProcess = this.emulator.shell.create();\n                        // Shell listeners\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"exit\", function (exitCode) {\n                                _this.dispatch({\n                                    type: \"action\",\n                                    action: \"notification\",\n                                    notificationType: \"error\",\n                                    title: (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(\"Error: process.exit(\".concat(exitCode, \") called.\")),\n                                });\n                            })];\n                    case 1:\n                        // Shell listeners\n                        _b.sent();\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"progress\", function (data) {\n                                var _a, _b;\n                                if (data.state === \"command_running\" ||\n                                    data.state === \"starting_command\") {\n                                    _this.dispatch({\n                                        type: \"shell/progress\",\n                                        data: (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)({}, data), { command: [\n                                                (_a = _this.emulatorCommand) === null || _a === void 0 ? void 0 : _a[0],\n                                                (_b = _this.emulatorCommand) === null || _b === void 0 ? void 0 : _b[1].join(\" \"),\n                                            ].join(\" \") }),\n                                    });\n                                    _this.status = \"installing-dependencies\";\n                                    return;\n                                }\n                                _this.dispatch({ type: \"shell/progress\", data: data });\n                            })];\n                    case 2:\n                        _b.sent();\n                        this.emulatorShellProcess.stdout.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"out\" } });\n                        });\n                        this.emulatorShellProcess.stderr.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"err\" } });\n                        });\n                        return [4 /*yield*/, (_a = this.emulatorShellProcess).runCommand.apply(_a, this.emulatorCommand)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.createPreviewURLFromId = function (id) {\n        var _a;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var url;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.iframePreviewUrl = undefined;\n                        return [4 /*yield*/, this.emulator.preview.getByShellId(id)];\n                    case 1:\n                        url = (_b.sent()).url;\n                        this.iframePreviewUrl = url + ((_a = this.options.startRoute) !== null && _a !== void 0 ? _a : \"\");\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Nodebox needs to handle two types of iframes at the same time:\n     *\n     * 1. Runtime iframe: where the emulator process runs, which is responsible\n     *    for creating the other iframes (hidden);\n     * 2. Preview iframes: any other node process that contains a PORT (public);\n     */\n    SandpackNode.prototype.manageIframes = function (selector) {\n        var _a;\n        /**\n         * Pick the preview iframe\n         */\n        if (typeof selector === \"string\") {\n            var element = document.querySelector(selector);\n            (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(element, \"The element '\".concat(selector, \"' was not found\"));\n            this.iframe = document.createElement(\"iframe\");\n        }\n        else {\n            this.iframe = selector;\n        }\n        // Set preview iframe styles\n        setPreviewIframeProperties(this.iframe, this.options);\n        (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(this.iframe.parentNode, \"The given iframe does not have a parent.\");\n        /**\n         * Create the runtime iframe, which is hidden sibling\n         * from the preview one\n         */\n        this.emulatorIframe = document.createElement(\"iframe\");\n        this.emulatorIframe.classList.add(\"sp-bridge-frame\");\n        (_a = this.iframe.parentNode) === null || _a === void 0 ? void 0 : _a.appendChild(this.emulatorIframe);\n    };\n    SandpackNode.prototype.setLocationURLIntoIFrame = function () {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.iframePreviewUrl) return [3 /*break*/, 2];\n                        return [4 /*yield*/, loadPreviewIframe(this.iframe, this.iframePreviewUrl)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Send all messages and events to tell to the\n     * consumer that the bundler is ready without any error\n     */\n    SandpackNode.prototype.dispatchDoneMessage = function () {\n        this.status = \"done\";\n        this.dispatch({ type: \"done\", compilatonError: false });\n        if (this.iframePreviewUrl) {\n            this.dispatch({\n                type: \"urlchange\",\n                url: this.iframePreviewUrl,\n                back: false,\n                forward: false,\n            });\n        }\n    };\n    SandpackNode.prototype.globalListeners = function () {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var _this = this;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        window.addEventListener(\"message\", function (event) {\n                            if (event.data.type === _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.PREVIEW_LOADED_MESSAGE_TYPE) {\n                                injectScriptToIframe(_this.iframe, _this.messageChannelId);\n                            }\n                            if (event.data.type === \"urlchange\" &&\n                                event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch({\n                                    type: \"urlchange\",\n                                    url: event.data.url,\n                                    back: event.data.back,\n                                    forward: event.data.forward,\n                                });\n                            }\n                            else if (event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch(event.data);\n                            }\n                        });\n                        return [4 /*yield*/, this.emulator.fs.watch([\"*\"], [\n                                \".next\",\n                                \"node_modules\",\n                                \"build\",\n                                \"dist\",\n                                \"vendor\",\n                                \".config\",\n                                \".vuepress\",\n                            ], function (message) { return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(_this, void 0, void 0, function () {\n                                var event, path, type, _a, content, newContent, err_2;\n                                return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                                    switch (_b.label) {\n                                        case 0:\n                                            if (!message)\n                                                return [2 /*return*/];\n                                            event = message;\n                                            path = \"newPath\" in event\n                                                ? event.newPath\n                                                : \"path\" in event\n                                                    ? event.path\n                                                    : \"\";\n                                            return [4 /*yield*/, this.emulator.fs.stat(path)];\n                                        case 1:\n                                            type = (_b.sent()).type;\n                                            if (type !== \"file\")\n                                                return [2 /*return*/, null];\n                                            _b.label = 2;\n                                        case 2:\n                                            _b.trys.push([2, 10, , 11]);\n                                            _a = event.type;\n                                            switch (_a) {\n                                                case \"change\": return [3 /*break*/, 3];\n                                                case \"create\": return [3 /*break*/, 3];\n                                                case \"remove\": return [3 /*break*/, 5];\n                                                case \"rename\": return [3 /*break*/, 6];\n                                                case \"close\": return [3 /*break*/, 8];\n                                            }\n                                            return [3 /*break*/, 9];\n                                        case 3: return [4 /*yield*/, this.emulator.fs.readFile(event.path, \"utf8\")];\n                                        case 4:\n                                            content = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.path,\n                                                content: content,\n                                            });\n                                            this._modulesCache.set(event.path, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(content));\n                                            return [3 /*break*/, 9];\n                                        case 5:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.path,\n                                            });\n                                            this._modulesCache.delete(event.path);\n                                            return [3 /*break*/, 9];\n                                        case 6:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.oldPath,\n                                            });\n                                            this._modulesCache.delete(event.oldPath);\n                                            return [4 /*yield*/, this.emulator.fs.readFile(event.newPath, \"utf8\")];\n                                        case 7:\n                                            newContent = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.newPath,\n                                                content: newContent,\n                                            });\n                                            this._modulesCache.set(event.newPath, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(newContent));\n                                            return [3 /*break*/, 9];\n                                        case 8: return [3 /*break*/, 9];\n                                        case 9: return [3 /*break*/, 11];\n                                        case 10:\n                                            err_2 = _b.sent();\n                                            this.dispatch({\n                                                type: \"action\",\n                                                action: \"notification\",\n                                                notificationType: \"error\",\n                                                title: (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(err_2),\n                                            });\n                                            return [3 /*break*/, 11];\n                                        case 11: return [2 /*return*/];\n                                    }\n                                });\n                            }); })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * PUBLIC Methods\n     */\n    SandpackNode.prototype.restartShellProcess = function () {\n        var _a;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!(this.emulatorShellProcess && this.emulatorCommand)) return [3 /*break*/, 3];\n                        // 1. Set the loading state and clean the URL\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        this.status = \"initializing\";\n                        // 2. Exit shell\n                        return [4 /*yield*/, this.emulatorShellProcess.kill()];\n                    case 1:\n                        // 2. Exit shell\n                        _b.sent();\n                        (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.removeAttribute(\"attr\");\n                        this.emulator.fs.rm(\"/node_modules/.vite\", {\n                            recursive: true,\n                            force: true,\n                        });\n                        // 3 Run command again\n                        return [4 /*yield*/, this.compile(Object.fromEntries(this._modulesCache))];\n                    case 2:\n                        // 3 Run command again\n                        _b.sent();\n                        _b.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.updateSandbox = function (setup) {\n        var _this = this;\n        var _a;\n        var modules = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.f)(setup.files);\n        /**\n         * Update file changes\n         */\n        if (((_a = this.emulatorShellProcess) === null || _a === void 0 ? void 0 : _a.state) === \"running\") {\n            Object.entries(modules).forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                if (!_this._modulesCache.get(key) ||\n                    (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(value) !== (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(_this._modulesCache.get(key))) {\n                    _this.emulator.fs.writeFile(key, value, { recursive: true });\n                }\n            });\n            return;\n        }\n        /**\n         * Pass init files to the bundler\n         */\n        this.dispatch({\n            codesandbox: true,\n            modules: modules,\n            template: setup.template,\n            type: \"compile\",\n        });\n        /**\n         * Add modules to cache, this will ensure uniqueness changes\n         *\n         * Keep it after the compile action, in order to update the cache at the right moment\n         */\n        Object.entries(modules).forEach(function (_a) {\n            var key = _a[0], value = _a[1];\n            _this._modulesCache.set(key, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(value));\n        });\n    };\n    SandpackNode.prototype.dispatch = function (message) {\n        var _a, _b;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var _c;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _c = message.type;\n                        switch (_c) {\n                            case \"compile\": return [3 /*break*/, 1];\n                            case \"refresh\": return [3 /*break*/, 2];\n                            case \"urlback\": return [3 /*break*/, 4];\n                            case \"urlforward\": return [3 /*break*/, 4];\n                            case \"shell/restart\": return [3 /*break*/, 5];\n                            case \"shell/openPreview\": return [3 /*break*/, 6];\n                        }\n                        return [3 /*break*/, 7];\n                    case 1:\n                        this.compile(message.modules);\n                        return [3 /*break*/, 8];\n                    case 2: return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 3:\n                        _d.sent();\n                        return [3 /*break*/, 8];\n                    case 4:\n                        (_b = (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n                        return [3 /*break*/, 8];\n                    case 5:\n                        this.restartShellProcess();\n                        return [3 /*break*/, 8];\n                    case 6:\n                        window.open(this.iframePreviewUrl, \"_blank\");\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.emitter.dispatch(message);\n                        _d.label = 8;\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.listen = function (listener) {\n        return this.emitter.listener(listener);\n    };\n    SandpackNode.prototype.destroy = function () {\n        this.emulatorIframe.remove();\n        this.emitter.cleanup();\n    };\n    return SandpackNode;\n}(_base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_5__.S));\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2NsaWVudHMvbm9kZS9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUE4STtBQUM3QztBQUNuQztBQUN1SztBQUNqTjtBQUNKOztBQUVoQjtBQUNBLFdBQVcsc0RBQVM7QUFDcEI7QUFDQSxlQUFlLHNEQUFXO0FBQzFCO0FBQ0EsWUFBWSxzREFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsc0RBQVc7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSwyQ0FBMkM7QUFDOUcsbUVBQW1FLHNDQUFzQztBQUN6RztBQUNBLGlCQUFpQjtBQUNqQixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix3QkFBd0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFFQUFxRSxjQUFjO0FBQ25GO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxpREFBYzs7QUFFUSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2NsaWVudHMvbm9kZS9pbmRleC5tanM/MjEyNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfIGFzIF9fYXdhaXRlciwgYSBhcyBfX2dlbmVyYXRvciwgbiBhcyBudWxsdGhyb3dzLCBjIGFzIGNyZWF0ZUVycm9yLCBnIGFzIF9fZXh0ZW5kcywgaCBhcyBfX2Fzc2lnbiB9IGZyb20gJy4uLy4uL3R5cGVzLTA4NzdjNTUzLm1qcyc7XG5pbXBvcnQgeyBJTkpFQ1RfTUVTU0FHRV9UWVBFLCBOb2RlYm94LCBQUkVWSUVXX0xPQURFRF9NRVNTQUdFX1RZUEUgfSBmcm9tICdAY29kZXNhbmRib3gvbm9kZWJveCc7XG5pbXBvcnQgeyBTIGFzIFNhbmRwYWNrQ2xpZW50IH0gZnJvbSAnLi4vLi4vYmFzZS04MGExZjc2MC5tanMnO1xuaW1wb3J0IHsgYyBhcyBjb25zb2xlSG9vaywgZiBhcyBmcm9tQnVuZGxlckZpbGVzVG9GUywgciBhcyByZWFkQnVmZmVyLCB3IGFzIHdyaXRlQnVmZmVyLCBnIGFzIGdlbmVyYXRlUmFuZG9tSWQsIEUgYXMgRXZlbnRFbWl0dGVyLCBhIGFzIGdldE1lc3NhZ2VGcm9tRXJyb3IsIGIgYXMgZmluZFN0YXJ0U2NyaXB0UGFja2FnZUpzb24gfSBmcm9tICcuLi8uLi9jb25zb2xlSG9vay1jZGJlNTRhYi5tanMnO1xuaW1wb3J0ICdvdXR2YXJpYW50JztcbmltcG9ydCAnZGVxdWFsJztcblxuZnVuY3Rpb24gbG9hZFByZXZpZXdJZnJhbWUoaWZyYW1lLCB1cmwpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZW50V2luZG93LCBUSU1FX09VVCwgTUFYX01BTllfVElSRVMsIHRyaWVzLCB0aW1lb3V0O1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBjb250ZW50V2luZG93ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3c7XG4gICAgICAgICAgICBudWxsdGhyb3dzKGNvbnRlbnRXaW5kb3csIFwiRmFpbGVkIHRvIGF3YWl0IHByZXZpZXcgaWZyYW1lOiBubyBjb250ZW50IHdpbmRvdyBmb3VuZFwiKTtcbiAgICAgICAgICAgIFRJTUVfT1VUID0gOTAwMDA7XG4gICAgICAgICAgICBNQVhfTUFOWV9USVJFUyA9IDIwO1xuICAgICAgICAgICAgdHJpZXMgPSAwO1xuICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyaWVzVG9TZXRVcmwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25Mb2FkUGFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZXMgPSBNQVhfTUFOWV9USVJFUztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uTG9hZFBhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmllcyA+PSBNQVhfTUFOWV9USVJFUykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChjcmVhdGVFcnJvcihcIkNvdWxkIG5vdCBhYmxlIHRvIGNvbm5lY3QgdG8gcHJldmlldy5cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmllc1RvU2V0VXJsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uTG9hZFBhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgVElNRV9PVVQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJpZXMgPSB0cmllcyArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgb25Mb2FkUGFnZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihcIklmcmFtZSBlcnJvclwiKSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoXCJBYm9ydGVkXCIpKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRyaWVzVG9TZXRVcmwoKTtcbiAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxudmFyIHNldFByZXZpZXdJZnJhbWVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKGlmcmFtZSwgb3B0aW9ucykge1xuICAgIGlmcmFtZS5zdHlsZS5ib3JkZXIgPSBcIjBcIjtcbiAgICBpZnJhbWUuc3R5bGUud2lkdGggPSBvcHRpb25zLndpZHRoIHx8IFwiMTAwJVwiO1xuICAgIGlmcmFtZS5zdHlsZS5oZWlnaHQgPSBvcHRpb25zLmhlaWdodCB8fCBcIjEwMCVcIjtcbiAgICBpZnJhbWUuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgIGlmcmFtZS5hbGxvdyA9IFwiY3Jvc3Mtb3JpZ2luLWlzb2xhdGVkXCI7XG59O1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQsIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZSwgbm8tcmVzdHJpY3RlZC1nbG9iYWxzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICAqL1xuZnVuY3Rpb24gc2V0dXBIaXN0b3J5TGlzdGVuZXJzKF9hKSB7XG4gICAgdmFyIHNjb3BlID0gX2Euc2NvcGU7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHZhciBvcmlnSGlzdG9yeVByb3RvID0gd2luZG93Lmhpc3RvcnkuX19wcm90b19fO1xuICAgIHZhciBoaXN0b3J5TGlzdCA9IFtdO1xuICAgIHZhciBoaXN0b3J5UG9zaXRpb24gPSAwO1xuICAgIHZhciBkaXNwYXRjaE1lc3NhZ2UgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICB0eXBlOiBcInVybGNoYW5nZVwiLFxuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBiYWNrOiBoaXN0b3J5UG9zaXRpb24gPiAwLFxuICAgICAgICAgICAgZm9yd2FyZDogaGlzdG9yeVBvc2l0aW9uIDwgaGlzdG9yeUxpc3QubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgIGNoYW5uZWxJZDogc2NvcGUuY2hhbm5lbElkLFxuICAgICAgICB9LCBcIipcIik7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBwdXNoSGlzdG9yeSh1cmwsIHN0YXRlKSB7XG4gICAgICAgIC8vIHJlbW92ZSBcImZ1dHVyZVwiIGxvY2F0aW9uc1xuICAgICAgICBoaXN0b3J5TGlzdC5zcGxpY2UoaGlzdG9yeVBvc2l0aW9uICsgMSk7XG4gICAgICAgIGhpc3RvcnlMaXN0LnB1c2goeyB1cmw6IHVybCwgc3RhdGU6IHN0YXRlIH0pO1xuICAgICAgICBoaXN0b3J5UG9zaXRpb24gPSBoaXN0b3J5TGlzdC5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBPYmplY3QuYXNzaWduKHdpbmRvdy5oaXN0b3J5LCB7XG4gICAgICAgIGdvOiBmdW5jdGlvbiAoZGVsdGEpIHtcbiAgICAgICAgICAgIHZhciBuZXdQb3MgPSBoaXN0b3J5UG9zaXRpb24gKyBkZWx0YTtcbiAgICAgICAgICAgIGlmIChuZXdQb3MgPj0gMCAmJiBuZXdQb3MgPD0gaGlzdG9yeUxpc3QubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIGhpc3RvcnlQb3NpdGlvbiA9IG5ld1BvcztcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBoaXN0b3J5TGlzdFtoaXN0b3J5UG9zaXRpb25dLCB1cmwgPSBfYS51cmwsIHN0YXRlID0gX2Euc3RhdGU7XG4gICAgICAgICAgICAgICAgb3JpZ0hpc3RvcnlQcm90by5yZXBsYWNlU3RhdGUuY2FsbCh3aW5kb3cuaGlzdG9yeSwgc3RhdGUsIFwiXCIsIHVybCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1VSTCA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hNZXNzYWdlKG5ld1VSTCk7XG4gICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IFBvcFN0YXRlRXZlbnQoXCJwb3BzdGF0ZVwiLCB7IHN0YXRlOiBzdGF0ZSB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmdvKC0xKTtcbiAgICAgICAgfSxcbiAgICAgICAgZm9yd2FyZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuZ28oMSk7XG4gICAgICAgIH0sXG4gICAgICAgIHB1c2hTdGF0ZTogZnVuY3Rpb24gKHN0YXRlLCB0aXRsZSwgdXJsKSB7XG4gICAgICAgICAgICBvcmlnSGlzdG9yeVByb3RvLnJlcGxhY2VTdGF0ZS5jYWxsKHdpbmRvdy5oaXN0b3J5LCBzdGF0ZSwgdGl0bGUsIHVybCk7XG4gICAgICAgICAgICBwdXNoSGlzdG9yeSh1cmwsIHN0YXRlKTtcbiAgICAgICAgICAgIGRpc3BhdGNoTWVzc2FnZShkb2N1bWVudC5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZVN0YXRlOiBmdW5jdGlvbiAoc3RhdGUsIHRpdGxlLCB1cmwpIHtcbiAgICAgICAgICAgIG9yaWdIaXN0b3J5UHJvdG8ucmVwbGFjZVN0YXRlLmNhbGwod2luZG93Lmhpc3RvcnksIHN0YXRlLCB0aXRsZSwgdXJsKTtcbiAgICAgICAgICAgIGhpc3RvcnlMaXN0W2hpc3RvcnlQb3NpdGlvbl0gPSB7IHN0YXRlOiBzdGF0ZSwgdXJsOiB1cmwgfTtcbiAgICAgICAgICAgIGRpc3BhdGNoTWVzc2FnZShkb2N1bWVudC5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgfSxcbiAgICB9KTtcbiAgICBmdW5jdGlvbiBoYW5kbGVNZXNzYWdlKF9hKSB7XG4gICAgICAgIHZhciBkYXRhID0gX2EuZGF0YTtcbiAgICAgICAgaWYgKGRhdGEudHlwZSA9PT0gXCJ1cmxiYWNrXCIpIHtcbiAgICAgICAgICAgIGhpc3RvcnkuYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gXCJ1cmxmb3J3YXJkXCIpIHtcbiAgICAgICAgICAgIGhpc3RvcnkuZm9yd2FyZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gXCJyZWZyZXNoXCIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBoYW5kbGVNZXNzYWdlKTtcbn1cblxuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuZnVuY3Rpb24gd2F0Y2hSZXNpemUoX2EpIHtcbiAgICB2YXIgc2NvcGUgPSBfYS5zY29wZTtcbiAgICB2YXIgbGFzdEhlaWdodCA9IDA7XG4gICAgZnVuY3Rpb24gZ2V0RG9jdW1lbnRIZWlnaHQoKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgdmFyIGh0bWwgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHJldHVybiBNYXRoLm1heChib2R5LnNjcm9sbEhlaWdodCwgYm9keS5vZmZzZXRIZWlnaHQsIGh0bWwub2Zmc2V0SGVpZ2h0KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2VuZFJlc2l6ZUV2ZW50KCkge1xuICAgICAgICB2YXIgaGVpZ2h0ID0gZ2V0RG9jdW1lbnRIZWlnaHQoKTtcbiAgICAgICAgaWYgKGxhc3RIZWlnaHQgIT09IGhlaWdodCkge1xuICAgICAgICAgICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJyZXNpemVcIixcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICAgICAgICBjb2Rlc2FuZGJveDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjaGFubmVsSWQ6IHNjb3BlLmNoYW5uZWxJZCxcbiAgICAgICAgICAgIH0sIFwiKlwiKTtcbiAgICAgICAgfVxuICAgICAgICBsYXN0SGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBzZW5kUmVzaXplRXZlbnQoKTtcbiAgICB2YXIgdGhyb3R0bGU7XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhyb3R0bGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VuZFJlc2l6ZUV2ZW50KCk7XG4gICAgICAgICAgICB0aHJvdHRsZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRocm90dGxlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIElkZWFsbHkgd2Ugc2hvdWxkIG9ubHkgdXNlIGEgYE11dGF0aW9uT2JzZXJ2ZXJgIHRvIHRyaWdnZXIgYSByZXNpemUgZXZlbnQsXG4gICAgICogaG93ZXZlciwgd2Ugbm90ZWQgdGhhdCBpdCdzIG5vdCAxMDAlIHJlbGlhYmxlLCBzbyB3ZSB3ZW50IGZvciBwb2xsaW5nIHN0cmF0ZWd5IGFzIHdlbGxcbiAgICAgKi9cbiAgICBzZXRJbnRlcnZhbChzZW5kUmVzaXplRXZlbnQsIDMwMCk7XG59XG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCAqL1xudmFyIHNjcmlwdHMgPSBbXG4gICAgeyBjb2RlOiBzZXR1cEhpc3RvcnlMaXN0ZW5lcnMudG9TdHJpbmcoKSwgaWQ6IFwiaGlzdG9yeUxpc3RlbmVyXCIgfSxcbiAgICB7XG4gICAgICAgIGNvZGU6IFwiZnVuY3Rpb24gY29uc29sZUhvb2soeyBzY29wZSB9KSB7XCIgKyBjb25zb2xlSG9vayArIFwiXFxufTtcIixcbiAgICAgICAgaWQ6IFwiY29uc29sZUhvb2tcIixcbiAgICB9LFxuICAgIHsgY29kZTogd2F0Y2hSZXNpemUudG9TdHJpbmcoKSwgaWQ6IFwid2F0Y2hSZXNpemVcIiB9LFxuXTtcbnZhciBpbmplY3RTY3JpcHRUb0lmcmFtZSA9IGZ1bmN0aW9uIChpZnJhbWUsIGNoYW5uZWxJZCkge1xuICAgIHNjcmlwdHMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIF9iO1xuICAgICAgICB2YXIgY29kZSA9IF9hLmNvZGUsIGlkID0gX2EuaWQ7XG4gICAgICAgIHZhciBtZXNzYWdlID0ge1xuICAgICAgICAgICAgdWlkOiBpZCxcbiAgICAgICAgICAgIHR5cGU6IElOSkVDVF9NRVNTQUdFX1RZUEUsXG4gICAgICAgICAgICBjb2RlOiBcImV4cG9ydHMuYWN0aXZhdGUgPSBcIi5jb25jYXQoY29kZSksXG4gICAgICAgICAgICBzY29wZTogeyBjaGFubmVsSWQ6IGNoYW5uZWxJZCB9LFxuICAgICAgICB9O1xuICAgICAgICAoX2IgPSBpZnJhbWUuY29udGVudFdpbmRvdykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIFwiKlwiKTtcbiAgICB9KTtcbn07XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUsQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSxwcmVmZXItcmVzdC1wYXJhbXMsQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlcyAqL1xudmFyIFNhbmRwYWNrTm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2FuZHBhY2tOb2RlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNhbmRwYWNrTm9kZShzZWxlY3Rvciwgc2FuZGJveEluZm8sIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc2VsZWN0b3IsIHNhbmRib3hJbmZvLCBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgb3B0aW9ucyksIHsgYnVuZGxlclVSTDogb3B0aW9ucy5idW5kbGVyVVJMIH0pKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fbW9kdWxlc0NhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICBfdGhpcy5tZXNzYWdlQ2hhbm5lbElkID0gZ2VuZXJhdGVSYW5kb21JZCgpO1xuICAgICAgICBfdGhpcy5faW5pdFByb21pc2UgPSBudWxsO1xuICAgICAgICBfdGhpcy5lbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvLyBBc3NpZ24gaWZyYW1lc1xuICAgICAgICBfdGhpcy5tYW5hZ2VJZnJhbWVzKHNlbGVjdG9yKTtcbiAgICAgICAgLy8gSW5pdCBlbXVsYXRvclxuICAgICAgICBfdGhpcy5lbXVsYXRvciA9IG5ldyBOb2RlYm94KHtcbiAgICAgICAgICAgIGlmcmFtZTogX3RoaXMuZW11bGF0b3JJZnJhbWUsXG4gICAgICAgICAgICBydW50aW1lVXJsOiBfdGhpcy5vcHRpb25zLmJ1bmRsZXJVUkwsXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBUcmlnZ2VyIGluaXRpYWwgY29tcGlsZVxuICAgICAgICBfdGhpcy51cGRhdGVTYW5kYm94KHNhbmRib3hJbmZvKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvLyBJbml0aWFsaXplIG5vZGVib3gsIHNob3VsZCBvbmx5IGV2ZXIgYmUgY2FsbGVkIG9uY2VcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gKGZpbGVzKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5jb25uZWN0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBTZXR1cFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5mcy5pbml0KGZpbGVzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIFNldHVwXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLjEgT3RoZXIgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmdsb2JhbExpc3RlbmVycygpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4xIE90aGVyIGRlcGVuZGVuY2llc1xuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEl0IGluaXRpYWxpemVzIHRoZSBlbXVsYXRvciBhbmQgcHJvdmlkZSBpdCB3aXRoIGZpbGVzLCB0ZW1wbGF0ZSBhbmQgc2NyaXB0IHRvIHJ1blxuICAgICAqL1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuY29tcGlsZSA9IGZ1bmN0aW9uIChmaWxlcykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2hlbGxJZCwgZXJyXzE7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDUsICwgNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gSW5pdFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImluaXRpYWxpemluZ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwic3RhcnRcIiwgZmlyc3RMb2FkOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pbml0UHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2luaXRQcm9taXNlID0gdGhpcy5faW5pdChmaWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9pbml0UHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goeyB0eXBlOiBcImNvbm5lY3RlZFwiIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jcmVhdGVTaGVsbFByb2Nlc3NGcm9tVGFzayhmaWxlcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVsbElkID0gKF9hLnNlbnQoKSkuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiBMYXVuY2ggUHJldmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jcmVhdGVQcmV2aWV3VVJMRnJvbUlkKHNoZWxsSWQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gNC4gTGF1bmNoIFByZXZpZXdcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc2V0TG9jYXRpb25VUkxJbnRvSUZyYW1lKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA1LiBSZXR1cm5zIHRvIGNvbnN1bWVyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRG9uZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcIm5vdGlmaWNhdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZ2V0TWVzc2FnZUZyb21FcnJvcihlcnJfMSksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goeyB0eXBlOiBcImRvbmVcIiwgY29tcGlsYXRvbkVycm9yOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEl0IGNyZWF0ZXMgYSBuZXcgc2hlbGwgYW5kIHJ1biB0aGUgc3RhcnRpbmcgdGFza1xuICAgICAqL1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuY3JlYXRlU2hlbGxQcm9jZXNzRnJvbVRhc2sgPSBmdW5jdGlvbiAoZmlsZXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBhY2thZ2VKc29uQ29udGVudDtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWNrYWdlSnNvbkNvbnRlbnQgPSByZWFkQnVmZmVyKGZpbGVzW1wiL3BhY2thZ2UuanNvblwiXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtdWxhdG9yQ29tbWFuZCA9IGZpbmRTdGFydFNjcmlwdFBhY2thZ2VKc29uKHBhY2thZ2VKc29uQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzID0gdGhpcy5lbXVsYXRvci5zaGVsbC5jcmVhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNoZWxsIGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvclNoZWxsUHJvY2Vzcy5vbihcImV4aXRcIiwgZnVuY3Rpb24gKGV4aXRDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwibm90aWZpY2F0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25UeXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogY3JlYXRlRXJyb3IoXCJFcnJvcjogcHJvY2Vzcy5leGl0KFwiLmNvbmNhdChleGl0Q29kZSwgXCIpIGNhbGxlZC5cIikpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNoZWxsIGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvclNoZWxsUHJvY2Vzcy5vbihcInByb2dyZXNzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXRlID09PSBcImNvbW1hbmRfcnVubmluZ1wiIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXRlID09PSBcInN0YXJ0aW5nX2NvbW1hbmRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2hlbGwvcHJvZ3Jlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGF0YSksIHsgY29tbWFuZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gX3RoaXMuZW11bGF0b3JDb21tYW5kKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2IgPSBfdGhpcy5lbXVsYXRvckNvbW1hbmQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYlsxXS5qb2luKFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiIFwiKSB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhdHVzID0gXCJpbnN0YWxsaW5nLWRlcGVuZGVuY2llc1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKHsgdHlwZTogXCJzaGVsbC9wcm9ncmVzc1wiLCBkYXRhOiBkYXRhIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXVsYXRvclNoZWxsUHJvY2Vzcy5zdGRvdXQub24oXCJkYXRhXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goeyB0eXBlOiBcInN0ZG91dFwiLCBwYXlsb2FkOiB7IGRhdGE6IGRhdGEsIHR5cGU6IFwib3V0XCIgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXVsYXRvclNoZWxsUHJvY2Vzcy5zdGRlcnIub24oXCJkYXRhXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goeyB0eXBlOiBcInN0ZG91dFwiLCBwYXlsb2FkOiB7IGRhdGE6IGRhdGEsIHR5cGU6IFwiZXJyXCIgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKF9hID0gdGhpcy5lbXVsYXRvclNoZWxsUHJvY2VzcykucnVuQ29tbWFuZC5hcHBseShfYSwgdGhpcy5lbXVsYXRvckNvbW1hbmQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Iuc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLmNyZWF0ZVByZXZpZXdVUkxGcm9tSWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXJsO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pZnJhbWVQcmV2aWV3VXJsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5wcmV2aWV3LmdldEJ5U2hlbGxJZChpZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAoX2Iuc2VudCgpKS51cmw7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlmcmFtZVByZXZpZXdVcmwgPSB1cmwgKyAoKF9hID0gdGhpcy5vcHRpb25zLnN0YXJ0Um91dGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE5vZGVib3ggbmVlZHMgdG8gaGFuZGxlIHR3byB0eXBlcyBvZiBpZnJhbWVzIGF0IHRoZSBzYW1lIHRpbWU6XG4gICAgICpcbiAgICAgKiAxLiBSdW50aW1lIGlmcmFtZTogd2hlcmUgdGhlIGVtdWxhdG9yIHByb2Nlc3MgcnVucywgd2hpY2ggaXMgcmVzcG9uc2libGVcbiAgICAgKiAgICBmb3IgY3JlYXRpbmcgdGhlIG90aGVyIGlmcmFtZXMgKGhpZGRlbik7XG4gICAgICogMi4gUHJldmlldyBpZnJhbWVzOiBhbnkgb3RoZXIgbm9kZSBwcm9jZXNzIHRoYXQgY29udGFpbnMgYSBQT1JUIChwdWJsaWMpO1xuICAgICAqL1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUubWFuYWdlSWZyYW1lcyA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQaWNrIHRoZSBwcmV2aWV3IGlmcmFtZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIG51bGx0aHJvd3MoZWxlbWVudCwgXCJUaGUgZWxlbWVudCAnXCIuY29uY2F0KHNlbGVjdG9yLCBcIicgd2FzIG5vdCBmb3VuZFwiKSk7XG4gICAgICAgICAgICB0aGlzLmlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmlmcmFtZSA9IHNlbGVjdG9yO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNldCBwcmV2aWV3IGlmcmFtZSBzdHlsZXNcbiAgICAgICAgc2V0UHJldmlld0lmcmFtZVByb3BlcnRpZXModGhpcy5pZnJhbWUsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIG51bGx0aHJvd3ModGhpcy5pZnJhbWUucGFyZW50Tm9kZSwgXCJUaGUgZ2l2ZW4gaWZyYW1lIGRvZXMgbm90IGhhdmUgYSBwYXJlbnQuXCIpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ3JlYXRlIHRoZSBydW50aW1lIGlmcmFtZSwgd2hpY2ggaXMgaGlkZGVuIHNpYmxpbmdcbiAgICAgICAgICogZnJvbSB0aGUgcHJldmlldyBvbmVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZW11bGF0b3JJZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgICAgICB0aGlzLmVtdWxhdG9ySWZyYW1lLmNsYXNzTGlzdC5hZGQoXCJzcC1icmlkZ2UtZnJhbWVcIik7XG4gICAgICAgIChfYSA9IHRoaXMuaWZyYW1lLnBhcmVudE5vZGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hcHBlbmRDaGlsZCh0aGlzLmVtdWxhdG9ySWZyYW1lKTtcbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuc2V0TG9jYXRpb25VUkxJbnRvSUZyYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaWZyYW1lUHJldmlld1VybCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBsb2FkUHJldmlld0lmcmFtZSh0aGlzLmlmcmFtZSwgdGhpcy5pZnJhbWVQcmV2aWV3VXJsKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VuZCBhbGwgbWVzc2FnZXMgYW5kIGV2ZW50cyB0byB0ZWxsIHRvIHRoZVxuICAgICAqIGNvbnN1bWVyIHRoYXQgdGhlIGJ1bmRsZXIgaXMgcmVhZHkgd2l0aG91dCBhbnkgZXJyb3JcbiAgICAgKi9cbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLmRpc3BhdGNoRG9uZU1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc3RhdHVzID0gXCJkb25lXCI7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2goeyB0eXBlOiBcImRvbmVcIiwgY29tcGlsYXRvbkVycm9yOiBmYWxzZSB9KTtcbiAgICAgICAgaWYgKHRoaXMuaWZyYW1lUHJldmlld1VybCkge1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJ1cmxjaGFuZ2VcIixcbiAgICAgICAgICAgICAgICB1cmw6IHRoaXMuaWZyYW1lUHJldmlld1VybCxcbiAgICAgICAgICAgICAgICBiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBmb3J3YXJkOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLmdsb2JhbExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSBQUkVWSUVXX0xPQURFRF9NRVNTQUdFX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5qZWN0U2NyaXB0VG9JZnJhbWUoX3RoaXMuaWZyYW1lLCBfdGhpcy5tZXNzYWdlQ2hhbm5lbElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gXCJ1cmxjaGFuZ2VcIiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5kYXRhLmNoYW5uZWxJZCA9PT0gX3RoaXMubWVzc2FnZUNoYW5uZWxJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInVybGNoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBldmVudC5kYXRhLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2s6IGV2ZW50LmRhdGEuYmFjayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcndhcmQ6IGV2ZW50LmRhdGEuZm9yd2FyZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmRhdGEuY2hhbm5lbElkID09PSBfdGhpcy5tZXNzYWdlQ2hhbm5lbElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKGV2ZW50LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5mcy53YXRjaChbXCIqXCJdLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLm5leHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlX21vZHVsZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJidWlsZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRpc3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZW5kb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIuY29uZmlnXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLnZ1ZXByZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwgZnVuY3Rpb24gKG1lc3NhZ2UpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50LCBwYXRoLCB0eXBlLCBfYSwgY29udGVudCwgbmV3Q29udGVudCwgZXJyXzI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gXCJuZXdQYXRoXCIgaW4gZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZXZlbnQubmV3UGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcInBhdGhcIiBpbiBldmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZXZlbnQucGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5mcy5zdGF0KHBhdGgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAoX2Iuc2VudCgpKS50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSAhPT0gXCJmaWxlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbnVsbF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMiwgMTAsICwgMTFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBldmVudC50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY2hhbmdlXCI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiOiByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJyZW1vdmVcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicmVuYW1lXCI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNsb3NlXCI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5mcy5yZWFkRmlsZShldmVudC5wYXRoLCBcInV0ZjhcIildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImZzL2NoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogZXZlbnQucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVzQ2FjaGUuc2V0KGV2ZW50LnBhdGgsIHdyaXRlQnVmZmVyKGNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZnMvcmVtb3ZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBldmVudC5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kdWxlc0NhY2hlLmRlbGV0ZShldmVudC5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZnMvcmVtb3ZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBldmVudC5vbGRQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kdWxlc0NhY2hlLmRlbGV0ZShldmVudC5vbGRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvci5mcy5yZWFkRmlsZShldmVudC5uZXdQYXRoLCBcInV0ZjhcIildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudCA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImZzL2NoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogZXZlbnQubmV3UGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IG5ld0NvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVzQ2FjaGUuc2V0KGV2ZW50Lm5ld1BhdGgsIHdyaXRlQnVmZmVyKG5ld0NvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMyAvKmJyZWFrKi8sIDExXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJfMiA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcIm5vdGlmaWNhdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uVHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGdldE1lc3NhZ2VGcm9tRXJyb3IoZXJyXzIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFBVQkxJQyBNZXRob2RzXG4gICAgICovXG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5yZXN0YXJ0U2hlbGxQcm9jZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuZW11bGF0b3JTaGVsbFByb2Nlc3MgJiYgdGhpcy5lbXVsYXRvckNvbW1hbmQpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDEuIFNldCB0aGUgbG9hZGluZyBzdGF0ZSBhbmQgY2xlYW4gdGhlIFVSTFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwic3RhcnRcIiwgZmlyc3RMb2FkOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImluaXRpYWxpemluZ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4gRXhpdCBzaGVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbXVsYXRvclNoZWxsUHJvY2Vzcy5raWxsKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBFeGl0IHNoZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAoX2EgPSB0aGlzLmlmcmFtZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW92ZUF0dHJpYnV0ZShcImF0dHJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtdWxhdG9yLmZzLnJtKFwiL25vZGVfbW9kdWxlcy8udml0ZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzIFJ1biBjb21tYW5kIGFnYWluXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNvbXBpbGUoT2JqZWN0LmZyb21FbnRyaWVzKHRoaXMuX21vZHVsZXNDYWNoZSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMyBSdW4gY29tbWFuZCBhZ2FpblxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLnVwZGF0ZVNhbmRib3ggPSBmdW5jdGlvbiAoc2V0dXApIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgbW9kdWxlcyA9IGZyb21CdW5kbGVyRmlsZXNUb0ZTKHNldHVwLmZpbGVzKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZSBmaWxlIGNoYW5nZXNcbiAgICAgICAgICovXG4gICAgICAgIGlmICgoKF9hID0gdGhpcy5lbXVsYXRvclNoZWxsUHJvY2VzcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0YXRlKSA9PT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG1vZHVsZXMpLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuX21vZHVsZXNDYWNoZS5nZXQoa2V5KSB8fFxuICAgICAgICAgICAgICAgICAgICByZWFkQnVmZmVyKHZhbHVlKSAhPT0gcmVhZEJ1ZmZlcihfdGhpcy5fbW9kdWxlc0NhY2hlLmdldChrZXkpKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbXVsYXRvci5mcy53cml0ZUZpbGUoa2V5LCB2YWx1ZSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBhc3MgaW5pdCBmaWxlcyB0byB0aGUgYnVuZGxlclxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBjb2Rlc2FuZGJveDogdHJ1ZSxcbiAgICAgICAgICAgIG1vZHVsZXM6IG1vZHVsZXMsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogc2V0dXAudGVtcGxhdGUsXG4gICAgICAgICAgICB0eXBlOiBcImNvbXBpbGVcIixcbiAgICAgICAgfSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgbW9kdWxlcyB0byBjYWNoZSwgdGhpcyB3aWxsIGVuc3VyZSB1bmlxdWVuZXNzIGNoYW5nZXNcbiAgICAgICAgICpcbiAgICAgICAgICogS2VlcCBpdCBhZnRlciB0aGUgY29tcGlsZSBhY3Rpb24sIGluIG9yZGVyIHRvIHVwZGF0ZSB0aGUgY2FjaGUgYXQgdGhlIHJpZ2h0IG1vbWVudFxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmVudHJpZXMobW9kdWxlcykuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICAgICAgICAgIF90aGlzLl9tb2R1bGVzQ2FjaGUuc2V0KGtleSwgd3JpdGVCdWZmZXIodmFsdWUpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9jO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZCkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2QubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MgPSBtZXNzYWdlLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNvbXBpbGVcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJlZnJlc2hcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVybGJhY2tcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVybGZvcndhcmRcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNoZWxsL3Jlc3RhcnRcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNoZWxsL29wZW5QcmV2aWV3XCI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGlsZShtZXNzYWdlLm1vZHVsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zZXRMb2NhdGlvblVSTEludG9JRnJhbWUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAoX2IgPSAoX2EgPSB0aGlzLmlmcmFtZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNvbnRlbnRXaW5kb3cpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5wb3N0TWVzc2FnZShtZXNzYWdlLCBcIipcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN0YXJ0U2hlbGxQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4odGhpcy5pZnJhbWVQcmV2aWV3VXJsLCBcIl9ibGFua1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXR0ZXIuZGlzcGF0Y2gobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZC5sYWJlbCA9IDg7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVtaXR0ZXIubGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIH07XG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVtdWxhdG9ySWZyYW1lLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmVtaXR0ZXIuY2xlYW51cCgpO1xuICAgIH07XG4gICAgcmV0dXJuIFNhbmRwYWNrTm9kZTtcbn0oU2FuZHBhY2tDbGllbnQpKTtcblxuZXhwb3J0IHsgU2FuZHBhY2tOb2RlIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs\n"));

/***/ }),

/***/ "./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs":
/*!*********************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: function() { return /* binding */ EventEmitter; },\n/* harmony export */   a: function() { return /* binding */ getMessageFromError; },\n/* harmony export */   b: function() { return /* binding */ findStartScriptPackageJson; },\n/* harmony export */   c: function() { return /* binding */ consoleHook; },\n/* harmony export */   f: function() { return /* binding */ fromBundlerFilesToFS; },\n/* harmony export */   g: function() { return /* binding */ generateRandomId; },\n/* harmony export */   r: function() { return /* binding */ readBuffer; },\n/* harmony export */   w: function() { return /* binding */ writeBuffer; }\n/* harmony export */ });\n/* harmony import */ var outvariant__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! outvariant */ \"./node_modules/@codesandbox/sandpack-client/node_modules/outvariant/lib/index.mjs\");\n/* harmony import */ var _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./types-0877c553.mjs */ \"./node_modules/@codesandbox/sandpack-client/dist/types-0877c553.mjs\");\n\n\n\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.listeners = {};\n        this.listenersCount = 0;\n        this.channelId = Math.floor(Math.random() * 1000000);\n        this.listeners = [];\n    }\n    EventEmitter.prototype.cleanup = function () {\n        this.listeners = {};\n        this.listenersCount = 0;\n    };\n    EventEmitter.prototype.dispatch = function (message) {\n        Object.values(this.listeners).forEach(function (listener) { return listener(message); });\n    };\n    EventEmitter.prototype.listener = function (listener) {\n        var _this = this;\n        if (typeof listener !== \"function\") {\n            return function () {\n                return;\n            };\n        }\n        var listenerId = this.listenersCount;\n        this.listeners[listenerId] = listener;\n        this.listenersCount++;\n        return function () {\n            delete _this.listeners[listenerId];\n        };\n    };\n    return EventEmitter;\n}());\n\nfunction isCommand(char) {\n    return /[a-zA-Z.]/.test(char);\n}\nfunction isAlpha(char) {\n    return /[a-zA-Z]/.test(char);\n}\nfunction isWhitespace(char) {\n    return /\\s/.test(char);\n}\nfunction isOperator(char) {\n    return /[&|]/.test(char);\n}\nfunction isArgument(char) {\n    return /-/.test(char);\n}\nfunction isString(char) {\n    return /[\"']/.test(char);\n}\nfunction isEnvVar(char) {\n    return isAlpha(char) && char === char.toUpperCase();\n}\nvar TokenType;\n(function (TokenType) {\n    TokenType[\"OR\"] = \"OR\";\n    TokenType[\"AND\"] = \"AND\";\n    TokenType[\"PIPE\"] = \"PIPE\";\n    TokenType[\"Command\"] = \"Command\";\n    TokenType[\"Argument\"] = \"Argument\";\n    TokenType[\"String\"] = \"String\";\n    TokenType[\"EnvVar\"] = \"EnvVar\";\n})(TokenType || (TokenType = {}));\nvar operators = new Map([\n    [\"&&\", { type: TokenType.AND }],\n    [\"||\", { type: TokenType.OR }],\n    [\"|\", { type: TokenType.PIPE }],\n    [\"-\", { type: TokenType.Argument }],\n]);\nfunction tokenize(input) {\n    var current = 0;\n    var tokens = [];\n    function parseCommand() {\n        var value = \"\";\n        while (isCommand(input[current]) && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return { type: TokenType.Command, value: value };\n    }\n    function parseOperator() {\n        var value = \"\";\n        while (isOperator(input[current]) && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return operators.get(value);\n    }\n    function parseArgument() {\n        var value = \"\";\n        while ((isArgument(input[current]) || isAlpha(input[current])) &&\n            current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return { type: TokenType.Argument, value: value };\n    }\n    function parseString() {\n        var openCloseQuote = input[current];\n        var value = input[current];\n        current++;\n        while (input[current] !== openCloseQuote && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        value += input[current];\n        current++;\n        return { type: TokenType.String, value: value };\n    }\n    function parseEnvVars() {\n        var value = {};\n        var parseSingleEnv = function () {\n            var key = \"\";\n            var pair = \"\";\n            while (input[current] !== \"=\" && current < input.length) {\n                key += input[current];\n                current++;\n            }\n            // Skip equal\n            if (input[current] === \"=\") {\n                current++;\n            }\n            while (input[current] !== \" \" && current < input.length) {\n                pair += input[current];\n                current++;\n            }\n            value[key] = pair;\n        };\n        while (isEnvVar(input[current]) && current < input.length) {\n            parseSingleEnv();\n            current++;\n        }\n        return { type: TokenType.EnvVar, value: value };\n    }\n    while (current < input.length) {\n        var currentChar = input[current];\n        if (isWhitespace(currentChar)) {\n            current++;\n            continue;\n        }\n        switch (true) {\n            case isEnvVar(currentChar):\n                tokens.push(parseEnvVars());\n                break;\n            case isCommand(currentChar):\n                tokens.push(parseCommand());\n                break;\n            case isOperator(currentChar):\n                tokens.push(parseOperator());\n                break;\n            case isArgument(currentChar):\n                tokens.push(parseArgument());\n                break;\n            case isString(currentChar):\n                tokens.push(parseString());\n                break;\n            default:\n                throw new Error(\"Unknown character: \".concat(currentChar));\n        }\n    }\n    return tokens;\n}\n\nvar counter = 0;\nfunction generateRandomId() {\n    var now = Date.now();\n    var randomNumber = Math.round(Math.random() * 10000);\n    var count = (counter += 1);\n    return (+\"\".concat(now).concat(randomNumber).concat(count)).toString(16);\n}\nvar writeBuffer = function (content) {\n    if (typeof content === \"string\") {\n        return new TextEncoder().encode(content);\n    }\n    else {\n        return content;\n    }\n};\nvar readBuffer = function (content) {\n    if (typeof content === \"string\") {\n        return content;\n    }\n    else {\n        return new TextDecoder().decode(content);\n    }\n};\nvar fromBundlerFilesToFS = function (files) {\n    return Object.entries(files).reduce(function (acc, _a) {\n        var key = _a[0], value = _a[1];\n        acc[key] = writeBuffer(value.code);\n        return acc;\n    }, {});\n};\n/**\n * Figure out which script it must run to start a server\n */\nvar findStartScriptPackageJson = function (packageJson) {\n    var scripts = {};\n    // TODO: support postinstall\n    var possibleKeys = [\"dev\", \"start\"];\n    try {\n        scripts = JSON.parse(packageJson).scripts;\n    }\n    catch (e) {\n        throw (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"Could not parse package.json file: \" + e.message);\n    }\n    (0,outvariant__WEBPACK_IMPORTED_MODULE_0__.invariant)(scripts, \"Failed to start. Please provide a `start` or `dev` script on the package.json\");\n    var _loop_1 = function (index) {\n        if (possibleKeys[index] in scripts) {\n            var script = possibleKeys[index];\n            var candidate = scripts[script];\n            var env_1 = {};\n            var command_1 = \"\";\n            var args_1 = [];\n            tokenize(candidate).forEach(function (item) {\n                var commandNotFoundYet = command_1 === \"\";\n                if (item.type === TokenType.EnvVar) {\n                    env_1 = item.value;\n                }\n                if (item.type === TokenType.Command && commandNotFoundYet) {\n                    command_1 = item.value;\n                }\n                if (item.type === TokenType.Argument ||\n                    (!commandNotFoundYet && item.type === TokenType.Command)) {\n                    args_1.push(item.value);\n                }\n                // TODO: support TokenType.AND, TokenType.OR, TokenType.PIPE\n            });\n            return { value: [command_1, args_1, { env: env_1 }] };\n        }\n    };\n    for (var index = 0; index < possibleKeys.length; index++) {\n        var state_1 = _loop_1(index);\n        if (typeof state_1 === \"object\")\n            return state_1.value;\n    }\n    throw (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"Failed to start. Please provide a `start` or `dev` script on the package.json\");\n};\nvar getMessageFromError = function (error) {\n    if (typeof error === \"string\")\n        return error;\n    if (typeof error === \"object\" && \"message\" in error) {\n        return error.message;\n    }\n    return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"The server could not be reached. Make sure that the node script is running and that a port has been started.\");\n};\n\nvar consoleHook = \"var t=\\\"undefined\\\"!=typeof globalThis?globalThis:\\\"undefined\\\"!=typeof window?window:\\\"undefined\\\"!=typeof globalThis?globalThis:\\\"undefined\\\"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,\\\"default\\\")?t.default:t}var e={},n={};!function(t){t.__esModule=!0,t.default=[\\\"log\\\",\\\"debug\\\",\\\"info\\\",\\\"warn\\\",\\\"error\\\",\\\"table\\\",\\\"clear\\\",\\\"time\\\",\\\"timeEnd\\\",\\\"count\\\",\\\"assert\\\",\\\"command\\\",\\\"result\\\"]}(n);var a,o={},i={};(a=i).__esModule=!0,a.default=function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+Date.now()};var u={},s={__esModule:!0};s.update=s.state=void 0,s.update=function(t){s.state=t};var f={},c={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.initialState=void 0,r.initialState={timings:{},count:{}};var n=function(){return\\\"undefined\\\"!=typeof performance&&performance.now?performance.now():Date.now()};r.default=function(t,a){var o,i,u;switch(void 0===t&&(t=r.initialState),a.type){case\\\"COUNT\\\":var s=t.count[a.name]||0;return e(e({},t),{count:e(e({},t.count),(o={},o[a.name]=s+1,o))});case\\\"TIME_START\\\":return e(e({},t),{timings:e(e({},t.timings),(i={},i[a.name]={start:n()},i))});case\\\"TIME_END\\\":var f=t.timings[a.name],c=n(),l=c-f.start;return e(e({},t),{timings:e(e({},t.timings),(u={},u[a.name]=e(e({},f),{end:c,time:l}),u))});default:return t}}}(c),function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var n=e(c),a=s;r.default=function(t){a.update(n.default(a.state,t))}}(f);var l={__esModule:!0};l.timeEnd=l.timeStart=l.count=void 0,l.count=function(t){return{type:\\\"COUNT\\\",name:t}},l.timeStart=function(t){return{type:\\\"TIME_START\\\",name:t}},l.timeEnd=function(t){return{type:\\\"TIME_END\\\",name:t}};var d=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};u.__esModule=!0,u.stop=u.start=void 0;var p=s,h=d(f),m=l;u.start=function(t){h.default(m.timeStart(t))},u.stop=function(t){var r=null===p.state||void 0===p.state?void 0:p.state.timings[t];return r&&!r.end?(h.default(m.timeEnd(t)),{method:\\\"log\\\",data:[t+\\\": \\\"+p.state.timings[t].time+\\\"ms\\\"]}):{method:\\\"warn\\\",data:[\\\"Timer '\\\"+t+\\\"' does not exist\\\"]}};var y={},v=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};y.__esModule=!0,y.increment=void 0;var _=s,b=v(f),g=l;y.increment=function(t){return b.default(g.count(t)),{method:\\\"log\\\",data:[t+\\\": \\\"+_.state.count[t]]}};var M={},T=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n};M.__esModule=!0,M.test=void 0,M.test=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return!t&&(0===r.length&&r.push(\\\"console.assert\\\"),{method:\\\"error\\\",data:T([\\\"Assertion failed:\\\"],r)})},function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)},n=t&&t.__createBinding||(Object.create?function(t,r,e,n){void 0===n&&(n=e),Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,n){void 0===n&&(n=e),t[n]=r[e]}),a=t&&t.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,\\\"default\\\",{enumerable:!0,value:r})}:function(t,r){t.default=r}),o=t&&t.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)\\\"default\\\"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&n(r,t,e);return a(r,t),r},s=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n},f=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var c=f(i),l=o(u),d=o(y),p=o(M);r.default=function(t,r,n){var a=n||c.default();switch(t){case\\\"clear\\\":return{method:t,id:a};case\\\"count\\\":return!!(o=\\\"string\\\"==typeof r[0]?r[0]:\\\"default\\\")&&e(e({},d.increment(o)),{id:a});case\\\"time\\\":case\\\"timeEnd\\\":var o;return!!(o=\\\"string\\\"==typeof r[0]?r[0]:\\\"default\\\")&&(\\\"time\\\"===t?(l.start(o),!1):e(e({},l.stop(o)),{id:a}));case\\\"assert\\\":if(0!==r.length){var i=p.test.apply(p,s([r[0]],r.slice(1)));if(i)return e(e({},i),{id:a})}return!1;case\\\"error\\\":return{method:t,id:a,data:r.map((function(t){try{return t.stack||t}catch(r){return t}}))};default:return{method:t,id:a,data:r}}}}(o);var S={},O={};!function(t){var r;t.__esModule=!0,function(t){t[t.infinity=0]=\\\"infinity\\\",t[t.minusInfinity=1]=\\\"minusInfinity\\\",t[t.minusZero=2]=\\\"minusZero\\\"}(r||(r={})),t.default={type:\\\"Arithmetic\\\",lookup:Number,shouldTransform:function(t,r){return\\\"number\\\"===t&&(r===1/0||r===-1/0||function(t){return 1/t==-1/0}(r))},toSerializable:function(t){return t===1/0?r.infinity:t===-1/0?r.minusInfinity:r.minusZero},fromSerializable:function(t){return t===r.infinity?1/0:t===r.minusInfinity?-1/0:t===r.minusZero?-0:t}}}(O);var w={};!function(t){t.__esModule=!0,t.default={type:\\\"Function\\\",lookup:Function,shouldTransform:function(t,r){return\\\"function\\\"==typeof r},toSerializable:function(t){var r=\\\"\\\";try{r=t.toString().substring(r.indexOf(\\\"{\\\")+1,r.lastIndexOf(\\\"}\\\"))}catch(t){}return{name:t.name,body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){try{var r=function(){};return\\\"string\\\"==typeof t.name&&Object.defineProperty(r,\\\"name\\\",{value:t.name,writable:!1}),\\\"string\\\"==typeof t.body&&Object.defineProperty(r,\\\"body\\\",{value:t.body,writable:!1}),\\\"string\\\"==typeof t.proto&&(r.constructor={name:t.proto}),r}catch(r){return t}}}}(w);var A={};!function(t){var r;function e(t){for(var r={},e=0,n=t.attributes;e<n.length;e++){var a=n[e];r[a.name]=a.value}return r}t.__esModule=!0,t.default={type:\\\"HTMLElement\\\",shouldTransform:function(t,r){return r&&r.children&&\\\"string\\\"==typeof r.innerHTML&&\\\"string\\\"==typeof r.tagName},toSerializable:function(t){return{tagName:t.tagName.toLowerCase(),attributes:e(t),innerHTML:t.innerHTML}},fromSerializable:function(t){try{var e=(r||(r=document.implementation.createHTMLDocument(\\\"sandbox\\\"))).createElement(t.tagName);e.innerHTML=t.innerHTML;for(var n=0,a=Object.keys(t.attributes);n<a.length;n++){var o=a[n];try{e.setAttribute(o,t.attributes[o])}catch(t){}}return e}catch(r){return t}}}}(A);var j={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.default={type:\\\"Map\\\",shouldTransform:function(t,r){return r&&r.constructor&&\\\"Map\\\"===r.constructor.name},toSerializable:function(t){var r={};return t.forEach((function(t,e){var n=\\\"object\\\"==typeof e?JSON.stringify(e):e;r[n]=t})),{name:\\\"Map\\\",body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){var r=t.body,n=e({},r);return\\\"string\\\"==typeof t.proto&&(n.constructor={name:t.proto}),n}}}(j);var z={};!function(t){t.__esModule=!0;var r=\\\"@t\\\",e=/^#*@(t|r)$/,n=(0,eval)(\\\"this\\\"),a=\\\"function\\\"==typeof ArrayBuffer,o=\\\"function\\\"==typeof Map,i=\\\"function\\\"==typeof Set,u=[\\\"Int8Array\\\",\\\"Uint8Array\\\",\\\"Uint8ClampedArray\\\",\\\"Int16Array\\\",\\\"Uint16Array\\\",\\\"Int32Array\\\",\\\"Uint32Array\\\",\\\"Float32Array\\\",\\\"Float64Array\\\"],s=Array.prototype.slice,f={serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return JSON.parse(t)}},c=function(){function t(t,r){this.references=t,this.transforms=r,this.transformsMap=this._makeTransformsMap(),this.circularCandidates=[],this.circularCandidatesDescrs=[],this.circularRefCount=0}return t._createRefMark=function(t){var r=Object.create(null);return r[\\\"@r\\\"]=t,r},t.prototype._createCircularCandidate=function(t,r,e){this.circularCandidates.push(t),this.circularCandidatesDescrs.push({parent:r,key:e,refIdx:-1})},t.prototype._applyTransform=function(t,e,n,a){var o=Object.create(null),i=a.toSerializable(t);return\\\"object\\\"==typeof i&&this._createCircularCandidate(t,e,n),o[r]=a.type,o.data=this._handleValue((function(){return i}),e,n),o},t.prototype._handleArray=function(t){for(var r=[],e=function(e){r[e]=n._handleValue((function(){return t[e]}),r,e)},n=this,a=0;a<t.length;a++)e(a);return r},t.prototype._handlePlainObject=function(t){var r,n,a=Object.create(null),o=function(r){if(Reflect.has(t,r)){var n=e.test(r)?\\\"#\\\"+r:r;a[n]=i._handleValue((function(){return t[r]}),a,n)}},i=this;for(var u in t)o(u);var s=null===(n=null===(r=null==t?void 0:t.__proto__)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name;return s&&\\\"Object\\\"!==s&&(a.constructor={name:s}),a},t.prototype._handleObject=function(t,r,e){return this._createCircularCandidate(t,r,e),Array.isArray(t)?this._handleArray(t):this._handlePlainObject(t)},t.prototype._ensureCircularReference=function(r){var e=this.circularCandidates.indexOf(r);if(e>-1){var n=this.circularCandidatesDescrs[e];return-1===n.refIdx&&(n.refIdx=n.parent?++this.circularRefCount:0),t._createRefMark(n.refIdx)}return null},t.prototype._handleValue=function(t,r,e){try{var n=t(),a=typeof n,o=\\\"object\\\"===a&&null!==n;if(o){var i=this._ensureCircularReference(n);if(i)return i}var u=this._findTransform(a,n);return u?this._applyTransform(n,r,e,u):o?this._handleObject(n,r,e):n}catch(t){try{return this._handleValue((function(){return t instanceof Error?t:new Error(t)}),r,e)}catch(t){return null}}},t.prototype._makeTransformsMap=function(){if(o){var t=new Map;return this.transforms.forEach((function(r){r.lookup&&t.set(r.lookup,r)})),t}},t.prototype._findTransform=function(t,r){if(o&&r&&r.constructor&&(null==(a=this.transformsMap.get(r.constructor))?void 0:a.shouldTransform(t,r)))return a;for(var e=0,n=this.transforms;e<n.length;e++){var a;if((a=n[e]).shouldTransform(t,r))return a}},t.prototype.transform=function(){for(var r=this,e=[this._handleValue((function(){return r.references}),null,null)],n=0,a=this.circularCandidatesDescrs;n<a.length;n++){var o=a[n];o.refIdx>0&&(e[o.refIdx]=o.parent[o.key],o.parent[o.key]=t._createRefMark(o.refIdx))}return e},t}(),l=function(){function t(t,r){this.activeTransformsStack=[],this.visitedRefs=Object.create(null),this.references=t,this.transformMap=r}return t.prototype._handlePlainObject=function(t){var r=Object.create(null);for(var n in\\\"constructor\\\"in t&&(t.constructor&&\\\"string\\\"==typeof t.constructor.name||(t.constructor={name:\\\"Object\\\"})),t)t.hasOwnProperty(n)&&(this._handleValue(t[n],t,n),e.test(n)&&(r[n.substring(1)]=t[n],delete t[n]));for(var a in r)t[a]=r[a]},t.prototype._handleTransformedObject=function(t,e,n){var a=t[r],o=this.transformMap[a];if(!o)throw new Error(\\\"Can't find transform for \\\\\\\"\\\"+a+'\\\" type.');this.activeTransformsStack.push(t),this._handleValue(t.data,t,\\\"data\\\"),this.activeTransformsStack.pop(),e[n]=o.fromSerializable(t.data)},t.prototype._handleCircularSelfRefDuringTransform=function(t,r,e){var n=this.references;Object.defineProperty(r,e,{val:void 0,configurable:!0,enumerable:!0,get:function(){return void 0===this.val&&(this.val=n[t]),this.val},set:function(t){this.val=t}})},t.prototype._handleCircularRef=function(t,r,e){this.activeTransformsStack.includes(this.references[t])?this._handleCircularSelfRefDuringTransform(t,r,e):(this.visitedRefs[t]||(this.visitedRefs[t]=!0,this._handleValue(this.references[t],this.references,t)),r[e]=this.references[t])},t.prototype._handleValue=function(t,e,n){if(\\\"object\\\"==typeof t&&null!==t){var a=t[\\\"@r\\\"];if(void 0!==a)this._handleCircularRef(a,e,n);else if(t[r])this._handleTransformedObject(t,e,n);else if(Array.isArray(t))for(var o=0;o<t.length;o++)this._handleValue(t[o],t,o);else this._handlePlainObject(t)}},t.prototype.transform=function(){return this.visitedRefs[0]=!0,this._handleValue(this.references[0],this.references,0),this.references[0]},t}(),d=[{type:\\\"[[NaN]]\\\",shouldTransform:function(t,r){return\\\"number\\\"===t&&isNaN(r)},toSerializable:function(){return\\\"\\\"},fromSerializable:function(){return NaN}},{type:\\\"[[undefined]]\\\",shouldTransform:function(t){return\\\"undefined\\\"===t},toSerializable:function(){return\\\"\\\"},fromSerializable:function(){}},{type:\\\"[[Date]]\\\",lookup:Date,shouldTransform:function(t,r){return r instanceof Date},toSerializable:function(t){return t.getTime()},fromSerializable:function(t){var r=new Date;return r.setTime(t),r}},{type:\\\"[[RegExp]]\\\",lookup:RegExp,shouldTransform:function(t,r){return r instanceof RegExp},toSerializable:function(t){var r={src:t.source,flags:\\\"\\\"};return t.globalThis&&(r.flags+=\\\"g\\\"),t.ignoreCase&&(r.flags+=\\\"i\\\"),t.multiline&&(r.flags+=\\\"m\\\"),r},fromSerializable:function(t){return new RegExp(t.src,t.flags)}},{type:\\\"[[Error]]\\\",lookup:Error,shouldTransform:function(t,r){return r instanceof Error},toSerializable:function(t){var r,e;return t.stack||null===(e=(r=Error).captureStackTrace)||void 0===e||e.call(r,t),{name:t.name,message:t.message,stack:t.stack}},fromSerializable:function(t){var r=new(n[t.name]||Error)(t.message);return r.stack=t.stack,r}},{type:\\\"[[ArrayBuffer]]\\\",lookup:a&&ArrayBuffer,shouldTransform:function(t,r){return a&&r instanceof ArrayBuffer},toSerializable:function(t){var r=new Int8Array(t);return s.call(r)},fromSerializable:function(t){if(a){var r=new ArrayBuffer(t.length);return new Int8Array(r).set(t),r}return t}},{type:\\\"[[TypedArray]]\\\",shouldTransform:function(t,r){if(a)return ArrayBuffer.isView(r)&&!(r instanceof DataView);for(var e=0,o=u;e<o.length;e++){var i=o[e];if(\\\"function\\\"==typeof n[i]&&r instanceof n[i])return!0}return!1},toSerializable:function(t){return{ctorName:t.constructor.name,arr:s.call(t)}},fromSerializable:function(t){return\\\"function\\\"==typeof n[t.ctorName]?new n[t.ctorName](t.arr):t.arr}},{type:\\\"[[Map]]\\\",lookup:o&&Map,shouldTransform:function(t,r){return o&&r instanceof Map},toSerializable:function(t){var r=[];return t.forEach((function(t,e){r.push(e),r.push(t)})),r},fromSerializable:function(t){if(o){for(var r=new Map,e=0;e<t.length;e+=2)r.set(t[e],t[e+1]);return r}for(var n=[],a=0;a<t.length;a+=2)n.push([t[e],t[e+1]]);return n}},{type:\\\"[[Set]]\\\",lookup:i&&Set,shouldTransform:function(t,r){return i&&r instanceof Set},toSerializable:function(t){var r=[];return t.forEach((function(t){r.push(t)})),r},fromSerializable:function(t){if(i){for(var r=new Set,e=0;e<t.length;e++)r.add(t[e]);return r}return t}}],p=function(){function t(t){this.transforms=[],this.transformsMap=Object.create(null),this.serializer=t||f,this.addTransforms(d)}return t.prototype.addTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r];if(this.transformsMap[n.type])throw new Error('Transform with type \\\"'+n.type+'\\\" was already added.');this.transforms.push(n),this.transformsMap[n.type]=n}return this},t.prototype.removeTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r],a=this.transforms.indexOf(n);a>-1&&this.transforms.splice(a,1),delete this.transformsMap[n.type]}return this},t.prototype.encode=function(t){var r=new c(t,this.transforms).transform();return this.serializer.serialize(r)},t.prototype.decode=function(t){var r=this.serializer.deserialize(t);return new l(r,this.transformsMap).transform()},t}();t.default=p}(z);var E=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};S.__esModule=!0,S.Decode=P=S.Encode=void 0;var k=E(O),C=E(w),D=E(A),I=E(j),N=E(z),R=[D.default,C.default,k.default,I.default],x=new N.default;x.addTransforms(R);var P=S.Encode=function(t){return JSON.parse(x.encode(t))};S.Decode=function(t){return x.decode(JSON.stringify(t))},function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var a=e(n),i=e(o),u=S;r.default=function(t,r,e){void 0===e&&(e=!0);for(var n=t,o={pointers:{},src:{npm:\\\"https://npmjs.com/package/console-feed\\\",github:\\\"https://github.com/samdenty99/console-feed\\\"}},s=function(t){var a=n[t];n[t]=function(){a.apply(this,arguments);var n=[].slice.call(arguments);setTimeout((function(){var a=i.default(t,n);if(a){var o=a;e&&(o=u.Encode(a)),r(o,a)}}))},o.pointers[t]=a},f=0,c=a.default;f<c.length;f++)s(c[f]);return n.feed=o,n}}(e),r(e)(window.console,(function(t){var r=P(t);parent.postMessage({type:\\\"console\\\",codesandbox:!0,log:Array.isArray(r)?r[0]:r,channelId:scope.channelId},\\\"*\\\")}));\\n\";\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2NvbnNvbGVIb29rLWNkYmU1NGFiLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQXVDO0FBQ2lCOztBQUV4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsMkJBQTJCO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhCQUE4QjtBQUMvQjtBQUNBLGFBQWEscUJBQXFCO0FBQ2xDLGFBQWEsb0JBQW9CO0FBQ2pDLFlBQVksc0JBQXNCO0FBQ2xDLFlBQVksMEJBQTBCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Es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aUNBQWlDLFVBQVUsRUFBRSxzREFBc0QsNERBQTRELGdCQUFnQixXQUFXLEtBQUssV0FBVyx5REFBeUQsU0FBUyw0QkFBNEIsT0FBTywyQ0FBMkMsOEJBQThCLHlFQUF5RSxFQUFFLDZEQUE2RCwyQkFBMkIsNEJBQTRCLFNBQVMsZ0NBQWdDLG9CQUFvQixLQUFLLDhCQUE4QixNQUFNLHNCQUFzQixXQUFXLHdCQUF3QixTQUFTLGlCQUFpQixXQUFXLDJCQUEyQixVQUFVLEVBQUUsNkRBQTZELDJCQUEyQiw0QkFBNEIsU0FBUyw4QkFBOEIsVUFBVSxLQUFLLDhCQUE4QixNQUFNLHNCQUFzQixXQUFXLGdCQUFnQixTQUFTLFVBQVUsZUFBZSxjQUFjLHFHQUFxRyw2Q0FBNkMsdUNBQXVDLFdBQVcsS0FBSyxXQUFXLHVHQUF1RyxxREFBcUQsWUFBWSwwQ0FBMEMsdUNBQXVDLFdBQVcsS0FBSyx3Q0FBd0Msb0VBQW9FLFlBQVksZ0NBQWdDLDJDQUEyQyxvQ0FBb0MsZ0NBQWdDLHFDQUFxQywrQ0FBK0MsR0FBRyxHQUFHLFlBQVksSUFBSSx3Q0FBd0MsMEJBQTBCLFlBQVksMkNBQTJDLG1HQUFtRyxtQkFBbUIsMkJBQTJCLGdDQUFnQyxxQkFBcUIsbUNBQW1DLGFBQWEsd0NBQXdDLDBCQUEwQixZQUFZLGdCQUFnQixzQkFBc0IsMEJBQTBCLG1CQUFtQixlQUFlLFdBQVcsTUFBTSxzR0FBc0csZUFBZSxXQUFXLGdCQUFnQix3QkFBd0IsK0JBQStCLHVCQUF1QixxQkFBcUIsTUFBTSxRQUFRLDJCQUEyQixHQUFHLGlCQUFpQixpQkFBaUIsV0FBVyxZQUFZLG1CQUFtQixxQ0FBcUMsV0FBVyxvQkFBb0Isc0ZBQXNGLFFBQVEsR0FBRzs7QUFFcm9nQiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGNvZGVzYW5kYm94L3NhbmRwYWNrLWNsaWVudC9kaXN0L2NvbnNvbGVIb29rLWNkYmU1NGFiLm1qcz9jYWYyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGludmFyaWFudCB9IGZyb20gJ291dHZhcmlhbnQnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVFcnJvciB9IGZyb20gJy4vdHlwZXMtMDg3N2M1NTMubWpzJztcblxudmFyIEV2ZW50RW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMubGlzdGVuZXJzQ291bnQgPSAwO1xuICAgICAgICB0aGlzLmNoYW5uZWxJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApO1xuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IFtdO1xuICAgIH1cbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmNsZWFudXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIHRoaXMubGlzdGVuZXJzQ291bnQgPSAwO1xuICAgIH07XG4gICAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5kaXNwYXRjaCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5saXN0ZW5lcnMpLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7IHJldHVybiBsaXN0ZW5lcihtZXNzYWdlKTsgfSk7XG4gICAgfTtcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ZW5lcklkID0gdGhpcy5saXN0ZW5lcnNDb3VudDtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNbbGlzdGVuZXJJZF0gPSBsaXN0ZW5lcjtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNDb3VudCsrO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGVsZXRlIF90aGlzLmxpc3RlbmVyc1tsaXN0ZW5lcklkXTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBFdmVudEVtaXR0ZXI7XG59KCkpO1xuXG5mdW5jdGlvbiBpc0NvbW1hbmQoY2hhcikge1xuICAgIHJldHVybiAvW2EtekEtWi5dLy50ZXN0KGNoYXIpO1xufVxuZnVuY3Rpb24gaXNBbHBoYShjaGFyKSB7XG4gICAgcmV0dXJuIC9bYS16QS1aXS8udGVzdChjaGFyKTtcbn1cbmZ1bmN0aW9uIGlzV2hpdGVzcGFjZShjaGFyKSB7XG4gICAgcmV0dXJuIC9cXHMvLnRlc3QoY2hhcik7XG59XG5mdW5jdGlvbiBpc09wZXJhdG9yKGNoYXIpIHtcbiAgICByZXR1cm4gL1smfF0vLnRlc3QoY2hhcik7XG59XG5mdW5jdGlvbiBpc0FyZ3VtZW50KGNoYXIpIHtcbiAgICByZXR1cm4gLy0vLnRlc3QoY2hhcik7XG59XG5mdW5jdGlvbiBpc1N0cmluZyhjaGFyKSB7XG4gICAgcmV0dXJuIC9bXCInXS8udGVzdChjaGFyKTtcbn1cbmZ1bmN0aW9uIGlzRW52VmFyKGNoYXIpIHtcbiAgICByZXR1cm4gaXNBbHBoYShjaGFyKSAmJiBjaGFyID09PSBjaGFyLnRvVXBwZXJDYXNlKCk7XG59XG52YXIgVG9rZW5UeXBlO1xuKGZ1bmN0aW9uIChUb2tlblR5cGUpIHtcbiAgICBUb2tlblR5cGVbXCJPUlwiXSA9IFwiT1JcIjtcbiAgICBUb2tlblR5cGVbXCJBTkRcIl0gPSBcIkFORFwiO1xuICAgIFRva2VuVHlwZVtcIlBJUEVcIl0gPSBcIlBJUEVcIjtcbiAgICBUb2tlblR5cGVbXCJDb21tYW5kXCJdID0gXCJDb21tYW5kXCI7XG4gICAgVG9rZW5UeXBlW1wiQXJndW1lbnRcIl0gPSBcIkFyZ3VtZW50XCI7XG4gICAgVG9rZW5UeXBlW1wiU3RyaW5nXCJdID0gXCJTdHJpbmdcIjtcbiAgICBUb2tlblR5cGVbXCJFbnZWYXJcIl0gPSBcIkVudlZhclwiO1xufSkoVG9rZW5UeXBlIHx8IChUb2tlblR5cGUgPSB7fSkpO1xudmFyIG9wZXJhdG9ycyA9IG5ldyBNYXAoW1xuICAgIFtcIiYmXCIsIHsgdHlwZTogVG9rZW5UeXBlLkFORCB9XSxcbiAgICBbXCJ8fFwiLCB7IHR5cGU6IFRva2VuVHlwZS5PUiB9XSxcbiAgICBbXCJ8XCIsIHsgdHlwZTogVG9rZW5UeXBlLlBJUEUgfV0sXG4gICAgW1wiLVwiLCB7IHR5cGU6IFRva2VuVHlwZS5Bcmd1bWVudCB9XSxcbl0pO1xuZnVuY3Rpb24gdG9rZW5pemUoaW5wdXQpIHtcbiAgICB2YXIgY3VycmVudCA9IDA7XG4gICAgdmFyIHRva2VucyA9IFtdO1xuICAgIGZ1bmN0aW9uIHBhcnNlQ29tbWFuZCgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gXCJcIjtcbiAgICAgICAgd2hpbGUgKGlzQ29tbWFuZChpbnB1dFtjdXJyZW50XSkgJiYgY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRbY3VycmVudF07XG4gICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogVG9rZW5UeXBlLkNvbW1hbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZU9wZXJhdG9yKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICB3aGlsZSAoaXNPcGVyYXRvcihpbnB1dFtjdXJyZW50XSkgJiYgY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRbY3VycmVudF07XG4gICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9wZXJhdG9ycy5nZXQodmFsdWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZUFyZ3VtZW50KCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICB3aGlsZSAoKGlzQXJndW1lbnQoaW5wdXRbY3VycmVudF0pIHx8IGlzQWxwaGEoaW5wdXRbY3VycmVudF0pKSAmJlxuICAgICAgICAgICAgY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRbY3VycmVudF07XG4gICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogVG9rZW5UeXBlLkFyZ3VtZW50LCB2YWx1ZTogdmFsdWUgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcGFyc2VTdHJpbmcoKSB7XG4gICAgICAgIHZhciBvcGVuQ2xvc2VRdW90ZSA9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICB2YXIgdmFsdWUgPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgY3VycmVudCsrO1xuICAgICAgICB3aGlsZSAoaW5wdXRbY3VycmVudF0gIT09IG9wZW5DbG9zZVF1b3RlICYmIGN1cnJlbnQgPCBpbnB1dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhbHVlICs9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlICs9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIHJldHVybiB7IHR5cGU6IFRva2VuVHlwZS5TdHJpbmcsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZUVudlZhcnMoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHt9O1xuICAgICAgICB2YXIgcGFyc2VTaW5nbGVFbnYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBwYWlyID0gXCJcIjtcbiAgICAgICAgICAgIHdoaWxlIChpbnB1dFtjdXJyZW50XSAhPT0gXCI9XCIgJiYgY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGtleSArPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTa2lwIGVxdWFsXG4gICAgICAgICAgICBpZiAoaW5wdXRbY3VycmVudF0gPT09IFwiPVwiKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKGlucHV0W2N1cnJlbnRdICE9PSBcIiBcIiAmJiBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcGFpciArPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZVtrZXldID0gcGFpcjtcbiAgICAgICAgfTtcbiAgICAgICAgd2hpbGUgKGlzRW52VmFyKGlucHV0W2N1cnJlbnRdKSAmJiBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICBwYXJzZVNpbmdsZUVudigpO1xuICAgICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6IFRva2VuVHlwZS5FbnZWYXIsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICB3aGlsZSAoY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICB2YXIgY3VycmVudENoYXIgPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgaWYgKGlzV2hpdGVzcGFjZShjdXJyZW50Q2hhcikpIHtcbiAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgY2FzZSBpc0VudlZhcihjdXJyZW50Q2hhcik6XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2gocGFyc2VFbnZWYXJzKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBpc0NvbW1hbmQoY3VycmVudENoYXIpOlxuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHBhcnNlQ29tbWFuZCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgaXNPcGVyYXRvcihjdXJyZW50Q2hhcik6XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2gocGFyc2VPcGVyYXRvcigpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgaXNBcmd1bWVudChjdXJyZW50Q2hhcik6XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2gocGFyc2VBcmd1bWVudCgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgaXNTdHJpbmcoY3VycmVudENoYXIpOlxuICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKHBhcnNlU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIGNoYXJhY3RlcjogXCIuY29uY2F0KGN1cnJlbnRDaGFyKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRva2Vucztcbn1cblxudmFyIGNvdW50ZXIgPSAwO1xuZnVuY3Rpb24gZ2VuZXJhdGVSYW5kb21JZCgpIHtcbiAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcbiAgICB2YXIgcmFuZG9tTnVtYmVyID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwMDApO1xuICAgIHZhciBjb3VudCA9IChjb3VudGVyICs9IDEpO1xuICAgIHJldHVybiAoK1wiXCIuY29uY2F0KG5vdykuY29uY2F0KHJhbmRvbU51bWJlcikuY29uY2F0KGNvdW50KSkudG9TdHJpbmcoMTYpO1xufVxudmFyIHdyaXRlQnVmZmVyID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjb250ZW50KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cbn07XG52YXIgcmVhZEJ1ZmZlciA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShjb250ZW50KTtcbiAgICB9XG59O1xudmFyIGZyb21CdW5kbGVyRmlsZXNUb0ZTID0gZnVuY3Rpb24gKGZpbGVzKSB7XG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGZpbGVzKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgX2EpIHtcbiAgICAgICAgdmFyIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xuICAgICAgICBhY2Nba2V5XSA9IHdyaXRlQnVmZmVyKHZhbHVlLmNvZGUpO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbn07XG4vKipcbiAqIEZpZ3VyZSBvdXQgd2hpY2ggc2NyaXB0IGl0IG11c3QgcnVuIHRvIHN0YXJ0IGEgc2VydmVyXG4gKi9cbnZhciBmaW5kU3RhcnRTY3JpcHRQYWNrYWdlSnNvbiA9IGZ1bmN0aW9uIChwYWNrYWdlSnNvbikge1xuICAgIHZhciBzY3JpcHRzID0ge307XG4gICAgLy8gVE9ETzogc3VwcG9ydCBwb3N0aW5zdGFsbFxuICAgIHZhciBwb3NzaWJsZUtleXMgPSBbXCJkZXZcIiwgXCJzdGFydFwiXTtcbiAgICB0cnkge1xuICAgICAgICBzY3JpcHRzID0gSlNPTi5wYXJzZShwYWNrYWdlSnNvbikuc2NyaXB0cztcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3IoXCJDb3VsZCBub3QgcGFyc2UgcGFja2FnZS5qc29uIGZpbGU6IFwiICsgZS5tZXNzYWdlKTtcbiAgICB9XG4gICAgaW52YXJpYW50KHNjcmlwdHMsIFwiRmFpbGVkIHRvIHN0YXJ0LiBQbGVhc2UgcHJvdmlkZSBhIGBzdGFydGAgb3IgYGRldmAgc2NyaXB0IG9uIHRoZSBwYWNrYWdlLmpzb25cIik7XG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKHBvc3NpYmxlS2V5c1tpbmRleF0gaW4gc2NyaXB0cykge1xuICAgICAgICAgICAgdmFyIHNjcmlwdCA9IHBvc3NpYmxlS2V5c1tpbmRleF07XG4gICAgICAgICAgICB2YXIgY2FuZGlkYXRlID0gc2NyaXB0c1tzY3JpcHRdO1xuICAgICAgICAgICAgdmFyIGVudl8xID0ge307XG4gICAgICAgICAgICB2YXIgY29tbWFuZF8xID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBhcmdzXzEgPSBbXTtcbiAgICAgICAgICAgIHRva2VuaXplKGNhbmRpZGF0ZSkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBjb21tYW5kTm90Rm91bmRZZXQgPSBjb21tYW5kXzEgPT09IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gVG9rZW5UeXBlLkVudlZhcikge1xuICAgICAgICAgICAgICAgICAgICBlbnZfMSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgPT09IFRva2VuVHlwZS5Db21tYW5kICYmIGNvbW1hbmROb3RGb3VuZFlldCkge1xuICAgICAgICAgICAgICAgICAgICBjb21tYW5kXzEgPSBpdGVtLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50eXBlID09PSBUb2tlblR5cGUuQXJndW1lbnQgfHxcbiAgICAgICAgICAgICAgICAgICAgKCFjb21tYW5kTm90Rm91bmRZZXQgJiYgaXRlbS50eXBlID09PSBUb2tlblR5cGUuQ29tbWFuZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc18xLnB1c2goaXRlbS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHN1cHBvcnQgVG9rZW5UeXBlLkFORCwgVG9rZW5UeXBlLk9SLCBUb2tlblR5cGUuUElQRVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogW2NvbW1hbmRfMSwgYXJnc18xLCB7IGVudjogZW52XzEgfV0gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHBvc3NpYmxlS2V5cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKGluZGV4KTtcbiAgICAgICAgaWYgKHR5cGVvZiBzdGF0ZV8xID09PSBcIm9iamVjdFwiKVxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgfVxuICAgIHRocm93IGNyZWF0ZUVycm9yKFwiRmFpbGVkIHRvIHN0YXJ0LiBQbGVhc2UgcHJvdmlkZSBhIGBzdGFydGAgb3IgYGRldmAgc2NyaXB0IG9uIHRoZSBwYWNrYWdlLmpzb25cIik7XG59O1xudmFyIGdldE1lc3NhZ2VGcm9tRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBpZiAodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiKVxuICAgICAgICByZXR1cm4gZXJyb3I7XG4gICAgaWYgKHR5cGVvZiBlcnJvciA9PT0gXCJvYmplY3RcIiAmJiBcIm1lc3NhZ2VcIiBpbiBlcnJvcikge1xuICAgICAgICByZXR1cm4gZXJyb3IubWVzc2FnZTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yKFwiVGhlIHNlcnZlciBjb3VsZCBub3QgYmUgcmVhY2hlZC4gTWFrZSBzdXJlIHRoYXQgdGhlIG5vZGUgc2NyaXB0IGlzIHJ1bm5pbmcgYW5kIHRoYXQgYSBwb3J0IGhhcyBiZWVuIHN0YXJ0ZWQuXCIpO1xufTtcblxudmFyIGNvbnNvbGVIb29rID0gXCJ2YXIgdD1cXFwidW5kZWZpbmVkXFxcIiE9dHlwZW9mIGdsb2JhbFRoaXM/Z2xvYmFsVGhpczpcXFwidW5kZWZpbmVkXFxcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6XFxcInVuZGVmaW5lZFxcXCIhPXR5cGVvZiBnbG9iYWxUaGlzP2dsb2JhbFRoaXM6XFxcInVuZGVmaW5lZFxcXCIhPXR5cGVvZiBzZWxmP3NlbGY6e307ZnVuY3Rpb24gcih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlJiZPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxcXFwiZGVmYXVsdFxcXCIpP3QuZGVmYXVsdDp0fXZhciBlPXt9LG49e307IWZ1bmN0aW9uKHQpe3QuX19lc01vZHVsZT0hMCx0LmRlZmF1bHQ9W1xcXCJsb2dcXFwiLFxcXCJkZWJ1Z1xcXCIsXFxcImluZm9cXFwiLFxcXCJ3YXJuXFxcIixcXFwiZXJyb3JcXFwiLFxcXCJ0YWJsZVxcXCIsXFxcImNsZWFyXFxcIixcXFwidGltZVxcXCIsXFxcInRpbWVFbmRcXFwiLFxcXCJjb3VudFxcXCIsXFxcImFzc2VydFxcXCIsXFxcImNvbW1hbmRcXFwiLFxcXCJyZXN1bHRcXFwiXX0obik7dmFyIGEsbz17fSxpPXt9OyhhPWkpLl9fZXNNb2R1bGU9ITAsYS5kZWZhdWx0PWZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24oKXtyZXR1cm4oNjU1MzYqKDErTWF0aC5yYW5kb20oKSl8MCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKX07cmV0dXJuIHQoKSt0KCkrXFxcIi1cXFwiK3QoKStcXFwiLVxcXCIrdCgpK1xcXCItXFxcIit0KCkrXFxcIi1cXFwiK3QoKStcXFwiLVxcXCIrRGF0ZS5ub3coKX07dmFyIHU9e30scz17X19lc01vZHVsZTohMH07cy51cGRhdGU9cy5zdGF0ZT12b2lkIDAscy51cGRhdGU9ZnVuY3Rpb24odCl7cy5zdGF0ZT10fTt2YXIgZj17fSxjPXt9OyFmdW5jdGlvbihyKXt2YXIgZT10JiZ0Ll9fYXNzaWdufHxmdW5jdGlvbigpe3JldHVybiBlPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgcixlPTEsbj1hcmd1bWVudHMubGVuZ3RoO2U8bjtlKyspZm9yKHZhciBhIGluIHI9YXJndW1lbnRzW2VdKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyLGEpJiYodFthXT1yW2FdKTtyZXR1cm4gdH0sZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3IuX19lc01vZHVsZT0hMCxyLmluaXRpYWxTdGF0ZT12b2lkIDAsci5pbml0aWFsU3RhdGU9e3RpbWluZ3M6e30sY291bnQ6e319O3ZhciBuPWZ1bmN0aW9uKCl7cmV0dXJuXFxcInVuZGVmaW5lZFxcXCIhPXR5cGVvZiBwZXJmb3JtYW5jZSYmcGVyZm9ybWFuY2Uubm93P3BlcmZvcm1hbmNlLm5vdygpOkRhdGUubm93KCl9O3IuZGVmYXVsdD1mdW5jdGlvbih0LGEpe3ZhciBvLGksdTtzd2l0Y2godm9pZCAwPT09dCYmKHQ9ci5pbml0aWFsU3RhdGUpLGEudHlwZSl7Y2FzZVxcXCJDT1VOVFxcXCI6dmFyIHM9dC5jb3VudFthLm5hbWVdfHwwO3JldHVybiBlKGUoe30sdCkse2NvdW50OmUoZSh7fSx0LmNvdW50KSwobz17fSxvW2EubmFtZV09cysxLG8pKX0pO2Nhc2VcXFwiVElNRV9TVEFSVFxcXCI6cmV0dXJuIGUoZSh7fSx0KSx7dGltaW5nczplKGUoe30sdC50aW1pbmdzKSwoaT17fSxpW2EubmFtZV09e3N0YXJ0Om4oKX0saSkpfSk7Y2FzZVxcXCJUSU1FX0VORFxcXCI6dmFyIGY9dC50aW1pbmdzW2EubmFtZV0sYz1uKCksbD1jLWYuc3RhcnQ7cmV0dXJuIGUoZSh7fSx0KSx7dGltaW5nczplKGUoe30sdC50aW1pbmdzKSwodT17fSx1W2EubmFtZV09ZShlKHt9LGYpLHtlbmQ6Yyx0aW1lOmx9KSx1KSl9KTtkZWZhdWx0OnJldHVybiB0fX19KGMpLGZ1bmN0aW9uKHIpe3ZhciBlPXQmJnQuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19O3IuX19lc01vZHVsZT0hMDt2YXIgbj1lKGMpLGE9cztyLmRlZmF1bHQ9ZnVuY3Rpb24odCl7YS51cGRhdGUobi5kZWZhdWx0KGEuc3RhdGUsdCkpfX0oZik7dmFyIGw9e19fZXNNb2R1bGU6ITB9O2wudGltZUVuZD1sLnRpbWVTdGFydD1sLmNvdW50PXZvaWQgMCxsLmNvdW50PWZ1bmN0aW9uKHQpe3JldHVybnt0eXBlOlxcXCJDT1VOVFxcXCIsbmFtZTp0fX0sbC50aW1lU3RhcnQ9ZnVuY3Rpb24odCl7cmV0dXJue3R5cGU6XFxcIlRJTUVfU1RBUlRcXFwiLG5hbWU6dH19LGwudGltZUVuZD1mdW5jdGlvbih0KXtyZXR1cm57dHlwZTpcXFwiVElNRV9FTkRcXFwiLG5hbWU6dH19O3ZhciBkPXQmJnQuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19O3UuX19lc01vZHVsZT0hMCx1LnN0b3A9dS5zdGFydD12b2lkIDA7dmFyIHA9cyxoPWQoZiksbT1sO3Uuc3RhcnQ9ZnVuY3Rpb24odCl7aC5kZWZhdWx0KG0udGltZVN0YXJ0KHQpKX0sdS5zdG9wPWZ1bmN0aW9uKHQpe3ZhciByPW51bGw9PT1wLnN0YXRlfHx2b2lkIDA9PT1wLnN0YXRlP3ZvaWQgMDpwLnN0YXRlLnRpbWluZ3NbdF07cmV0dXJuIHImJiFyLmVuZD8oaC5kZWZhdWx0KG0udGltZUVuZCh0KSkse21ldGhvZDpcXFwibG9nXFxcIixkYXRhOlt0K1xcXCI6IFxcXCIrcC5zdGF0ZS50aW1pbmdzW3RdLnRpbWUrXFxcIm1zXFxcIl19KTp7bWV0aG9kOlxcXCJ3YXJuXFxcIixkYXRhOltcXFwiVGltZXIgJ1xcXCIrdCtcXFwiJyBkb2VzIG5vdCBleGlzdFxcXCJdfX07dmFyIHk9e30sdj10JiZ0Ll9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fTt5Ll9fZXNNb2R1bGU9ITAseS5pbmNyZW1lbnQ9dm9pZCAwO3ZhciBfPXMsYj12KGYpLGc9bDt5LmluY3JlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4gYi5kZWZhdWx0KGcuY291bnQodCkpLHttZXRob2Q6XFxcImxvZ1xcXCIsZGF0YTpbdCtcXFwiOiBcXFwiK18uc3RhdGUuY291bnRbdF1dfX07dmFyIE09e30sVD10JiZ0Ll9fc3ByZWFkQXJyYXlzfHxmdW5jdGlvbigpe2Zvcih2YXIgdD0wLHI9MCxlPWFyZ3VtZW50cy5sZW5ndGg7cjxlO3IrKyl0Kz1hcmd1bWVudHNbcl0ubGVuZ3RoO3ZhciBuPUFycmF5KHQpLGE9MDtmb3Iocj0wO3I8ZTtyKyspZm9yKHZhciBvPWFyZ3VtZW50c1tyXSxpPTAsdT1vLmxlbmd0aDtpPHU7aSsrLGErKyluW2FdPW9baV07cmV0dXJuIG59O00uX19lc01vZHVsZT0hMCxNLnRlc3Q9dm9pZCAwLE0udGVzdD1mdW5jdGlvbih0KXtmb3IodmFyIHI9W10sZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspcltlLTFdPWFyZ3VtZW50c1tlXTtyZXR1cm4hdCYmKDA9PT1yLmxlbmd0aCYmci5wdXNoKFxcXCJjb25zb2xlLmFzc2VydFxcXCIpLHttZXRob2Q6XFxcImVycm9yXFxcIixkYXRhOlQoW1xcXCJBc3NlcnRpb24gZmFpbGVkOlxcXCJdLHIpfSl9LGZ1bmN0aW9uKHIpe3ZhciBlPXQmJnQuX19hc3NpZ258fGZ1bmN0aW9uKCl7cmV0dXJuIGU9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciByLGU9MSxuPWFyZ3VtZW50cy5sZW5ndGg7ZTxuO2UrKylmb3IodmFyIGEgaW4gcj1hcmd1bWVudHNbZV0pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHIsYSkmJih0W2FdPXJbYV0pO3JldHVybiB0fSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sbj10JiZ0Ll9fY3JlYXRlQmluZGluZ3x8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24odCxyLGUsbil7dm9pZCAwPT09biYmKG49ZSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbix7ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcltlXX19KX06ZnVuY3Rpb24odCxyLGUsbil7dm9pZCAwPT09biYmKG49ZSksdFtuXT1yW2VdfSksYT10JiZ0Ll9fc2V0TW9kdWxlRGVmYXVsdHx8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24odCxyKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcXFwiZGVmYXVsdFxcXCIse2VudW1lcmFibGU6ITAsdmFsdWU6cn0pfTpmdW5jdGlvbih0LHIpe3QuZGVmYXVsdD1yfSksbz10JiZ0Ll9faW1wb3J0U3Rhcnx8ZnVuY3Rpb24odCl7aWYodCYmdC5fX2VzTW9kdWxlKXJldHVybiB0O3ZhciByPXt9O2lmKG51bGwhPXQpZm9yKHZhciBlIGluIHQpXFxcImRlZmF1bHRcXFwiIT09ZSYmT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSkmJm4ocix0LGUpO3JldHVybiBhKHIsdCkscn0scz10JiZ0Ll9fc3ByZWFkQXJyYXlzfHxmdW5jdGlvbigpe2Zvcih2YXIgdD0wLHI9MCxlPWFyZ3VtZW50cy5sZW5ndGg7cjxlO3IrKyl0Kz1hcmd1bWVudHNbcl0ubGVuZ3RoO3ZhciBuPUFycmF5KHQpLGE9MDtmb3Iocj0wO3I8ZTtyKyspZm9yKHZhciBvPWFyZ3VtZW50c1tyXSxpPTAsdT1vLmxlbmd0aDtpPHU7aSsrLGErKyluW2FdPW9baV07cmV0dXJuIG59LGY9dCYmdC5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX07ci5fX2VzTW9kdWxlPSEwO3ZhciBjPWYoaSksbD1vKHUpLGQ9byh5KSxwPW8oTSk7ci5kZWZhdWx0PWZ1bmN0aW9uKHQscixuKXt2YXIgYT1ufHxjLmRlZmF1bHQoKTtzd2l0Y2godCl7Y2FzZVxcXCJjbGVhclxcXCI6cmV0dXJue21ldGhvZDp0LGlkOmF9O2Nhc2VcXFwiY291bnRcXFwiOnJldHVybiEhKG89XFxcInN0cmluZ1xcXCI9PXR5cGVvZiByWzBdP3JbMF06XFxcImRlZmF1bHRcXFwiKSYmZShlKHt9LGQuaW5jcmVtZW50KG8pKSx7aWQ6YX0pO2Nhc2VcXFwidGltZVxcXCI6Y2FzZVxcXCJ0aW1lRW5kXFxcIjp2YXIgbztyZXR1cm4hIShvPVxcXCJzdHJpbmdcXFwiPT10eXBlb2YgclswXT9yWzBdOlxcXCJkZWZhdWx0XFxcIikmJihcXFwidGltZVxcXCI9PT10PyhsLnN0YXJ0KG8pLCExKTplKGUoe30sbC5zdG9wKG8pKSx7aWQ6YX0pKTtjYXNlXFxcImFzc2VydFxcXCI6aWYoMCE9PXIubGVuZ3RoKXt2YXIgaT1wLnRlc3QuYXBwbHkocCxzKFtyWzBdXSxyLnNsaWNlKDEpKSk7aWYoaSlyZXR1cm4gZShlKHt9LGkpLHtpZDphfSl9cmV0dXJuITE7Y2FzZVxcXCJlcnJvclxcXCI6cmV0dXJue21ldGhvZDp0LGlkOmEsZGF0YTpyLm1hcCgoZnVuY3Rpb24odCl7dHJ5e3JldHVybiB0LnN0YWNrfHx0fWNhdGNoKHIpe3JldHVybiB0fX0pKX07ZGVmYXVsdDpyZXR1cm57bWV0aG9kOnQsaWQ6YSxkYXRhOnJ9fX19KG8pO3ZhciBTPXt9LE89e307IWZ1bmN0aW9uKHQpe3ZhciByO3QuX19lc01vZHVsZT0hMCxmdW5jdGlvbih0KXt0W3QuaW5maW5pdHk9MF09XFxcImluZmluaXR5XFxcIix0W3QubWludXNJbmZpbml0eT0xXT1cXFwibWludXNJbmZpbml0eVxcXCIsdFt0Lm1pbnVzWmVybz0yXT1cXFwibWludXNaZXJvXFxcIn0ocnx8KHI9e30pKSx0LmRlZmF1bHQ9e3R5cGU6XFxcIkFyaXRobWV0aWNcXFwiLGxvb2t1cDpOdW1iZXIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuXFxcIm51bWJlclxcXCI9PT10JiYocj09PTEvMHx8cj09PS0xLzB8fGZ1bmN0aW9uKHQpe3JldHVybiAxL3Q9PS0xLzB9KHIpKX0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT0xLzA/ci5pbmZpbml0eTp0PT09LTEvMD9yLm1pbnVzSW5maW5pdHk6ci5taW51c1plcm99LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT1yLmluZmluaXR5PzEvMDp0PT09ci5taW51c0luZmluaXR5Py0xLzA6dD09PXIubWludXNaZXJvPy0wOnR9fX0oTyk7dmFyIHc9e307IWZ1bmN0aW9uKHQpe3QuX19lc01vZHVsZT0hMCx0LmRlZmF1bHQ9e3R5cGU6XFxcIkZ1bmN0aW9uXFxcIixsb29rdXA6RnVuY3Rpb24sc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuXFxcImZ1bmN0aW9uXFxcIj09dHlwZW9mIHJ9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPVxcXCJcXFwiO3RyeXtyPXQudG9TdHJpbmcoKS5zdWJzdHJpbmcoci5pbmRleE9mKFxcXCJ7XFxcIikrMSxyLmxhc3RJbmRleE9mKFxcXCJ9XFxcIikpfWNhdGNoKHQpe31yZXR1cm57bmFtZTp0Lm5hbWUsYm9keTpyLHByb3RvOk9iamVjdC5nZXRQcm90b3R5cGVPZih0KS5jb25zdHJ1Y3Rvci5uYW1lfX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt0cnl7dmFyIHI9ZnVuY3Rpb24oKXt9O3JldHVyblxcXCJzdHJpbmdcXFwiPT10eXBlb2YgdC5uYW1lJiZPYmplY3QuZGVmaW5lUHJvcGVydHkocixcXFwibmFtZVxcXCIse3ZhbHVlOnQubmFtZSx3cml0YWJsZTohMX0pLFxcXCJzdHJpbmdcXFwiPT10eXBlb2YgdC5ib2R5JiZPYmplY3QuZGVmaW5lUHJvcGVydHkocixcXFwiYm9keVxcXCIse3ZhbHVlOnQuYm9keSx3cml0YWJsZTohMX0pLFxcXCJzdHJpbmdcXFwiPT10eXBlb2YgdC5wcm90byYmKHIuY29uc3RydWN0b3I9e25hbWU6dC5wcm90b30pLHJ9Y2F0Y2gocil7cmV0dXJuIHR9fX19KHcpO3ZhciBBPXt9OyFmdW5jdGlvbih0KXt2YXIgcjtmdW5jdGlvbiBlKHQpe2Zvcih2YXIgcj17fSxlPTAsbj10LmF0dHJpYnV0ZXM7ZTxuLmxlbmd0aDtlKyspe3ZhciBhPW5bZV07clthLm5hbWVdPWEudmFsdWV9cmV0dXJuIHJ9dC5fX2VzTW9kdWxlPSEwLHQuZGVmYXVsdD17dHlwZTpcXFwiSFRNTEVsZW1lbnRcXFwiLHNob3VsZFRyYW5zZm9ybTpmdW5jdGlvbih0LHIpe3JldHVybiByJiZyLmNoaWxkcmVuJiZcXFwic3RyaW5nXFxcIj09dHlwZW9mIHIuaW5uZXJIVE1MJiZcXFwic3RyaW5nXFxcIj09dHlwZW9mIHIudGFnTmFtZX0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJue3RhZ05hbWU6dC50YWdOYW1lLnRvTG93ZXJDYXNlKCksYXR0cmlidXRlczplKHQpLGlubmVySFRNTDp0LmlubmVySFRNTH19LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dHJ5e3ZhciBlPShyfHwocj1kb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXFxcInNhbmRib3hcXFwiKSkpLmNyZWF0ZUVsZW1lbnQodC50YWdOYW1lKTtlLmlubmVySFRNTD10LmlubmVySFRNTDtmb3IodmFyIG49MCxhPU9iamVjdC5rZXlzKHQuYXR0cmlidXRlcyk7bjxhLmxlbmd0aDtuKyspe3ZhciBvPWFbbl07dHJ5e2Uuc2V0QXR0cmlidXRlKG8sdC5hdHRyaWJ1dGVzW29dKX1jYXRjaCh0KXt9fXJldHVybiBlfWNhdGNoKHIpe3JldHVybiB0fX19fShBKTt2YXIgaj17fTshZnVuY3Rpb24ocil7dmFyIGU9dCYmdC5fX2Fzc2lnbnx8ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIHIsZT0xLG49YXJndW1lbnRzLmxlbmd0aDtlPG47ZSsrKWZvcih2YXIgYSBpbiByPWFyZ3VtZW50c1tlXSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixhKSYmKHRbYV09clthXSk7cmV0dXJuIHR9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtyLl9fZXNNb2R1bGU9ITAsci5kZWZhdWx0PXt0eXBlOlxcXCJNYXBcXFwiLHNob3VsZFRyYW5zZm9ybTpmdW5jdGlvbih0LHIpe3JldHVybiByJiZyLmNvbnN0cnVjdG9yJiZcXFwiTWFwXFxcIj09PXIuY29uc3RydWN0b3IubmFtZX0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9e307cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24odCxlKXt2YXIgbj1cXFwib2JqZWN0XFxcIj09dHlwZW9mIGU/SlNPTi5zdHJpbmdpZnkoZSk6ZTtyW25dPXR9KSkse25hbWU6XFxcIk1hcFxcXCIsYm9keTpyLHByb3RvOk9iamVjdC5nZXRQcm90b3R5cGVPZih0KS5jb25zdHJ1Y3Rvci5uYW1lfX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj10LmJvZHksbj1lKHt9LHIpO3JldHVyblxcXCJzdHJpbmdcXFwiPT10eXBlb2YgdC5wcm90byYmKG4uY29uc3RydWN0b3I9e25hbWU6dC5wcm90b30pLG59fX0oaik7dmFyIHo9e307IWZ1bmN0aW9uKHQpe3QuX19lc01vZHVsZT0hMDt2YXIgcj1cXFwiQHRcXFwiLGU9L14jKkAodHxyKSQvLG49KDAsZXZhbCkoXFxcInRoaXNcXFwiKSxhPVxcXCJmdW5jdGlvblxcXCI9PXR5cGVvZiBBcnJheUJ1ZmZlcixvPVxcXCJmdW5jdGlvblxcXCI9PXR5cGVvZiBNYXAsaT1cXFwiZnVuY3Rpb25cXFwiPT10eXBlb2YgU2V0LHU9W1xcXCJJbnQ4QXJyYXlcXFwiLFxcXCJVaW50OEFycmF5XFxcIixcXFwiVWludDhDbGFtcGVkQXJyYXlcXFwiLFxcXCJJbnQxNkFycmF5XFxcIixcXFwiVWludDE2QXJyYXlcXFwiLFxcXCJJbnQzMkFycmF5XFxcIixcXFwiVWludDMyQXJyYXlcXFwiLFxcXCJGbG9hdDMyQXJyYXlcXFwiLFxcXCJGbG9hdDY0QXJyYXlcXFwiXSxzPUFycmF5LnByb3RvdHlwZS5zbGljZSxmPXtzZXJpYWxpemU6ZnVuY3Rpb24odCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHQpfSxkZXNlcmlhbGl6ZTpmdW5jdGlvbih0KXtyZXR1cm4gSlNPTi5wYXJzZSh0KX19LGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQscil7dGhpcy5yZWZlcmVuY2VzPXQsdGhpcy50cmFuc2Zvcm1zPXIsdGhpcy50cmFuc2Zvcm1zTWFwPXRoaXMuX21ha2VUcmFuc2Zvcm1zTWFwKCksdGhpcy5jaXJjdWxhckNhbmRpZGF0ZXM9W10sdGhpcy5jaXJjdWxhckNhbmRpZGF0ZXNEZXNjcnM9W10sdGhpcy5jaXJjdWxhclJlZkNvdW50PTB9cmV0dXJuIHQuX2NyZWF0ZVJlZk1hcms9ZnVuY3Rpb24odCl7dmFyIHI9T2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gcltcXFwiQHJcXFwiXT10LHJ9LHQucHJvdG90eXBlLl9jcmVhdGVDaXJjdWxhckNhbmRpZGF0ZT1mdW5jdGlvbih0LHIsZSl7dGhpcy5jaXJjdWxhckNhbmRpZGF0ZXMucHVzaCh0KSx0aGlzLmNpcmN1bGFyQ2FuZGlkYXRlc0Rlc2Nycy5wdXNoKHtwYXJlbnQ6cixrZXk6ZSxyZWZJZHg6LTF9KX0sdC5wcm90b3R5cGUuX2FwcGx5VHJhbnNmb3JtPWZ1bmN0aW9uKHQsZSxuLGEpe3ZhciBvPU9iamVjdC5jcmVhdGUobnVsbCksaT1hLnRvU2VyaWFsaXphYmxlKHQpO3JldHVyblxcXCJvYmplY3RcXFwiPT10eXBlb2YgaSYmdGhpcy5fY3JlYXRlQ2lyY3VsYXJDYW5kaWRhdGUodCxlLG4pLG9bcl09YS50eXBlLG8uZGF0YT10aGlzLl9oYW5kbGVWYWx1ZSgoZnVuY3Rpb24oKXtyZXR1cm4gaX0pLGUsbiksb30sdC5wcm90b3R5cGUuX2hhbmRsZUFycmF5PWZ1bmN0aW9uKHQpe2Zvcih2YXIgcj1bXSxlPWZ1bmN0aW9uKGUpe3JbZV09bi5faGFuZGxlVmFsdWUoKGZ1bmN0aW9uKCl7cmV0dXJuIHRbZV19KSxyLGUpfSxuPXRoaXMsYT0wO2E8dC5sZW5ndGg7YSsrKWUoYSk7cmV0dXJuIHJ9LHQucHJvdG90eXBlLl9oYW5kbGVQbGFpbk9iamVjdD1mdW5jdGlvbih0KXt2YXIgcixuLGE9T2JqZWN0LmNyZWF0ZShudWxsKSxvPWZ1bmN0aW9uKHIpe2lmKFJlZmxlY3QuaGFzKHQscikpe3ZhciBuPWUudGVzdChyKT9cXFwiI1xcXCIrcjpyO2Fbbl09aS5faGFuZGxlVmFsdWUoKGZ1bmN0aW9uKCl7cmV0dXJuIHRbcl19KSxhLG4pfX0saT10aGlzO2Zvcih2YXIgdSBpbiB0KW8odSk7dmFyIHM9bnVsbD09PShuPW51bGw9PT0ocj1udWxsPT10P3ZvaWQgMDp0Ll9fcHJvdG9fXyl8fHZvaWQgMD09PXI/dm9pZCAwOnIuY29uc3RydWN0b3IpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm5hbWU7cmV0dXJuIHMmJlxcXCJPYmplY3RcXFwiIT09cyYmKGEuY29uc3RydWN0b3I9e25hbWU6c30pLGF9LHQucHJvdG90eXBlLl9oYW5kbGVPYmplY3Q9ZnVuY3Rpb24odCxyLGUpe3JldHVybiB0aGlzLl9jcmVhdGVDaXJjdWxhckNhbmRpZGF0ZSh0LHIsZSksQXJyYXkuaXNBcnJheSh0KT90aGlzLl9oYW5kbGVBcnJheSh0KTp0aGlzLl9oYW5kbGVQbGFpbk9iamVjdCh0KX0sdC5wcm90b3R5cGUuX2Vuc3VyZUNpcmN1bGFyUmVmZXJlbmNlPWZ1bmN0aW9uKHIpe3ZhciBlPXRoaXMuY2lyY3VsYXJDYW5kaWRhdGVzLmluZGV4T2Yocik7aWYoZT4tMSl7dmFyIG49dGhpcy5jaXJjdWxhckNhbmRpZGF0ZXNEZXNjcnNbZV07cmV0dXJuLTE9PT1uLnJlZklkeCYmKG4ucmVmSWR4PW4ucGFyZW50PysrdGhpcy5jaXJjdWxhclJlZkNvdW50OjApLHQuX2NyZWF0ZVJlZk1hcmsobi5yZWZJZHgpfXJldHVybiBudWxsfSx0LnByb3RvdHlwZS5faGFuZGxlVmFsdWU9ZnVuY3Rpb24odCxyLGUpe3RyeXt2YXIgbj10KCksYT10eXBlb2YgbixvPVxcXCJvYmplY3RcXFwiPT09YSYmbnVsbCE9PW47aWYobyl7dmFyIGk9dGhpcy5fZW5zdXJlQ2lyY3VsYXJSZWZlcmVuY2Uobik7aWYoaSlyZXR1cm4gaX12YXIgdT10aGlzLl9maW5kVHJhbnNmb3JtKGEsbik7cmV0dXJuIHU/dGhpcy5fYXBwbHlUcmFuc2Zvcm0obixyLGUsdSk6bz90aGlzLl9oYW5kbGVPYmplY3QobixyLGUpOm59Y2F0Y2godCl7dHJ5e3JldHVybiB0aGlzLl9oYW5kbGVWYWx1ZSgoZnVuY3Rpb24oKXtyZXR1cm4gdCBpbnN0YW5jZW9mIEVycm9yP3Q6bmV3IEVycm9yKHQpfSkscixlKX1jYXRjaCh0KXtyZXR1cm4gbnVsbH19fSx0LnByb3RvdHlwZS5fbWFrZVRyYW5zZm9ybXNNYXA9ZnVuY3Rpb24oKXtpZihvKXt2YXIgdD1uZXcgTWFwO3JldHVybiB0aGlzLnRyYW5zZm9ybXMuZm9yRWFjaCgoZnVuY3Rpb24ocil7ci5sb29rdXAmJnQuc2V0KHIubG9va3VwLHIpfSkpLHR9fSx0LnByb3RvdHlwZS5fZmluZFRyYW5zZm9ybT1mdW5jdGlvbih0LHIpe2lmKG8mJnImJnIuY29uc3RydWN0b3ImJihudWxsPT0oYT10aGlzLnRyYW5zZm9ybXNNYXAuZ2V0KHIuY29uc3RydWN0b3IpKT92b2lkIDA6YS5zaG91bGRUcmFuc2Zvcm0odCxyKSkpcmV0dXJuIGE7Zm9yKHZhciBlPTAsbj10aGlzLnRyYW5zZm9ybXM7ZTxuLmxlbmd0aDtlKyspe3ZhciBhO2lmKChhPW5bZV0pLnNob3VsZFRyYW5zZm9ybSh0LHIpKXJldHVybiBhfX0sdC5wcm90b3R5cGUudHJhbnNmb3JtPWZ1bmN0aW9uKCl7Zm9yKHZhciByPXRoaXMsZT1bdGhpcy5faGFuZGxlVmFsdWUoKGZ1bmN0aW9uKCl7cmV0dXJuIHIucmVmZXJlbmNlc30pLG51bGwsbnVsbCldLG49MCxhPXRoaXMuY2lyY3VsYXJDYW5kaWRhdGVzRGVzY3JzO248YS5sZW5ndGg7bisrKXt2YXIgbz1hW25dO28ucmVmSWR4PjAmJihlW28ucmVmSWR4XT1vLnBhcmVudFtvLmtleV0sby5wYXJlbnRbby5rZXldPXQuX2NyZWF0ZVJlZk1hcmsoby5yZWZJZHgpKX1yZXR1cm4gZX0sdH0oKSxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LHIpe3RoaXMuYWN0aXZlVHJhbnNmb3Jtc1N0YWNrPVtdLHRoaXMudmlzaXRlZFJlZnM9T2JqZWN0LmNyZWF0ZShudWxsKSx0aGlzLnJlZmVyZW5jZXM9dCx0aGlzLnRyYW5zZm9ybU1hcD1yfXJldHVybiB0LnByb3RvdHlwZS5faGFuZGxlUGxhaW5PYmplY3Q9ZnVuY3Rpb24odCl7dmFyIHI9T2JqZWN0LmNyZWF0ZShudWxsKTtmb3IodmFyIG4gaW5cXFwiY29uc3RydWN0b3JcXFwiaW4gdCYmKHQuY29uc3RydWN0b3ImJlxcXCJzdHJpbmdcXFwiPT10eXBlb2YgdC5jb25zdHJ1Y3Rvci5uYW1lfHwodC5jb25zdHJ1Y3Rvcj17bmFtZTpcXFwiT2JqZWN0XFxcIn0pKSx0KXQuaGFzT3duUHJvcGVydHkobikmJih0aGlzLl9oYW5kbGVWYWx1ZSh0W25dLHQsbiksZS50ZXN0KG4pJiYocltuLnN1YnN0cmluZygxKV09dFtuXSxkZWxldGUgdFtuXSkpO2Zvcih2YXIgYSBpbiByKXRbYV09clthXX0sdC5wcm90b3R5cGUuX2hhbmRsZVRyYW5zZm9ybWVkT2JqZWN0PWZ1bmN0aW9uKHQsZSxuKXt2YXIgYT10W3JdLG89dGhpcy50cmFuc2Zvcm1NYXBbYV07aWYoIW8pdGhyb3cgbmV3IEVycm9yKFxcXCJDYW4ndCBmaW5kIHRyYW5zZm9ybSBmb3IgXFxcXFxcXCJcXFwiK2ErJ1xcXCIgdHlwZS4nKTt0aGlzLmFjdGl2ZVRyYW5zZm9ybXNTdGFjay5wdXNoKHQpLHRoaXMuX2hhbmRsZVZhbHVlKHQuZGF0YSx0LFxcXCJkYXRhXFxcIiksdGhpcy5hY3RpdmVUcmFuc2Zvcm1zU3RhY2sucG9wKCksZVtuXT1vLmZyb21TZXJpYWxpemFibGUodC5kYXRhKX0sdC5wcm90b3R5cGUuX2hhbmRsZUNpcmN1bGFyU2VsZlJlZkR1cmluZ1RyYW5zZm9ybT1mdW5jdGlvbih0LHIsZSl7dmFyIG49dGhpcy5yZWZlcmVuY2VzO09iamVjdC5kZWZpbmVQcm9wZXJ0eShyLGUse3ZhbDp2b2lkIDAsY29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMD09PXRoaXMudmFsJiYodGhpcy52YWw9blt0XSksdGhpcy52YWx9LHNldDpmdW5jdGlvbih0KXt0aGlzLnZhbD10fX0pfSx0LnByb3RvdHlwZS5faGFuZGxlQ2lyY3VsYXJSZWY9ZnVuY3Rpb24odCxyLGUpe3RoaXMuYWN0aXZlVHJhbnNmb3Jtc1N0YWNrLmluY2x1ZGVzKHRoaXMucmVmZXJlbmNlc1t0XSk/dGhpcy5faGFuZGxlQ2lyY3VsYXJTZWxmUmVmRHVyaW5nVHJhbnNmb3JtKHQscixlKToodGhpcy52aXNpdGVkUmVmc1t0XXx8KHRoaXMudmlzaXRlZFJlZnNbdF09ITAsdGhpcy5faGFuZGxlVmFsdWUodGhpcy5yZWZlcmVuY2VzW3RdLHRoaXMucmVmZXJlbmNlcyx0KSkscltlXT10aGlzLnJlZmVyZW5jZXNbdF0pfSx0LnByb3RvdHlwZS5faGFuZGxlVmFsdWU9ZnVuY3Rpb24odCxlLG4pe2lmKFxcXCJvYmplY3RcXFwiPT10eXBlb2YgdCYmbnVsbCE9PXQpe3ZhciBhPXRbXFxcIkByXFxcIl07aWYodm9pZCAwIT09YSl0aGlzLl9oYW5kbGVDaXJjdWxhclJlZihhLGUsbik7ZWxzZSBpZih0W3JdKXRoaXMuX2hhbmRsZVRyYW5zZm9ybWVkT2JqZWN0KHQsZSxuKTtlbHNlIGlmKEFycmF5LmlzQXJyYXkodCkpZm9yKHZhciBvPTA7bzx0Lmxlbmd0aDtvKyspdGhpcy5faGFuZGxlVmFsdWUodFtvXSx0LG8pO2Vsc2UgdGhpcy5faGFuZGxlUGxhaW5PYmplY3QodCl9fSx0LnByb3RvdHlwZS50cmFuc2Zvcm09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52aXNpdGVkUmVmc1swXT0hMCx0aGlzLl9oYW5kbGVWYWx1ZSh0aGlzLnJlZmVyZW5jZXNbMF0sdGhpcy5yZWZlcmVuY2VzLDApLHRoaXMucmVmZXJlbmNlc1swXX0sdH0oKSxkPVt7dHlwZTpcXFwiW1tOYU5dXVxcXCIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuXFxcIm51bWJlclxcXCI9PT10JiZpc05hTihyKX0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24oKXtyZXR1cm5cXFwiXFxcIn0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbigpe3JldHVybiBOYU59fSx7dHlwZTpcXFwiW1t1bmRlZmluZWRdXVxcXCIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQpe3JldHVyblxcXCJ1bmRlZmluZWRcXFwiPT09dH0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24oKXtyZXR1cm5cXFwiXFxcIn0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbigpe319LHt0eXBlOlxcXCJbW0RhdGVdXVxcXCIsbG9va3VwOkRhdGUsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHIgaW5zdGFuY2VvZiBEYXRlfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5nZXRUaW1lKCl9LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IERhdGU7cmV0dXJuIHIuc2V0VGltZSh0KSxyfX0se3R5cGU6XFxcIltbUmVnRXhwXV1cXFwiLGxvb2t1cDpSZWdFeHAsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHIgaW5zdGFuY2VvZiBSZWdFeHB9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPXtzcmM6dC5zb3VyY2UsZmxhZ3M6XFxcIlxcXCJ9O3JldHVybiB0Lmdsb2JhbFRoaXMmJihyLmZsYWdzKz1cXFwiZ1xcXCIpLHQuaWdub3JlQ2FzZSYmKHIuZmxhZ3MrPVxcXCJpXFxcIiksdC5tdWx0aWxpbmUmJihyLmZsYWdzKz1cXFwibVxcXCIpLHJ9LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBSZWdFeHAodC5zcmMsdC5mbGFncyl9fSx7dHlwZTpcXFwiW1tFcnJvcl1dXFxcIixsb29rdXA6RXJyb3Isc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHIgaW5zdGFuY2VvZiBFcnJvcn0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHIsZTtyZXR1cm4gdC5zdGFja3x8bnVsbD09PShlPShyPUVycm9yKS5jYXB0dXJlU3RhY2tUcmFjZSl8fHZvaWQgMD09PWV8fGUuY2FsbChyLHQpLHtuYW1lOnQubmFtZSxtZXNzYWdlOnQubWVzc2FnZSxzdGFjazp0LnN0YWNrfX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj1uZXcoblt0Lm5hbWVdfHxFcnJvcikodC5tZXNzYWdlKTtyZXR1cm4gci5zdGFjaz10LnN0YWNrLHJ9fSx7dHlwZTpcXFwiW1tBcnJheUJ1ZmZlcl1dXFxcIixsb29rdXA6YSYmQXJyYXlCdWZmZXIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIGEmJnIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcn0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IEludDhBcnJheSh0KTtyZXR1cm4gcy5jYWxsKHIpfSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe2lmKGEpe3ZhciByPW5ldyBBcnJheUJ1ZmZlcih0Lmxlbmd0aCk7cmV0dXJuIG5ldyBJbnQ4QXJyYXkocikuc2V0KHQpLHJ9cmV0dXJuIHR9fSx7dHlwZTpcXFwiW1tUeXBlZEFycmF5XV1cXFwiLHNob3VsZFRyYW5zZm9ybTpmdW5jdGlvbih0LHIpe2lmKGEpcmV0dXJuIEFycmF5QnVmZmVyLmlzVmlldyhyKSYmIShyIGluc3RhbmNlb2YgRGF0YVZpZXcpO2Zvcih2YXIgZT0wLG89dTtlPG8ubGVuZ3RoO2UrKyl7dmFyIGk9b1tlXTtpZihcXFwiZnVuY3Rpb25cXFwiPT10eXBlb2YgbltpXSYmciBpbnN0YW5jZW9mIG5baV0pcmV0dXJuITB9cmV0dXJuITF9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3JldHVybntjdG9yTmFtZTp0LmNvbnN0cnVjdG9yLm5hbWUsYXJyOnMuY2FsbCh0KX19LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJuXFxcImZ1bmN0aW9uXFxcIj09dHlwZW9mIG5bdC5jdG9yTmFtZV0/bmV3IG5bdC5jdG9yTmFtZV0odC5hcnIpOnQuYXJyfX0se3R5cGU6XFxcIltbTWFwXV1cXFwiLGxvb2t1cDpvJiZNYXAsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIG8mJnIgaW5zdGFuY2VvZiBNYXB9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPVtdO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKHQsZSl7ci5wdXNoKGUpLHIucHVzaCh0KX0pKSxyfSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe2lmKG8pe2Zvcih2YXIgcj1uZXcgTWFwLGU9MDtlPHQubGVuZ3RoO2UrPTIpci5zZXQodFtlXSx0W2UrMV0pO3JldHVybiByfWZvcih2YXIgbj1bXSxhPTA7YTx0Lmxlbmd0aDthKz0yKW4ucHVzaChbdFtlXSx0W2UrMV1dKTtyZXR1cm4gbn19LHt0eXBlOlxcXCJbW1NldF1dXFxcIixsb29rdXA6aSYmU2V0LHNob3VsZFRyYW5zZm9ybTpmdW5jdGlvbih0LHIpe3JldHVybiBpJiZyIGluc3RhbmNlb2YgU2V0fSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj1bXTtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbih0KXtyLnB1c2godCl9KSkscn0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtpZihpKXtmb3IodmFyIHI9bmV3IFNldCxlPTA7ZTx0Lmxlbmd0aDtlKyspci5hZGQodFtlXSk7cmV0dXJuIHJ9cmV0dXJuIHR9fV0scD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy50cmFuc2Zvcm1zPVtdLHRoaXMudHJhbnNmb3Jtc01hcD1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMuc2VyaWFsaXplcj10fHxmLHRoaXMuYWRkVHJhbnNmb3JtcyhkKX1yZXR1cm4gdC5wcm90b3R5cGUuYWRkVHJhbnNmb3Jtcz1mdW5jdGlvbih0KXtmb3IodmFyIHI9MCxlPXQ9QXJyYXkuaXNBcnJheSh0KT90Olt0XTtyPGUubGVuZ3RoO3IrKyl7dmFyIG49ZVtyXTtpZih0aGlzLnRyYW5zZm9ybXNNYXBbbi50eXBlXSl0aHJvdyBuZXcgRXJyb3IoJ1RyYW5zZm9ybSB3aXRoIHR5cGUgXFxcIicrbi50eXBlKydcXFwiIHdhcyBhbHJlYWR5IGFkZGVkLicpO3RoaXMudHJhbnNmb3Jtcy5wdXNoKG4pLHRoaXMudHJhbnNmb3Jtc01hcFtuLnR5cGVdPW59cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLnJlbW92ZVRyYW5zZm9ybXM9ZnVuY3Rpb24odCl7Zm9yKHZhciByPTAsZT10PUFycmF5LmlzQXJyYXkodCk/dDpbdF07cjxlLmxlbmd0aDtyKyspe3ZhciBuPWVbcl0sYT10aGlzLnRyYW5zZm9ybXMuaW5kZXhPZihuKTthPi0xJiZ0aGlzLnRyYW5zZm9ybXMuc3BsaWNlKGEsMSksZGVsZXRlIHRoaXMudHJhbnNmb3Jtc01hcFtuLnR5cGVdfXJldHVybiB0aGlzfSx0LnByb3RvdHlwZS5lbmNvZGU9ZnVuY3Rpb24odCl7dmFyIHI9bmV3IGModCx0aGlzLnRyYW5zZm9ybXMpLnRyYW5zZm9ybSgpO3JldHVybiB0aGlzLnNlcmlhbGl6ZXIuc2VyaWFsaXplKHIpfSx0LnByb3RvdHlwZS5kZWNvZGU9ZnVuY3Rpb24odCl7dmFyIHI9dGhpcy5zZXJpYWxpemVyLmRlc2VyaWFsaXplKHQpO3JldHVybiBuZXcgbChyLHRoaXMudHJhbnNmb3Jtc01hcCkudHJhbnNmb3JtKCl9LHR9KCk7dC5kZWZhdWx0PXB9KHopO3ZhciBFPXQmJnQuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19O1MuX19lc01vZHVsZT0hMCxTLkRlY29kZT1QPVMuRW5jb2RlPXZvaWQgMDt2YXIgaz1FKE8pLEM9RSh3KSxEPUUoQSksST1FKGopLE49RSh6KSxSPVtELmRlZmF1bHQsQy5kZWZhdWx0LGsuZGVmYXVsdCxJLmRlZmF1bHRdLHg9bmV3IE4uZGVmYXVsdDt4LmFkZFRyYW5zZm9ybXMoUik7dmFyIFA9Uy5FbmNvZGU9ZnVuY3Rpb24odCl7cmV0dXJuIEpTT04ucGFyc2UoeC5lbmNvZGUodCkpfTtTLkRlY29kZT1mdW5jdGlvbih0KXtyZXR1cm4geC5kZWNvZGUoSlNPTi5zdHJpbmdpZnkodCkpfSxmdW5jdGlvbihyKXt2YXIgZT10JiZ0Ll9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fTtyLl9fZXNNb2R1bGU9ITA7dmFyIGE9ZShuKSxpPWUobyksdT1TO3IuZGVmYXVsdD1mdW5jdGlvbih0LHIsZSl7dm9pZCAwPT09ZSYmKGU9ITApO2Zvcih2YXIgbj10LG89e3BvaW50ZXJzOnt9LHNyYzp7bnBtOlxcXCJodHRwczovL25wbWpzLmNvbS9wYWNrYWdlL2NvbnNvbGUtZmVlZFxcXCIsZ2l0aHViOlxcXCJodHRwczovL2dpdGh1Yi5jb20vc2FtZGVudHk5OS9jb25zb2xlLWZlZWRcXFwifX0scz1mdW5jdGlvbih0KXt2YXIgYT1uW3RdO25bdF09ZnVuY3Rpb24oKXthLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbj1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7c2V0VGltZW91dCgoZnVuY3Rpb24oKXt2YXIgYT1pLmRlZmF1bHQodCxuKTtpZihhKXt2YXIgbz1hO2UmJihvPXUuRW5jb2RlKGEpKSxyKG8sYSl9fSkpfSxvLnBvaW50ZXJzW3RdPWF9LGY9MCxjPWEuZGVmYXVsdDtmPGMubGVuZ3RoO2YrKylzKGNbZl0pO3JldHVybiBuLmZlZWQ9byxufX0oZSkscihlKSh3aW5kb3cuY29uc29sZSwoZnVuY3Rpb24odCl7dmFyIHI9UCh0KTtwYXJlbnQucG9zdE1lc3NhZ2Uoe3R5cGU6XFxcImNvbnNvbGVcXFwiLGNvZGVzYW5kYm94OiEwLGxvZzpBcnJheS5pc0FycmF5KHIpP3JbMF06cixjaGFubmVsSWQ6c2NvcGUuY2hhbm5lbElkfSxcXFwiKlxcXCIpfSkpO1xcblwiO1xuXG5leHBvcnQgeyBFdmVudEVtaXR0ZXIgYXMgRSwgZ2V0TWVzc2FnZUZyb21FcnJvciBhcyBhLCBmaW5kU3RhcnRTY3JpcHRQYWNrYWdlSnNvbiBhcyBiLCBjb25zb2xlSG9vayBhcyBjLCBmcm9tQnVuZGxlckZpbGVzVG9GUyBhcyBmLCBnZW5lcmF0ZVJhbmRvbUlkIGFzIGcsIHJlYWRCdWZmZXIgYXMgciwgd3JpdGVCdWZmZXIgYXMgdyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs\n"));

/***/ })

}]);