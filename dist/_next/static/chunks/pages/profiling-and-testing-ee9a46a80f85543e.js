(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4868],{6644:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profiling-and-testing",function(){return t(5239)}])},877:function(e,s,t){"use strict";t.d(s,{E:function(){return Excalidraw}});var n=t(5893),o=t(2010),i=t(7294);function Excalidraw(e){let{contents:s,widthClass:r}=e,l=(0,o.F)(),a=(0,i.useRef)(null);return(0,i.useEffect)(()=>{(async()=>{var e;let n=await Promise.all([t.e(2738),t.e(4081),t.e(6835)]).then(t.t.bind(t,4474,23)),o=await n.exportToSvg({elements:s.elements||[],files:s.files||null,exportPadding:16,renderEmbeddables:!0,appState:{...s.appState,exportWithDarkMode:"dark"===l.resolvedTheme}});o.classList.add(r||"w-full"),o.classList.add("h-auto"),null===(e=a.current)||void 0===e||e.replaceChildren(o)})()},[s,l]),(0,n.jsx)("div",{className:"mt-6 flex justify-center",ref:a})}},3468:function(e,s,t){"use strict";t.d(s,{E:function(){return Image}});var n=t(5893),o=t(5675),i=t.n(o);function Image(e){let{src:s,alt:t}=e;return(0,n.jsx)(i(),{className:"mt-6 w-full",alt:t,src:s})}},4152:function(e,s,t){"use strict";var n=t(5893);t(7294);var o=t(1163);let i={faviconGlyph:"\uD83D\uDCDA",logo:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"font-black",children:"FRONTEND DOCS"}),(0,n.jsx)("span",{className:"font-black text-xs px-2 py-1 ml-2 rounded-md border text-gray-600 border-gray-300 dark:text-gray-400 dark:border-gray-700",children:"DRAFT"})]}),docsRepositoryBase:"https://github.com/tomasreimers/clientside",footer:{component:null},sidebar:{titleComponent(e){let{type:s,title:t,route:o}=e;return"doc"===s&&["#",""].includes(o)?(0,n.jsx)("span",{className:"text-gray-300 dark:text-neutral-600",title:"Coming soon",children:t}):(0,n.jsx)(n.Fragment,{children:t})}},feedback:{content:(0,n.jsx)(n.Fragment,{children:"Questions? Leave me feedback →"})},editLink:{text:(0,n.jsx)(n.Fragment,{children:"Opinions? Suggest an edit →"})},toc:{extraContent:(0,n.jsxs)("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400 contrast-more:text-gray-800 contrast-more:dark:text-gray-50",children:[(0,n.jsx)("p",{children:"Hi! My name is Tomas; I have been programming for the web for 15+ years and developed reactive frontend frameworks at Facebook."}),(0,n.jsx)("p",{className:"mt-2",children:"This site is a ~20-page, front-to-back-readable guide on some of the knowledge, opinions, and intuition I've picked up along the way."}),(0,n.jsx)("p",{className:"mt-2",children:"This is still under development, so feel free to suggest edits or follow me on Twitter for updates."})]})},project:{},search:{component:null},head:()=>{let{asPath:e}=(0,o.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,n.jsx)("meta",{name:"twitter:creator",content:"@tomasreimers"}),(0,n.jsx)("meta",{property:"og:image",content:"https://frontenddocs.com/api/og".concat(e,"image.png")})]})},useNextSeoProps:()=>({titleTemplate:"%s – Frontend docs",defaultTitle:"Frontend docs",description:"A ~20-page, front-to-back-readable guide on writing frontend for experienced developers."})};s.Z=i},5239:function(e,s,t){"use strict";t.r(s),t.d(s,{__toc:function(){return k},default:function(){return g}});var n=t(5893),o=t(2673),i=t(6386),r=t(4152);t(9059);var l=t(2643),a=t(3468),c={src:"/_next/static/media/chrome-profiler.573aeb1c.png",height:962,width:1238,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAYAAAD+Bd/7AAAArUlEQVR42h3MS0oDQRQF0PtuvepUtaQR3IQ7ENfhWlyFy3HowLHgzIngxLkikqTTHepzAzkLOPb9+XGnlB9b54kmUzeE6ArQZpnnJ98dTreTbR7YO2iCGUEBUMdxNz870lRaGuFDLOqypg6RqrXGNXjxK/1yijewcoiBBKHL0NKENRm92nVpfatl1hKcZjYAgoYx5TGj+Ov72wsN92ncojYh5wgGYt3v8f/z93UG1FROULEcY2gAAAAASUVORK5CYII=",blurWidth:8,blurHeight:6},h={src:"/_next/static/media/lighthouse.09a71e8f.png",height:1982,width:3024,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAjUlEQVR42g3BPRbBQBQF4PvmJ4gcrcZSrNcmHDSaVFahU8QhM5Nk3rt8n1wv55Pz8UgiqVb3TQl0sOhjG324I5elfw0TP1lpRk46c5wTp7pQVftgRK4qcFOZNWxc1YrGr4zGpkJziJ7drlUIQiNiWIUGIgDxR9eFUtJtfD8Hl7Vs9wdBXMMJaGpr7/3jBw59VW69jNb5AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5},d={src:"/_next/static/media/react-devtools.e5b30b83.png",height:984,width:3456,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAAMUlEQVR42mOwDUoydguFIBP3cEc3X109IwMjSwYz91BtM0dtcycIsnFw1dI11tA2BgAvZQtbALsDuAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:2},p={src:"/_next/static/media/flamechart.04d12a53.png",height:980,width:3456,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAAOklEQVR42mMwMrc1MbUxsnXwbKzzr63062gJz8p2snVmUNcyVFPX19A3damsMPLx1ffytnR2NzC0AABe+g16EsY/EgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:2},x={src:"/_next/static/media/timeline.503d8e75.png",height:984,width:3456,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAIAAADq9gq6AAAANUlEQVR42mOwsA+1tA8yMrUxNvc0MXM2MrHRM7TR0zdhUNcyUtM0UNcyBDLApKGGtpGGthEAAKIJfSTHXbYAAAAASUVORK5CYII=",blurWidth:8,blurHeight:2},u=t(877),y=JSON.parse('{"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"oke2LNb5KsU2BhZ0peFrc","type":"rectangle","x":160.12249668313672,"y":-506.5001412274443,"width":242.3533188299508,"height":22.57340577654776,"angle":0,"strokeColor":"#e03131","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":{"type":3},"seed":981325948,"version":212,"versionNonce":1071768900,"isDeleted":false,"boundElements":null,"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":266,"versionNonce":1077322492,"isDeleted":false,"id":"gdd3mynIQW_-LsmAAkEU9","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":159.5721135584912,"y":-479.41782754514605,"strokeColor":"#e03131","backgroundColor":"transparent","width":242.3533188299508,"height":22.57340577654776,"seed":1463233348,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":346,"versionNonce":2117475012,"isDeleted":false,"id":"DDZ9yuCWK5yEUt5xxEtwu","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":159.96084569547855,"y":-452.27200811769666,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":1648987972,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":433,"versionNonce":1004594044,"isDeleted":false,"id":"0p5h0liLlpIvga1Uqt2yQ","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":158.48096939179868,"y":-424.37759066406824,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":597452612,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":527,"versionNonce":430842436,"isDeleted":false,"id":"3JvGeGkkgBoQb4iryzs8u","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":157.83821427420554,"y":-396.6409753650586,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":1508422340,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":397,"versionNonce":963580924,"isDeleted":false,"id":"w-Ig8EsStXUgwkS4QOyvn","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":158.99671301908887,"y":-368.82738340525947,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":2048227908,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":403,"versionNonce":666450372,"isDeleted":false,"id":"7XZ1B2BzcFpMxj7g1KDSy","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":158.56756813518695,"y":-341.7450697229612,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":829788612,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":482,"versionNonce":920859772,"isDeleted":false,"id":"3vrxE0lq4smSZCgD7JNpB","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":158.94475377305588,"y":-314.45684347305126,"strokeColor":"#1971c2","backgroundColor":"#a5d8ff","width":242.3533188299508,"height":22.57340577654776,"seed":1139194180,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":570,"versionNonce":58024260,"isDeleted":false,"id":"DIqzRA_RBhVIo5fZXVnl3","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":157.45333097025758,"y":-286.1775427154749,"strokeColor":"#e03131","backgroundColor":"transparent","width":242.3533188299508,"height":22.57340577654776,"seed":1288106180,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"type":"rectangle","version":664,"versionNonce":570377468,"isDeleted":false,"id":"vTNG42n3hD1szw1x3v8s5","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":156.81057585266444,"y":-258.44092741646506,"strokeColor":"#e03131","backgroundColor":"transparent","width":242.3533188299508,"height":22.57340577654776,"seed":1270102084,"groupIds":[],"frameId":null,"roundness":{"type":3},"boundElements":[],"updated":1705282395507,"link":null,"locked":false},{"id":"uTdk-M10AQDyBQ8QJA9c5","type":"rectangle","x":132.62258461605504,"y":-444.71290002815874,"width":306.13233112716705,"height":143.31707147458172,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":1937958212,"version":269,"versionNonce":1950390468,"isDeleted":false,"boundElements":null,"updated":1705282395507,"link":null,"locked":false},{"id":"fm4mODA8Xd6nUvAsCn4lt","type":"text","x":397.14710616992795,"y":-386.21045488721086,"width":113.53593444824219,"height":20,"angle":1.5707963267948957,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"frameId":null,"roundness":null,"seed":1344381892,"version":76,"versionNonce":1615152508,"isDeleted":false,"boundElements":null,"updated":1705282395507,"link":null,"locked":false,"text":"USER SCREEN","fontSize":16,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":14,"containerId":null,"originalText":"USER SCREEN","lineHeight":1.25},{"type":"text","version":356,"versionNonce":1507970500,"isDeleted":false,"id":"mFsswgFAFou6vOY_yQFsW","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":246.5792289406499,"y":-394.2708259761713,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":67.43994140625,"height":20,"seed":95200324,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1705282405883,"link":null,"locked":false,"fontSize":16,"fontFamily":1,"text":"VISIBLE","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"VISIBLE","lineHeight":1.25,"baseline":14},{"type":"text","version":466,"versionNonce":2061609340,"isDeleted":false,"id":"DQxgFYUULm3hrxIMEyNRn","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":229.88417549597972,"y":-476.34141729351427,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":86.46391296386719,"height":20,"seed":1012149444,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1705282411790,"link":null,"locked":false,"fontSize":16,"fontFamily":1,"text":"INVISIBLE","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"INVISIBLE","lineHeight":1.25,"baseline":14},{"type":"text","version":551,"versionNonce":722142332,"isDeleted":false,"id":"OeEh6gN0ATzAeTtLROgBr","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":232.55951953668318,"y":-283.6341958398107,"strokeColor":"#1e1e1e","backgroundColor":"#a5d8ff","width":86.46391296386719,"height":20,"seed":1424652924,"groupIds":[],"frameId":null,"roundness":null,"boundElements":[],"updated":1705282414716,"link":null,"locked":false,"fontSize":16,"fontFamily":1,"text":"INVISIBLE","textAlign":"left","verticalAlign":"top","containerId":null,"originalText":"INVISIBLE","lineHeight":1.25,"baseline":14}],"appState":{"gridSize":null,"viewBackgroundColor":"#ffffff"},"files":{}}');let k=[{depth:2,value:"Profiling",id:"profiling"},{depth:3,value:"Lighthouse",id:"lighthouse"},{depth:3,value:"React devtools",id:"react-devtools"},{depth:3,value:"Optimizations",id:"optimizations"},{depth:4,value:"Memoizing data",id:"memoizing-data"},{depth:4,value:"Memoizing components",id:"memoizing-components"},{depth:4,value:"List virtualization",id:"list-virtualization"},{depth:2,value:"Testing",id:"testing"},{depth:3,value:"Unit tests",id:"unit-tests"},{depth:3,value:"Integration tests",id:"integration-tests"},{depth:3,value:"End-to-end tests",id:"end-to-end-tests"},{depth:3,value:"Visual tests",id:"visual-tests"},{depth:2,value:"Reporting",id:"reporting"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",h2:"h2",a:"a",h3:"h3",ul:"ul",li:"li",code:"code",h4:"h4",pre:"pre",span:"span"},(0,l.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"Profiling and testing: productionizing apps"}),"\n",(0,n.jsx)(s.p,{children:"As you get ready to deploy your application, you probably start to think about performance and stability."}),"\n",(0,n.jsx)(s.h2,{id:"profiling",children:"Profiling"}),"\n",(0,n.jsxs)(s.p,{children:["Profilers are how we can reliably achieve and debug performance. Chrome devtools ships with a ",(0,n.jsx)(s.a,{href:"https://developer.chrome.com/docs/devtools/performance",children:"profiler"})," that helps you debug slow parts of your JavaScript, and hopefully looks familiar to anyone who's previously worked with profilers or had to read ",(0,n.jsx)(s.a,{href:"https://medium.com/performance-engineering-for-the-ordinary-barbie/profiling-flame-chart-vs-flame-graph-7b212ddf3a83",children:"flame charts"}),"."]}),"\n",(0,n.jsx)(a.E,{src:c,alt:"The devtools profiler"}),"\n",(0,n.jsx)(s.p,{children:"In many ways, profiling is the same regardless of what language you're working in; however, something specific to rendering UI is profiling code that renders and rerenders UI. While the core technologies are the same, the implications and what you optimize are very different; for example, does it matter if Chrome takes a while to render something that's not visible until the user scrolls?"}),"\n",(0,n.jsx)(s.p,{children:'(For webpages, which scroll vertically, content that is visible before scrolling is referred to as "above the fold" and content that needs to be scrolled to is referred to as "below the fold". This language is borrowed from newspapers, which are typically folded in half, and where the headlines want to be "above the fold".)'}),"\n",(0,n.jsx)(s.h3,{id:"lighthouse",children:"Lighthouse"}),"\n",(0,n.jsx)(s.p,{children:"While the answer to that question depends on your specific application, there are a few metrics that the developer community has decided should matter generally:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://web.dev/articles/fcp",children:"First contentful paint (FCP)"}),": Time until any content is rendered on the screen."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://web.dev/articles/lcp",children:"Largest contentful paint (LCP)"}),": Time until the render that paints the most content above the fold."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://web.dev/articles/cls",children:"Cumulative layout shift (CLS)"}),": A burst of renders that meaningfully move page content."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://web.dev/articles/fid",children:"First input delay (FID)"}),": The delay between a user's first interaction and its event handler running."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://web.dev/articles/inp",children:"Interaction to Next Paint (INP)"}),": Time from user interaction until the page rerenders."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:'I\'ll caution you against over-indexing on these metrics. Over-time they\'ve evolved, and like most things in the JavaScript ecosystem "over time" is short. The "most important" metrics change every 2-4 years.'}),"\n",(0,n.jsxs)(s.p,{children:["Computing these metrics yourself can be tedius, and Chrome ships with ",(0,n.jsx)(s.a,{href:"https://developer.chrome.com/docs/lighthouse/overview#devtools",children:"Lighthouse"}),": a tool that scores websites across a variety of metrics, including performance (as well as for SEO, accessibility, best practices, and other important things.) Lighthouse can be accessed directly from Chrome devtools."]}),"\n",(0,n.jsx)(a.E,{src:h,alt:"Lighthouse"}),"\n",(0,n.jsx)(s.h3,{id:"react-devtools",children:"React devtools"}),"\n",(0,n.jsx)(s.p,{children:"Profiling is wonderful, but can be limiting when profiling applications using a framework: as suboptimal code is more likely to generate flamecharts pointing at React internals than the actual problem."}),"\n",(0,n.jsxs)(s.p,{children:["Fortunately, React ships with its own profiler that can help you identify problematic code: ",(0,n.jsx)(s.a,{href:"https://react.dev/learn/react-developer-tools",children:"React devtools"}),"."]}),"\n",(0,n.jsx)(a.E,{src:d,alt:"React devtools"}),"\n",(0,n.jsx)(s.p,{children:"React devtools are embedded within Chrome devtools and can inspect the React tree (much like the elements panel in Chrome devtools allows you to inspect the DOM)."}),"\n",(0,n.jsx)(s.p,{children:"Additionally, React can expose hooks for devtools to be able to profile performance of React apps. Because these hooks add some overhead to the app, they are opt-in. There are three common builds of React:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Development: the version you build with when developing locally."}),"\n",(0,n.jsx)(s.li,{children:"Production: the version that gets deployed to users."}),"\n",(0,n.jsx)(s.li,{children:"Profiling: Production with additional hooks for profiling."}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Typically, switching between these versions is handled by whatever scaffolder or meta-framework you used to generate your application, but can be ",(0,n.jsx)(s.a,{href:"fb.me/react-profiling",children:"manually defined"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"If you're using the development or profiling builds of React, React devtools can capture a profile and generate a timeline showing you the various tasks React was doing over time:"}),"\n",(0,n.jsx)(a.E,{src:x,alt:"React devtools timeline"}),"\n",(0,n.jsx)(s.p,{children:"React devtools can also generate a flamechart of a render, and what caused certain components to rerender:"}),"\n",(0,n.jsx)(a.E,{src:p,alt:"React devtools flamechart"}),"\n",(0,n.jsx)(s.h3,{id:"optimizations",children:"Optimizations"}),"\n",(0,n.jsxs)(s.p,{children:["Because browser JavaScript is single-threaded, you want to make sure your render function doesn't take too long; for example, if you want your app to update in response to user input at 30 frames per second (video games tend to target 60fps) render can take a maximum of ",(0,n.jsx)(s.code,{children:"33ms - time react needs to reconcile + commit"})," (~16ms as a rule of thumb)."]}),"\n",(0,n.jsx)(s.p,{children:"Once you have identified any slow parts of your app, there are a few common tactics to speed them up."}),"\n",(0,n.jsx)(s.h4,{id:"memoizing-data",children:"Memoizing data"}),"\n",(0,n.jsx)(s.p,{children:"By far, the easiest thing to speed up is a single component that takes a long time to render. This is probably because that component's render function is doing some non-trivial compute; for a contrived example:"}),"\n",(0,n.jsx)(s.pre,{"data-language":"tsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"tsx","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Fibonacci"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"({ n }"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { n"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"number"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}) {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"value"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"computeFibonacci"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(n);"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" <"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:">"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    The {n} value in the fibonacci sequence is {value}!"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  </"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:">;"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Every time this component renders, it will recompute the nth fibonacci number, even though it's previously computed it. The ",(0,n.jsx)(s.a,{href:"https://react.dev/reference/react/useMemo",children:(0,n.jsx)(s.code,{children:"useMemo"})})," hook allows you to memoize expensive compute:"]}),"\n",(0,n.jsx)(s.pre,{"data-language":"tsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"tsx","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Fibonacci"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"({ n }"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { n"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"number"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}) {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"value"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"useMemo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(() "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"computeFibonacci"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(n)"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  }"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" [n]);"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" <"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:">"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    The {n} value in the fibonacci sequence is {value}!"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  </"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:">;"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"useMemo"})," takes in a lambda whose return value to memoize, and an array of props. Whenever one of the values in the array changes, the value is recomputed (similar to the array of props for ",(0,n.jsx)(s.code,{children:"useEffect"}),")."]}),"\n",(0,n.jsx)(s.h4,{id:"memoizing-components",children:"Memoizing components"}),"\n",(0,n.jsx)(s.p,{children:"Sometimes, you don't want to memoize data, but entire components. If you've poked around the React devtools profiler, you'll notice that every time a component rerenders, so do all of its children."}),"\n",(0,n.jsxs)(s.p,{children:["This is the default behavior of React, and can lead to problems if state is held too high up in the tree; for example, imagine you have a very long list of items, stored as state in a parent component, and the user changes a single item. By default, React will re-render the entire list, but as the developer you know only the changed item needs to be rerendered. React provides ",(0,n.jsx)(s.a,{href:"https://react.dev/reference/react/memo",children:(0,n.jsx)(s.code,{children:"memo"})})," to handle this case."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"jsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"jsx","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { memo } "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'react'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"SomeComponent"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"memo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"SomeComponent"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(props) {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["When a component is wrapped in ",(0,n.jsx)(s.code,{children:"memo"})," it will only rerender if its props change (defined as are no-longer pointer equal). In the event you're passing complex objects to your component (functions, objects, classes, anything where pointer equality is insufficient to determine equality), you can pass a second parameter to ",(0,n.jsx)(s.code,{children:"memo"})," which takes in new props and old props and returns whether they're equal."]}),"\n",(0,n.jsx)(s.h4,{id:"list-virtualization",children:"List virtualization"}),"\n",(0,n.jsx)(s.p,{children:"Sometimes simply rendering that many items in the browser (or having that many nodes in the DOM) will cause your app to be slow. This is commonly the case with really long lists (imagine a spreadsheet application viewing a sheet with 10,000 rows). In these cases, memoization won't solve the problem because the mere existence of those rows is causing a problem."}),"\n",(0,n.jsx)(s.p,{children:"The solution is to not render all of the rows, a technique known as list virtualization. In list virtualization, you compute which rows would be on screen (either because you measure the height of each row, or--even better--you know the height of each row ahead of time, for example, in the spreadsheet where all rows are the same height) and you only render those rows. For rows which are not rendered, you either replace them with a large empty box (that consumes equivalent space) or absolutely position all of the displayed rows at the location they would have been anyway."}),"\n",(0,n.jsx)(u.E,{contents:y}),"\n",(0,n.jsxs)(s.p,{children:["You rarely have to implement list virtualization yourself, consider using ",(0,n.jsx)(s.a,{href:"https://github.com/bvaughn/react-virtualized",children:"react-virtualized"})," and ",(0,n.jsx)(s.a,{href:"https://github.com/bvaughn/react-window",children:"react-window"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"testing",children:"Testing"}),"\n",(0,n.jsx)(s.p,{children:"As your app gets more complex, you will want to test it."}),"\n",(0,n.jsx)(s.h3,{id:"unit-tests",children:"Unit tests"}),"\n",(0,n.jsxs)(s.p,{children:["Customarily, if you have any significant logic, you should break that out into its own package (for example, if you're writing a calendar app, I would expect a lot of the date manipulation logic to be its own package). As a package implementing pure logic (without UI), you can test it using any JavaScript testing framework. Some common options are ",(0,n.jsx)(s.a,{href:"https://jestjs.io/",children:"Jest"})," and ",(0,n.jsx)(s.a,{href:"https://mochajs.org/",children:"Mocha"})," (Mocha is a test runner typically used with ",(0,n.jsx)(s.a,{href:"https://www.chaijs.com/",children:"Chai"})," which provides syntactic sugar over ",(0,n.jsx)(s.code,{children:"assert"}),"). Code coverage can be computed with ",(0,n.jsx)(s.a,{href:"https://github.com/istanbuljs/nyc",children:(0,n.jsx)(s.code,{children:"nyc"})}),"."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"tsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"tsx","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// An example using Jest"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" { sum } "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"./sum"'})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"test"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'adds 1 + 2 to equal 3'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"expect"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".toBe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"integration-tests",children:"Integration tests"}),"\n",(0,n.jsx)(s.p,{children:"While logic should be pulled out of your app as much as it can be, there will still be components, and those components will still have logic (if nothing else, there are probably event handlers to test)."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.a,{href:"https://testing-library.com/docs/react-testing-library/intro",children:(0,n.jsx)(s.code,{children:"react-testing-library"})})," works by actually rendering components, and providing utilities to query those components and interact with them (firing event handlers)."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"tsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"tsx","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {render"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" screen} "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'@testing-library/react'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" userEvent "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'@testing-library/user-event'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'@testing-library/jest-dom'"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"test"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Can increment counter'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"render"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Counter"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" />);"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"expect"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"screen"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".getByRole"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'heading'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".toHaveTextContent"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'0'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"userEvent"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".click"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"screen"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".getByText"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Increment counter'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"));"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"expect"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"screen"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".getByRole"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'heading'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".toHaveTextContent"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'1'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Because it actually renders components, it requires a DOM: the simplest way to run it is in the browser, which already has a DOM. You can also run it in Jest, which mocks the DOM automatically using ",(0,n.jsx)(s.a,{href:"https://www.npmjs.com/package/jsdom",children:(0,n.jsx)(s.code,{children:"jsdom"})})," and ",(0,n.jsx)(s.a,{href:"https://www.npmjs.com/package/global-jsdom",children:(0,n.jsx)(s.code,{children:"global-jsdom"})})," to define global variables for ",(0,n.jsx)(s.code,{children:"window"})," and ",(0,n.jsx)(s.code,{children:"document"}),". For any other environments, you'll need to ",(0,n.jsx)(s.a,{href:"https://testing-library.com/docs/react-testing-library/setup#using-without-jest",children:"mock the dom yourself"}),"."]}),"\n",(0,n.jsx)(s.h3,{id:"end-to-end-tests",children:"End-to-end tests"}),"\n",(0,n.jsx)(s.p,{children:"While integration tests are great, they aren't bullet-proof in the world of UI. For example, while you can still technically click a button, and that button may do what you expect, it's exceptionally hard to do if the button is off-screen or has a width of 0."}),"\n",(0,n.jsx)(s.p,{children:"For this reason, many frontend projects have some level of end-to-end testing: where they load their application in a literal browser, and attempt to interact with it (a simple example would be: find the X/Y coordinates of a button, move the mouse to that X/Y coordinates, and click). Because they rely on loading your application and browser state, end-to-end tests (E2E tests) can be notoriously flakey."}),"\n",(0,n.jsxs)(s.p,{children:["Some common libraries are ",(0,n.jsx)(s.a,{href:"https://www.cypress.io/",children:"Cypress"})," and ",(0,n.jsx)(s.a,{href:"https://playwright.dev/",children:"Playwright"}),"."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"tsx","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"tsx","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"describe"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'My First Test'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"it"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'clicking \"type\" navigates to a new url'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"cy"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".visit"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'http://localhost:3000/'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"cy"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".contains"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Link to new URL'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".click"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Should be on a new URL which"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// includes '/commands/actions'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"cy"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".url"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"()"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".should"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'include'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'/commands/actions'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  })"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"})"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Note: something I've noticed in developers new to frontend is they try to bring the classic \"test pyramic\" with them (having more integration tests than E2E tests, and more unit tests than integration tests). For whatever reason, I've noticed frontend code tends to invert this pyramid (having ",(0,n.jsx)(s.a,{href:"https://twitter.com/sebmarkbage/status/1722025520513032454",children:"more E2E than integration"}),", and more integration than E2E). While I don't know the reason why, I suspect this is because once you've pulled out the meaningful logic into packages which are themselves unit tested, what remains is the integration between those packages and the browser (which is best E2E tested)."]}),"\n",(0,n.jsx)(s.h3,{id:"visual-tests",children:"Visual tests"}),"\n",(0,n.jsx)(s.p,{children:"Lastly, when working with components where design and visual layout matter a lot (and definitely when testing a design system), it is common to do visual testing. In visual testing, you render a component, take a screenshot, and compare that screenshot against some stored value."}),"\n",(0,n.jsx)(s.p,{children:"As you might imagine, this can be incredibly fragile, and it's critical to mock out all data; if your component includes any networked-fetched data or relative time (\"N days since...\") it will likely fail. However, this type of testing can be useful to ensure you don't have regressions in critical components (for example, for a seemingly harmless CSS change causes all buttons to triple in size)."}),"\n",(0,n.jsxs)(s.p,{children:["There are plenty of services to help with visual testing, and some examples are ",(0,n.jsx)(s.a,{href:"https://www.browserstack.com/",children:"BrowserStack"})," and ",(0,n.jsx)(s.a,{href:"https://percy.io/",children:"Percy"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["An alternative to this is ",(0,n.jsx)(s.a,{href:"https://jestjs.io/docs/snapshot-testing",children:"snapshot testing"})," where the rendered HTML is stored (instead of a screenshot)."]}),"\n",(0,n.jsx)(s.h2,{id:"reporting",children:"Reporting"}),"\n",(0,n.jsx)(s.p,{children:"Profiling and testing are great, but sometimes there are bugs that only happen in production."}),"\n",(0,n.jsxs)(s.p,{children:["There are plenty of services that will help add observability to your frontend application (including ",(0,n.jsx)(s.a,{href:"https://www.datadoghq.com/dg/real-user-monitoring/ux-monitoring/",children:"Datadog"}),", ",(0,n.jsx)(s.a,{href:"https://sentry.io/welcome/",children:"Senty"}),", and ",(0,n.jsx)(s.a,{href:"https://logrocket.com/",children:"LogRocket"}),"). But if you want to roll your own, consider ",(0,n.jsx)(s.a,{href:"https://github.com/GoogleChrome/web-vitals",children:(0,n.jsx)(s.code,{children:"web-vitals"})})," the technology behind Lighthouse and ",(0,n.jsx)(s.a,{href:"https://react.dev/reference/react/Profiler",children:(0,n.jsx)(s.code,{children:"<Profiler>"})})," which gives you programmatic access to React renders."]})]})}let m={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,l.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/profiling-and-testing.mdx",route:"/profiling-and-testing",pageMap:[{kind:"Meta",data:{index:"Foreword","-- Platform":{type:"separator",title:"WEB FUNDAMENTALS"},html:"Chapter 1: HTML",css:"Chapter 2: CSS",javascript:"Chapter 3: JavaScript","-- React":{type:"separator",title:"REACT ESSENTIALS"},components:"Chapter 4: Components",applications:"Chapter 5: Applications","build-tooling":"Chapter 6: Build tooling","profiling-and-testing":"Chapter 7: Profiling & testing","-- Design":{type:"separator",title:"DESIGN PRINCIPLES"},"design-systems":"Chapter 8: Design systems","ui-patterns":"Chapter 9: UI patterns","-- Data":{type:"separator",title:"DATA ARCHITECTURE"},state:"Chapter 10: Managing state",network:"Chapter 11: Network & sync","client-compute":"Chapter 12: Client compute",contact:{title:"Want updates? Follow me on Twitter ↗",type:"page",href:"https://twitter.com/tomasreimers",newWindow:!0}}},{kind:"MdxPage",name:"build-tooling",route:"/build-tooling"},{kind:"MdxPage",name:"components",route:"/components"},{kind:"MdxPage",name:"css",route:"/css"},{kind:"MdxPage",name:"design-systems",route:"/design-systems"},{kind:"MdxPage",name:"html",route:"/html"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"javascript",route:"/javascript"},{kind:"MdxPage",name:"profiling-and-testing",route:"/profiling-and-testing"},{kind:"MdxPage",name:"ui-patterns",route:"/ui-patterns"}],flexsearch:{codeblocks:!0},title:"Profiling and testing: productionizing apps",headings:k},pageNextRoute:"/profiling-and-testing",nextraLayout:i.ZP,themeConfig:r.Z};var g=(0,o.j)(m)}},function(e){e.O(0,[3620,9774,2888,179],function(){return e(e.s=6644)}),_N_E=e.O()}]);